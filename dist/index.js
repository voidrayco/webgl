!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("three"),require("ramda"),require("d3-color"),require("react"),require("bowser")):"function"==typeof define&&define.amd?define(["three","ramda","d3-color","react","bowser"],e):"object"==typeof exports?exports.voidgl=e(require("three"),require("ramda"),require("d3-color"),require("react"),require("bowser")):t.voidgl=e(t.three,t.ramda,t["d3-color"],t.react,t.bowser)}(this,function(t,e,i,n,r){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=20)}([function(e,i){e.exports=t},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n){this.height=0,this.width=0,this.x=0,this.y=0,4===arguments.length&&(this.x=t,this.width=e-t,this.y=i,this.height=i-n)}return Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y-this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mid",{get:function(){return{x:this.x+this.width/2,y:this.y-this.height/2}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),t.prototype.containsPoint=function(t){return!(t.x<this.x)&&(!(t.y>this.y)&&(!(t.x>this.right)&&!(t.y<this.bottom)))},t.prototype.copyBounds=function(t){this.height=t.height,this.width=t.width,this.x=t.x,this.y=t.y},t.prototype.encapsulate=function(t){t.x<this.x&&(this.width+=this.x-t.x,this.x=t.x),t.y>this.y&&(this.height+=t.y-this.y,this.y=t.y),t.right>this.right&&(this.width=t.right-this.x),t.bottom<this.bottom&&(this.height=this.y-t.bottom)},t.prototype.encapsulateBounds=function(e,i){if(i&&e.length&&this.copyBounds(e[0]),0!==e.length){var n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=Number.MAX_VALUE,s=-Number.MAX_VALUE;e.forEach(function(t){t.x<n?n=t.x:t.right>r&&(r=t.right),t.bottom<o?o=t.bottom:t.y>s&&(s=t.y)}),this.encapsulate(new t(n,r,s,o))}},t.prototype.encapsulatePoint=function(t){t.x<this.x&&(this.width+=this.x-t.x,this.x=t.x),t.y>this.y&&(this.height+=t.y-this.y,this.y=t.y),t.x>this.right&&(this.width=t.x-this.x),t.y<this.bottom&&(this.height=this.y-t.y)},t.prototype.encapsulatePoints=function(e){var i=Number.MAX_VALUE,n=-Number.MAX_VALUE,r=Number.MAX_VALUE,o=-Number.MAX_VALUE;void 0!==e[0]&&e[0].x?e.forEach(function(t){t.x<i?i=t.x:t.x>n&&(n=t.x),t.y<r?r=t.y:t.y>o&&(o=t.y)}):e.forEach(function(t){t[0]<i?i=t[0]:t[0]>n&&(n=t[0]),t[1]<r?r=t[1]:t[1]>o&&(o=t[1])}),this.encapsulate(new t(i,n,o,r))},t.prototype.fits=function(t){return this.width===t.width&&this.height===t.height?1:this.width>=t.width&&this.height>=t.height?2:0},t.prototype.hitBounds=function(t){return!(t.right<this.x)&&(!(t.x>this.right)&&(!(t.bottom>this.y)&&!(t.y<this.bottom)))},t.prototype.pointInside=function(t){return!(t.x<this.x)&&(!(t.y>this.y)&&(!(t.x>this.right)&&!(t.y<this.bottom)))},t.isBounds=function(t){return!!t&&(t instanceof this||t&&"containsPoint"in t&&"encapsulate"in t&&"hitTest"in t)},t.prototype.isInside=function(t){return t.x<=this.x&&t.right>=this.right&&t.y>=this.y&&t.bottom<=this.bottom},t.maxBounds=function(){return new t(Number.MIN_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MAX_VALUE)},t}();e.Bounds=n},function(t,e,i){(function(n){function r(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(t){var i=this.useColors;if(t[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+t[0]+(i?"%c ":" ")+"+"+e.humanize(this.diff),i){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(r++,"%c"===t&&(o=r))}),t.splice(o,0,n)}}function s(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}}function u(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==n&&"env"in n&&(t=n.env.DEBUG),t}e=t.exports=i(24),e.log=s,e.formatArgs=o,e.save=a,e.load=u,e.useColors=r,e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(u())}).call(e,i(23))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.init=function(t,e){},t.prototype.update=function(t){return!1},t}();e.BaseBuffer=n},function(t,e,i){"use strict";function n(t,e){M=t[0],P=t[1],C=t[2],A=t[3],T=t[4],O=t[5],B=t[6],D=e[0],U=e[1],X=e[2],N=e[3],W=e[4],k=e[5],Y=e[6]}function r(t,e){for(var i=V;i<t;++i)S=i*D,e(i-V,M,S)}function o(t,e){for(var i=V;i<t;++i)S=i*D,L=i*U,e(i-V,M,S,P,L)}function s(t,e){for(var i=V;i<t;++i)S=i*D,L=i*U,z=i*X,e(i-V,M,S,P,L,C,z)}function a(t,e){for(var i=V;i<t;++i)S=i*D,L=i*U,z=i*X,I=i*N,e(i-V,M,S,P,L,C,z,A,I)}function u(t,e){for(var i=V;i<t;++i)S=i*D,L=i*U,z=i*X,I=i*N,E=i*W,e(i-V,M,S,P,L,C,z,A,I,T,E)}function h(t,e){for(var i=V;i<t;++i)S=i*D,L=i*U,z=i*X,I=i*N,E=i*W,R=i*k,e(i-V,M,S,P,L,C,z,A,I,T,E,O,R)}function c(t,e){for(var i=V;i<t;++i)S=i*D,L=i*U,z=i*X,I=i*N,E=i*W,R=i*k,j=i*Y,e(i-V,M,S,P,L,C,z,A,I,T,E,O,R,B,j)}function l(t){x=t[0]||0,v=t[1]||0,w=t[2]||0,_=t[3]||0}function d(t,e){t[e]=x}function f(t,e){t[e]=x,t[++e]=v}function p(t,e){t[e]=x,t[++e]=v,t[++e]=w}function y(t,e){t[e]=x,t[++e]=v,t[++e]=w,t[++e]=_}Object.defineProperty(e,"__esModule",{value:!0});var g,m=i(0),b=i(2)("WebGLSurface:BufferUtil");!function(t){t[t.ONE=0]="ONE",t[t.TWO=1]="TWO",t[t.THREE=2]="THREE",t[t.FOUR=3]="FOUR"}(g=e.AttributeSize||(e.AttributeSize={}));var x=0,v=0,w=0,_=0,M=[],P=[],C=[],A=[],T=[],O=[],B=[],S=0,L=0,z=0,I=0,E=0,R=0,j=0,D=0,U=0,X=0,N=0,W=0,k=0,Y=0,V=0,q=!1,H=(G={},G[g.ONE]=d,G[g.TWO]=f,G[g.THREE]=p,G[g.FOUR]=y,G),Z={1:r,2:o,3:s,4:a,5:u,6:h,7:c},F=function(){function t(){}return t.beginUpdates=function(){q=!0,V=0},t.endUpdates=function(){var t=V;return q=!1,V=0,t},t.makeBuffer=function(t,e){for(var i=e.length,n=new m.BufferGeometry,r=0;r<i;++r){var o=e[r],s=o.size+1,a=new Float32Array(s*t),u=H[o.size],h=o.name;l(o.defaults);for(var c=0;c<t;++c)u(a,c*s);n.addAttribute(h,new m.BufferAttribute(a,s)),b("Made Buffer Attribute:",h,s)}return n},t.updateBuffer=function(t,e,i,r,o){var s=e.attributes,a=e.geometry,u=0!==V&&q;if(void 0!==t&&t!==e.currentData||u){q||(V=0),e.currentData=t;var h=s.map(function(t){return a.attributes[t.name]});n(h.map(function(t){return t.array}),s.map(function(t){return(t.size+1)*i}));return(0,Z[s.length])(r+V,o),h.forEach(function(t){return t.needsUpdate=!0}),V+=r,!0}return V+=r,!1},t.makeBufferItems=function(){return{attributes:[],currentData:[],geometry:null,system:null}},t}();e.BufferUtil=F;var G},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),o=function(t){function e(e,i){var n=t.call(this,0,1,1,0)||this;return n.setPoints(e,i),n}return n(e,t),e.prototype.directionTo=function(t){var e={x:this.p1.x-t.x,y:this.p1.y-t.y};return this.perpendicular.x*e.x+this.perpendicular.y*e.y},e.prototype.distanceTo=function(t){var e={x:this.p1.x-t.x,y:this.p1.y-t.y};return Math.abs(this.perpendicular.x*e.x+this.perpendicular.y*e.y)},e.getClosest=function(t,e){var i,n=Number.MAX_VALUE,r=0;return t.forEach(function(t){(r=t.distanceTo(e))<n&&(i=t,n=r)}),i},e.prototype.setPoints=function(t,e){this.x=t.x-1,this.y=t.y-1,this.width=2,this.height=2,this.encapsulatePoint(e);var i=e.x-t.x,n=e.y-t.y;this.slope=n/i,this.p1=t,this.p2=e,this.magnitude=Math.sqrt(i*i+n*n),this.perpendicular={x:this.p2.y-this.p1.y,y:-(this.p2.x-this.p1.x)};var r=Math.sqrt(this.perpendicular.x*this.perpendicular.x+this.perpendicular.y*this.perpendicular.y);this.perpendicular.x/=r,this.perpendicular.y/=r},e}(r.Bounds);e.Line=o},function(t,i){t.exports=e},function(t,e){t.exports=i},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.aspectRatio=1,this.imagePath=t,this.label=e,e&&(this.label.rasterizedLabel=this)}return t}();e.AtlasTexture=n},function(t,e,i){"use strict";function n(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.add=function(t,e,i){return i?(i.x=t.x+e.x,i.y=t.y+e.y,i):{x:t.x+e.x,y:t.y+e.y}},t.getClosest=function(t,e){var i,r=Number.MAX_VALUE,o=null,s=function(e){(i=n(e,t))<r&&(r=i,o=e)};return e.forEach(s),o},t.getClosestIndex=function(t,e){var i,r=Number.MAX_VALUE,o=0,s=function(e,s){(i=n(e,t))<r&&(r=i,o=s)};return e.forEach(s),o},t.getDirection=function(t,e,i){void 0===i&&(i=!1);var n=e.x-t.x,r=e.y-t.y;if(i){var o=Math.sqrt(n*n+r*r);n/=o,r/=o}return{x:n,y:r}},t.getDistance=function(t,e,i){return void 0===i&&(i=!1),i?n(t,e):Math.sqrt(n(t,e))},t.getMidpoint=function(e,i){var n=t.getDirection(e,i);return{x:n.x/2+e.x,y:n.y/2+e.y}},t.make=function(t,e){return{x:t,y:e}},t.scale=function(t,e,i){return i?(i.x=t.x*e,i.y=t.y*e,i):{x:t.x*e,y:t.y*e}},t.zero=function(){return{x:0,y:0}},t}();e.Point=r},function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(r,o){function s(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(s,a)}u((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,o=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){u.label=i[1];break}if(6===i[0]&&u.label<s[1]){u.label=s[1],s=i;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(i);break}s[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(t){i=[6,t],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(e,"__esModule",{value:!0});var o=i(7),s=i(0),a=i(1),u=i(11),h=i(8),c=i(2)("webgl-surface:Atlas"),l=i(2)("webgl-surface:Labels"),d=function(){function t(t,e){this.atlasImages={},this.atlasMap={},this.atlasTexture={},this.textureWidth=t,this.textureHeight=e}return t.prototype.createAtlas=function(t,e,i){return n(this,void 0,void 0,function(){var n,o,a,h,l,l,d,f;return r(this,function(r){switch(r.label){case 0:if(n=new u.PackNode(0,0,this.textureWidth,this.textureHeight),this.atlasMap[t]=n,this.atlasImages[t]=[],o=document.createElement("canvas").getContext("2d"),o.canvas.width=this.textureWidth,o.canvas.height=this.textureHeight,!e)return[3,4];a=0,h=e,r.label=1;case 1:return a<h.length?(l=h[a],[4,this.draw(l,t,o)]):[3,4];case 2:r.sent(),r.label=3;case 3:return a++,[3,1];case 4:return i?[4,this.drawColors(i,t,o)]:[3,6];case 5:l=r.sent(),l&&this.atlasImages[t].push(l),r.label=6;case 6:return d=new s.Texture(o.canvas),d.premultiplyAlpha=!0,d.generateMipmaps=!0,this.atlasTexture[t]=d,e&&(f=this.atlasImages[t]).push.apply(f,e),c("Atlas Created-> texture: %o mapping: %o images: %o",d,n,e),[2,d]}})})},t.prototype.destroyAtlas=function(t){if(this.atlasTexture[t]&&(this.atlasTexture[t].dispose(),this.atlasTexture[t]=null),this.atlasMap[t]&&(this.atlasMap[t].destroy(),this.atlasMap[t]=null),this.atlasImages[t]){var e={x:0,y:0};this.atlasImages[t].forEach(function(t){t.atlasReferenceID=null,t.pixelWidth=0,t.pixelHeight=0,t.atlasBL=e,t.atlasBR=e,t.atlasTL=e,t.atlasTR=e}),this.atlasImages[t]=null}},t.prototype.draw=function(t,e,i){return n(this,void 0,void 0,function(){var n,o,s,u,h,d,f,p,y,g;return r(this,function(r){switch(r.label){case 0:return this.atlasMap[e]?[4,this.loadImage(t)]:(c("Can not load image, invalid Atlas Name: %o for atlasMaps: %o",e,this.atlasMap),[2,!1]);case 1:if(n=r.sent(),t.atlasReferenceID=null,n){if(c("Image loaded: %o",t.imagePath),o=new a.Bounds(0,t.pixelWidth,t.pixelHeight,0),s={first:t,second:o},s.second.width+=1,s.second.height+=1,u=this.atlasMap[e],h=u.insert(s))return c("Atlas location determined: %o",h),t.label&&l("Atlas location determined. PackNode: %o Dimensions: %o",h,s),h.nodeImage=t,d=h.nodeDimensions.x/this.textureWidth,f=h.nodeDimensions.y/this.textureHeight,p=h.nodeDimensions.width/this.textureWidth,y=h.nodeDimensions.height/this.textureHeight,l("uy is %o",f),g=new a.Bounds(d,d+p,1-f,1-(f+y)),t.atlasReferenceID=e,t.atlasBL={x:g.x,y:g.y-g.height},t.atlasBR={x:g.x+g.width,y:g.y-g.height},t.atlasTL={x:g.x,y:g.y},t.atlasTR={x:g.x+g.width,y:g.y},i.drawImage(n,h.nodeDimensions.x,h.nodeDimensions.y),[2,!0];throw new Error("Could not fit image into atlas "+t.imagePath)}throw new Error("Could not load image "+t.imagePath)}})})},t.prototype.drawColors=function(t,e,i){return n(this,void 0,void 0,function(){var n,o,s,u,l,d,f,p,y,g,m,b,x,v,w,_,M,P,C,A,T,O,B,S,L,z,I,E,R,j,D,U;return r(this,function(r){if(c("Finding space for colors on the atlas: %o",t),n=2,o=2,s=512/n,u=Math.min(this.textureWidth,s*n),l=Math.ceil(t.length*n/u),d=Math.ceil(u/n),f=l*o,p={first:new h.AtlasTexture(null,null),second:new a.Bounds(0,u,f,0)},p.second.width+=1,p.second.height+=1,y=this.atlasMap[e],g=y.insert(p)){for(c("Atlas location determined for colors: %o",g),m=g.nodeImage=p.first,b=g.nodeDimensions.x/this.textureWidth,x=g.nodeDimensions.y/this.textureHeight,v=g.nodeDimensions.width/this.textureWidth,w=g.nodeDimensions.height/this.textureHeight,_=new a.Bounds(b,b+v,1-x,1-(x+w)),m.atlasReferenceID=e,m.atlasBL={x:_.x,y:_.y-_.height},m.atlasBR={x:_.x+_.width,y:_.y-_.height},m.atlasTL={x:_.x,y:_.y},m.atlasTR={x:_.x+_.width,y:_.y},M=g.nodeDimensions,P=M.x,C=M.y,A=n/this.textureWidth,T=-o/this.textureHeight,O=P/this.textureWidth+A/2,B=1-C/this.textureHeight+T/2,S=0,L=0,z=0,I=t;z<I.length;z++)E=I[z],E.atlasReferenceID=e,E.colorIndex=S+L*d,E.colorsPerRow=d,E.firstColor={x:O,y:B},E.nextColor={x:A,y:T},R=E.color,j=R.r,D=R.g,U=R.b,i.fillStyle="rgba("+Math.round(255*j)+", "+Math.round(255*D)+", "+Math.round(255*U)+", "+E.opacity+")",i.fillRect(S*n+P,L*o+C,n,o),++S===d&&(S=0,L++);return[2,m]}throw new Error("Could not fit colors into atlas")})})},t.prototype.getAtlasTexture=function(t){return this.atlasTexture[t]},t.prototype.loadImage=function(t){return t.imagePath?new Promise(function(e,i){var n=new Image;n.onload=function(){t.pixelWidth=n.width,t.pixelHeight=n.height,t.aspectRatio=n.width/n.height,e(n)},n.onerror=function(){e(null)},n.src=t.imagePath}):t.label?new Promise(function(e,i){var n=t.label,r=n.getSize(),s=document.createElement("canvas"),a=s.getContext("2d");if(s.width=r.width+t.label.rasterizationPadding.width,s.height=r.height+t.label.rasterizationPadding.height,a){var u=n.fontSize,h=o.rgb(255*n.r,255*n.g,255*n.b,n.a);a.font=n.makeCSSFont(u),a.textAlign=n.textAlign,a.textBaseline=n.textBaseline,a.fillStyle=h.toString(),a.fillText(n.text,t.label.rasterizationOffset.x,t.label.height/2+t.label.rasterizationOffset.y);var c=new Image;c.onload=function(){t.pixelWidth=c.width,t.pixelHeight=c.height,t.aspectRatio=c.width/c.height,l("Applying size based on rasterization to the Label: w: %o h: %o",c.width,c.height),n.setSize({height:c.height,width:c.width}),e(c)},c.onerror=function(){e(null)},c.src=s.toDataURL("image/png")}}):Promise.resolve(null)},t}();e.AtlasManager=d},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),r=function(){function t(t,e,i,r){this.child=[null,null],this.isLeaf=!0,this.nodeImage=null,this.nodeDimensions=new n.Bounds(t,t+i,e,e-r)}return t.prototype.destroy=function(){this.nodeImage=null,this.child[0]&&this.child[0].destroy(),this.child[1]&&this.child[1].destroy(),this.child[0]=void 0,this.child[1]=void 0},t.prototype.hasChild=function(){return this.child[0]&&!this.child[0].nodeImage?!this.child[0].isLeaf:!(!this.child[1]||this.child[1].nodeImage)&&!this.child[1].isLeaf},t.prototype.insert=function(e){if(!this.isLeaf){var i=this.child[0].insert(e);return null!==i?i:this.child[1].insert(e)}if(this.nodeImage)return null;var n=this.nodeDimensions.fits(e.second);if(0===n)return null;if(1===n)return this;this.isLeaf=!1;var r=e.second.width,o=e.second.height,s=this.nodeDimensions.width-r,a=this.nodeDimensions.height-e.second.height;return s>a?(this.child[0]=new t(this.nodeDimensions.x,this.nodeDimensions.y,r,this.nodeDimensions.height),this.child[1]=new t(this.nodeDimensions.x+r,this.nodeDimensions.y,s,this.nodeDimensions.height)):(this.child[0]=new t(this.nodeDimensions.x,this.nodeDimensions.y,this.nodeDimensions.width,o),this.child[1]=new t(this.nodeDimensions.x,this.nodeDimensions.y-o,this.nodeDimensions.width,a)),this.child[0].insert(e)},t.prototype.remove=function(t){if(this.isLeaf)return this.nodeImage===t&&(this.nodeImage=null,t.atlasReferenceID=null,t.pixelWidth=0,!0);var e=this.child[0].remove(t);return!!e||(e=this.child[1].remove(t),this.child[0].hasChild()||this.child[1].hasChild()||(this.child[0]=null,this.child[1]=null),e)},t}();e.PackNode=r},function(t,e,i){"use strict";function n(t){var e=t.nativeEvent,i=0,n=0;return Math.sign(y[0])!==Math.sign(n)&&y.splice(0,y.length,0,0,0,0),i=e.deltaX*p,n=e.deltaY*p*g+y[0]*m+y[1]*b+y[2]*x,y.unshift(n),y.pop(),new c.Vector2(-i,n)}function r(t){var e=t.nativeEvent;return new c.Vector2(e.deltaX,e.deltaY)}function o(t){var e=t.nativeEvent,i=e.deltaX;void 0===i&&(i=void 0!==e.wheelDeltaX?e.wheelDeltaX*d:0);var n=e.deltaY;return void 0===n&&(n=void 0!==e.wheelDeltaY?e.wheelDeltaY*d:(e.wheelDelta||-e.detail)*f),new c.Vector2(-i,n)}function s(t){var e=t.nativeEvent,i=e.deltaX,n=e.deltaY;void 0===i&&(i=void 0!==e.wheelDeltaX?e.wheelDeltaX*d:0),void 0===n&&(n=void 0!==e.wheelDeltaY?e.wheelDeltaY*d:e.wheelDelta||-e.detail);var r=new c.Vector2(i,n);return r.multiplyScalar(.25),r}function a(t,e){var i=0,n=0,r=0,o=0,s=e||t.nativeEvent.target;if(t||(t=window.event),t.pageX||t.pageY?(i=t.pageX,n=t.pageY):(t.clientX||t.clientY)&&(i=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),s.offsetParent)do{r+=s.offsetLeft,o+=s.offsetTop,s=s.offsetParent}while(s);return{x:i-r,y:n-o}}Object.defineProperty(e,"__esModule",{value:!0});var u,h=i(26),c=i(0),l=i(2)("CommunicationsView:Mouse"),d=1/30,f=-.25,p=100,y=[0,0,0,0],g=.1,m=.2,b=.2,x=.5;e.normalizeWheel=u,h.firefox?(l("Using mouse wheel for firefox"),e.normalizeWheel=u=n):h.msie&&+h.version>=11?(l("Using mouse wheel for IE 11"),e.normalizeWheel=u=o):h.msedge?(l("Using mouse wheel for MS EDGE"),e.normalizeWheel=u=s):(l("Using mouse wheel for Chrome"),e.normalizeWheel=u=r),e.eventElementPosition=a},function(t,e,i){"use strict";function n(t,e){var i=[];return e.forEach(function(e){t.find(function(t){return e instanceof t})&&i.push(e)}),i}var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=i(1);e.filterQuery=n;var s=function(){function t(t,e){this.TL=null,this.TR=null,this.BL=null,this.BR=null;var i=t.mid;this.TL=new a(t.x,i.x,t.y,i.y,e),this.TR=new a(i.x,t.right,t.y,i.y,e),this.BL=new a(t.x,i.x,i.y,t.bottom,e),this.BR=new a(i.x,t.right,i.y,t.bottom,e)}return t.prototype.destroy=function(){this.TL.destroy(),this.TR.destroy(),this.BL.destroy(),this.BR.destroy(),this.TL=null,this.TR=null,this.BL=null,this.BR=null},t}();e.Quadrants=s;var a=function(){function t(t,e,i,n,r){this.bounds=null,this.children=[],this.childrenProps=[],this.depth=0,this.nodes=null,arguments.length>=4?this.bounds=new o.Bounds(t,e,i,n):this.bounds=new o.Bounds(0,1,1,0),this.depth=r||0}return t.prototype.destroy=function(){this.children=null,this.bounds=null,this.nodes&&(this.nodes.destroy(),this.nodes=null)},t.prototype.add=function(t,e){return t.isInside(this.bounds)?this.doAdd(t):(this.cover(t),this.add(t,e))},t.prototype.addAll=function(t,e){var i=this;e=e||[];var n=Number.MAX_VALUE,r=Number.MAX_VALUE,s=-Number.MAX_VALUE,a=-Number.MAX_VALUE;t.forEach(function(t){t.x<n&&(n=t.x),t.right>s&&(s=t.right),t.bottom<r&&(r=t.bottom),t.y>a&&(a=t.y)}),this.cover(new o.Bounds(n,s,a,r)),t.forEach(function(t,e){return i.doAdd(t)})},t.prototype.cover=function(t){var e=this;if(!t.isInside(this.bounds)){this.bounds.encapsulate(t),this.bounds.x-=1,this.bounds.y-=1,this.bounds.width+=2,this.bounds.height+=2;var i=this.gatherChildren([]);this.nodes&&(this.nodes.destroy(),this.nodes=null),i.forEach(function(t,i){return e.doAdd(t)})}},t.prototype.doAdd=function(t){if(this.nodes)return t.isInside(this.nodes.TL.bounds)?this.nodes.TL.doAdd(t):t.isInside(this.nodes.TR.bounds)?this.nodes.TR.doAdd(t):t.isInside(this.nodes.BL.bounds)?this.nodes.BL.doAdd(t):t.isInside(this.nodes.BR.bounds)?this.nodes.BR.doAdd(t):(this.children.push(t),!0);if(t.isInside(this.bounds))return this.children.push(t),this.children.length>5&&this.depth<10&&this.split(),!0;throw new Error("Child does not fit in node.")},t.prototype.gatherChildren=function(t){return t=t.concat(this.children),this.nodes&&(this.nodes.TL.gatherChildren(t),this.nodes.TR.gatherChildren(t),this.nodes.BL.gatherChildren(t),this.nodes.BR.gatherChildren(t)),t},t.prototype.gatherProps=function(t){var e=this;return this.children.forEach(function(i,n){t.push(e.childrenProps[n])}),this.nodes&&(this.nodes.TL.gatherProps(t),this.nodes.TR.gatherProps(t),this.nodes.BL.gatherProps(t),this.nodes.BR.gatherProps(t)),t},t.prototype.query=function(t,e){return t instanceof o.Bounds?t.hitBounds(this.bounds)?this.queryBounds(t,[],e):[]:this.bounds.containsPoint(t)?this.queryPoint(t,[],e):[]},t.prototype.queryBounds=function(t,e,i){return this.children.forEach(function(i,n){i.hitBounds(t)&&e.push(i)}),i&&i(this),this.nodes&&(t.hitBounds(this.nodes.TL.bounds)&&this.nodes.TL.queryBounds(t,e,i),t.hitBounds(this.nodes.TR.bounds)&&this.nodes.TR.queryBounds(t,e,i),t.hitBounds(this.nodes.BL.bounds)&&this.nodes.BL.queryBounds(t,e,i),t.hitBounds(this.nodes.BR.bounds)&&this.nodes.BR.queryBounds(t,e,i)),e},t.prototype.queryPoint=function(t,e,i){return this.children.forEach(function(i,n){i.containsPoint(t)&&e.push(i)}),i&&i(this),this.nodes&&(this.nodes.TL.bounds.containsPoint(t)&&this.nodes.TL.queryPoint(t,e,i),this.nodes.TR.bounds.containsPoint(t)&&this.nodes.TR.queryPoint(t,e,i),this.nodes.BL.bounds.containsPoint(t)&&this.nodes.BL.queryPoint(t,e,i),this.nodes.BR.bounds.containsPoint(t)&&this.nodes.BR.queryPoint(t,e,i)),e},t.prototype.split=function(){var t=this.gatherChildren([]);for(this.nodes=new s(this.bounds,this.depth+1),this.children=[],this.childrenProps=[];t.length>0;)this.doAdd(t.pop())},t.prototype.visit=function(t){var e=Boolean(t(this));this.nodes&&!e&&(this.nodes.TL.visit(t),this.nodes.TR.visit(t),this.nodes.BL.visit(t),this.nodes.BR.visit(t))},t}();e.Node=a;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(a);e.QuadTree=u},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),o=0,s=function(t){function e(e,i,n,r){var s=t.call(this,0,0,0,0)||this;return s._id=++o,s._radius=0,s._centerX=0,s._centerY=0,s._centerX=e,s._centerY=i,s._radius=n,s.d=r,s.updateBounds(),s}return n(e,t),Object.defineProperty(e.prototype,"values",{get:function(){return{x:this._centerX,y:this._centerY,radius:this._radius}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this.updateBounds()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"centerX",{get:function(){return this._centerX},set:function(t){this._centerX=t,this.updateBounds()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"centerY",{get:function(){return this._centerY},set:function(t){this._centerY=t,this.updateBounds()},enumerable:!0,configurable:!0}),e.prototype.boundsInside=function(t){var e=this._radius*this._radius,i=t.x-this._centerX,n=t.y-this._centerY,r=n*n,o=i*i;return!(o+r>e)&&(i=t.right-this._centerX,!((o=i*i)+r>e)&&(n=t.bottom-this._centerY,r=n*n,!(o+r>e)&&(i=t.x-this._centerX,(o=i*i)+r<e)))},e.prototype.distanceTo=function(t,e){var i=this._centerX-t.x,n=this._centerY-t.y;return e?i*i+n*n:Math.sqrt(i*i+n*n)},e.getClosest=function(t,e){var i,n=Number.MAX_VALUE,r=0;return t.forEach(function(t){(r=t.distanceTo(e,!0))<n&&(i=t,n=r)}),i},e.prototype.hitCircle=function(t){var e=t._radius+this._radius;return e*=e,this.distanceTo({x:t._centerX,y:t._centerY},!0)<e},e.prototype.hitPoint=function(t){var e=this._radius*this._radius,i=t.x-this._centerX,n=t.y-this._centerY;return i*i+n*n<e},e.prototype.position=function(t,e,i){this._centerX=t,this._centerY=e,this._radius=i,this.updateBounds()},e.prototype.pointInside=function(t){var e=this._radius*this._radius,i=t.x-this._centerX,n=t.y-this._centerY;return i*i+n*n<e},e.prototype.updateBounds=function(){var t=this._radius;this.x=this._centerX-t,this.y=this._centerY-t,this.height=2*t,this.width=2*t},e.prototype.toString=function(){return"[Circle {x: "+this._centerX+", y: "+this._centerY+", r: "+this._radius+"}]"},e}(r.Bounds);e.Circle=s},function(t,e,i){"use strict";function n(t,e){var i,n=t.getLineStrip(),r=m.Point.getClosestIndex(e,n),o=Number.MAX_VALUE;return r>0&&(i=new g.Line(n[r],n[r-1]),o=i.distanceTo(e)),r<n.length-1&&(i=new g.Line(n[r],n[r+1]),o=Math.min(o,i.distanceTo(e))),o}function r(t,e){var i,n=t.getLineStrip(),r=m.Point.getClosestIndex(e,n),o=Number.MAX_VALUE;return r>0&&(i=new g.Line(n[r],n[r-1]),o=i.distanceTo(e)),r<n.length-1&&(i=new g.Line(n[r],n[r+1]),o=Math.min(o,i.distanceTo(e))),o}function o(t,e){return new g.Line(t.p1,t.p2).distanceTo(e)}function s(t){if(t.cachesSegments&&t.cachedSegments)return t.cachedSegments;for(var e=[],i=1/t.resolution,n=t.p1,r=t.p2,o=t.controlPoints[0],s=0,a=t.resolution;s<=a;++s)e.push(p.bezier2(i*s,n,r,o));return t.cachesSegments&&(t.cachedSegments=e),e}function a(t){if(t.cachesSegments&&t.cachedSegments)return t.cachedSegments;for(var e=[],i=1/t.resolution,n=t.p1,r=t.p2,o=t.controlPoints[0],s=t.controlPoints[1],a=0,u=t.resolution;a<=u;++a)e.push(p.bezier3(i*a,n,r,o,s));return t.cachesSegments&&(t.cachedSegments=e),e}function u(t){if(t.cachesSegments&&t.cachedSegments)return t.cachedSegments;b("CW");var e=new g.Line(t.p1,t.p2),i=m.Point.getDistance(t.p1,t.controlPoints[0]),n=m.Point.getMidpoint(t.p1,t.p2),r=m.Point.getDistance(n,t.p1);i<r&&(i=m.Point.getDistance(n,t.p1));var o=e.perpendicular,s=Math.sqrt(i*i-r*r),a={x:o.x*s+n.x,y:o.y*s+n.y};t.controlPoints[1]=a,b(" center of circle is %o  %o",a.x,a.y);var u=m.Point.getDirection(a,t.p1),h=Math.atan2(u.y,u.x),c=m.Point.getDirection(a,t.p2),l=Math.atan2(c.y,c.x);h<l&&(h+=2*Math.PI);var d=(h-l)/t.resolution;b("theta1 is %o, theta2 is %o",h,l);for(var f=[],p=0,y=t.resolution+1;p<y;++p)f.push({x:Math.cos(h-d*p)*i+a.x,y:Math.sin(h-d*p)*i+a.y});return t.cachesSegments&&(t.cachedSegments=f),b("Generated Circular Segments: %o dTheta: %o radius: %o",f,d,i),f}function h(t){if(t.cachesSegments&&t.cachedSegments)return t.cachedSegments;var e=new g.Line(t.p1,t.p2),i=m.Point.getDistance(t.p1,t.controlPoints[0]),n=m.Point.getMidpoint(t.p1,t.p2),r=m.Point.getDistance(n,t.p1);i<r&&(i=m.Point.getDistance(n,t.p1));var o=e.perpendicular,s=Math.sqrt(i*i-r*r),a={x:-o.x*s+n.x,y:-o.y*s+n.y};t.controlPoints[1]=a;var u=m.Point.getDirection(a,t.p1),h=Math.atan2(u.y,u.x),c=m.Point.getDirection(a,t.p2),l=Math.atan2(c.y,c.x);l<h&&(l+=2*Math.PI);for(var d=(l-h)/t.resolution,f=[],p=0,y=t.resolution+1;p<y;++p)f.push({x:Math.cos(h+d*p)*i+a.x,y:Math.sin(h+d*p)*i+a.y});return t.cachedSegments&&(t.cachedSegments=f),f}function c(t){return[t.p1,t.p2]}var l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var d,f=i(6),p=i(16),y=i(1),g=i(5),m=i(9),b=i(2)("bezier");!function(t){t[t.Bezier=0]="Bezier",t[t.CircularCCW=1]="CircularCCW",t[t.CircularCW=2]="CircularCW",t[t.Straight=3]="Straight"}(d=e.CurveType||(e.CurveType={}));var x=(_={},_[d.Bezier]=[null,s,a],_[d.CircularCW]=[null,u,u],_[d.CircularCCW]=[null,h,h],_[d.Straight]=[c],_),v=(M={},M[d.Bezier]=n,M[d.CircularCW]=r,M[d.CircularCCW]=r,M[d.Straight]=o,M),w=function(t){function e(e){var i=this,n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=Number.MAX_VALUE,s=-Number.MAX_VALUE;return i=t.call(this,n,r,s,o)||this,i.cachesSegments=e.cacheSegments||!1,i.type=e.type,i.resolution=e.resolution||20,i.setPoints(e.start,e.end,e.controlPoints),i.distanceMethod=v[e.type],i}return l(e,t),Object.defineProperty(e.prototype,"values",{get:function(){return{controlPoints:this.controlPoints,p1:this.p1,p2:this.p2}},enumerable:!0,configurable:!0}),e.prototype.distanceTo=function(t){return this.distanceMethod(this,t)},e.getClosest=function(t,e){var i,n=Number.MAX_VALUE,r=0;return t.forEach(function(t){(r=t.distanceTo(e))<n&&(i=t,n=r)}),i},e.prototype.getLineStrip=function(){return this.segmentMethod(this)},e.prototype.setPoints=function(t,e,i){this.p1=t,this.p2=e;var n=x[this.type];if(i){this.controlPoints=f.clone(i);var r=i.length;if(r>n.length&&(r=n.length-1),this.segmentMethod=n[r],!this.segmentMethod)throw new Error("An Invalid number of control points was provided to a curved line. You must have at LEAST 1 control point. Or 0 for a straight line");this.type===d.Bezier?this.encapsulatePoints(i):this.type!==d.CircularCCW&&this.type!==d.CircularCW||this.encapsulatePoints(this.getLineStrip())}this.encapsulatePoint(t),this.encapsulatePoint(e),this.cachedSegments=null},e}(y.Bounds);e.CurvedLine=w;var _,M},function(t,e,i){"use strict";function n(t,e,i,n){var r=t*t,o=1-t,s=o*o;return{x:e.x*s+2*n.x*o*t+i.x*r,y:e.y*s+2*n.y*o*t+i.y*r}}function r(t,e,i,n,r){var o=t*t,s=o*t,a=1-t,u=a*a,h=u*a;return{x:e.x*h+3*n.x*u*t+3*r.x*a*o+i.x*s,y:e.y*h+3*n.y*u*t+3*r.y*a*o+i.y*s}}Object.defineProperty(e,"__esModule",{value:!0}),e.bezier2=n,e.bezier3=r},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(5),o=function(t){function e(e,i,n,r,o,s,a,u,h,c,l,d){var f=t.call(this,e,i)||this;return f.r=1,f.g=0,f.b=0,f.a=0,f.r2=1,f.g2=0,f.b2=0,f.a2=0,f.cull=!0,f.thickness=1,Object.assign(f,{d:n,r:r,g:o,b:s,a:a,r2:u,g2:h,b2:c,a2:l}),void 0!==d&&(f.thickness=d),f}return n(e,t),e.prototype.clone=function(t){return Object.assign(new e(this.p1,this.p2,this.d,this.r,this.g,this.b,this.a,this.r2,this.g2,this.b2,this.a2),this,t)},e}(r.Line);e.LineShape=o},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r,o=i(0),s=i(1);!function(t){t[t.BottomLeft=0]="BottomLeft",t[t.BottomRight=1]="BottomRight",t[t.Custom=2]="Custom",t[t.Middle=3]="Middle",t[t.MiddleBottom=4]="MiddleBottom",t[t.MiddleLeft=5]="MiddleLeft",t[t.MiddleRight=6]="MiddleRight",t[t.MiddleTop=7]="MiddleTop",t[t.TopLeft=8]="TopLeft",t[t.TopRight=9]="TopRight"}(r=e.AnchorPosition||(e.AnchorPosition={}));var a=(h={},h[r.BottomLeft]=function(t){return{x:0,y:0}},h[r.BottomRight]=function(t){return{x:t.getSize().width,y:0}},h[r.Custom]=function(t){return{x:0,y:t.getSize().height}},h[r.Middle]=function(t){return{x:t.getSize().width/2,y:t.getSize().height/2}},h[r.MiddleBottom]=function(t){return{x:t.getSize().width/2,y:0}},h[r.MiddleLeft]=function(t){return{x:0,y:t.getSize().height/2}},h[r.MiddleRight]=function(t){return{x:t.getSize().width,y:t.getSize().height/2}},h[r.MiddleTop]=function(t){return{x:t.getSize().width/2,y:t.getSize().height}},h[r.TopLeft]=function(t){return{x:0,y:t.getSize().height}},h[r.TopRight]=function(t){return{x:t.getSize().width,y:t.getSize().height}},h),u=function(t){function e(e,i,n,o){void 0===o&&(o=r.Middle);var s=t.call(this,0,0,0,0)||this;return s.setSize(i),s.setAnchor(o),s.setLocation(e),s.setRotation(n),s.update(),s}return n(e,t),e.prototype.calculateAnchor=function(t){this.anchor=a[t](this)},e.prototype.getSize=function(){return this.size},e.prototype.setAnchor=function(t,e){if(void 0===t&&(t=r.Middle),this.anchorType=t,e)return this.anchorType=r.Custom,void(this.anchor=e);this.calculateAnchor(t)},e.prototype.setLocation=function(t){this.location=t},e.prototype.setRotation=function(t){this.rotation=t},e.prototype.setSize=function(t){this.size=t,this.base=[new o.Vector4(0,t.height,0,1),new o.Vector4(t.width,t.height,0,1),new o.Vector4(0,0,0,1),new o.Vector4(t.width,0,0,1)]},e.prototype.update=function(){var t=(new o.Matrix4).makeTranslation(this.anchor.x,-this.anchor.y,0),e=(new o.Matrix4).makeRotationZ(this.rotation),i=(new o.Matrix4).makeTranslation(this.location.x,this.location.y,0);this.transform=(new o.Matrix4).multiply(i).multiply(e).multiply(t),this.TL=this.base[0].clone().applyMatrix4(this.transform),this.TR=this.base[1].clone().applyMatrix4(this.transform),this.BL=this.base[2].clone().applyMatrix4(this.transform),this.BR=this.base[3].clone().applyMatrix4(this.transform),this.x=this.TL.x,this.y=this.TL.y,this.width=1,this.height=1,this.encapsulatePoints([this.TR,this.BL,this.BR])},e}(s.Bounds);e.RotateableQuad=u;var h},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n){this.scaleX=1,this.scaleY=1;var r=document.createElement("canvas");r&&(this.scaleX=i||this.scaleX,this.scaleY=n||this.scaleY,r.width=t*this.scaleX,r.height=e*this.scaleY,this.context=r.getContext("2d"),this.canvas=r)}return t.prototype.getContentScale=function(){return{x:this.scaleX,y:this.scaleY}},t.prototype.getContentSize=function(){return{height:this.canvas.height,width:this.canvas.width}},t.prototype.getWidth=function(){return this.canvas.width/this.scaleX},t.prototype.getHeight=function(){return this.canvas.height/this.scaleY},t}();e.Sprite=n},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(21)),n(i(27)),n(i(32)),n(i(41)),n(i(43))},function(t,e,i){"use strict";function n(t){return t?t>0?1:t<0?-1:0:0}var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o,s=i(6),a=i(22),u=i(0),h=i(10),c=i(8),l=i(1),d=i(12),f=i(13),p=i(2)("webgl-surface:GPU"),y=i(2)("webgl-surface:Camera"),g=i(2)("webgl-surface:Labels");!function(t){t[t.INITIALIZE=0]="INITIALIZE",t[t.BUFFERCHANGES=1]="BUFFERCHANGES",t[t.CAMERA=2]="CAMERA",t[t.LABELS=3]="LABELS",t[t.COLORS=4]="COLORS"}(o=e.BaseApplyPropsMethods||(e.BaseApplyPropsMethods={}));var m;!function(t){t[t.CONTEXT=0]="CONTEXT",t[t.INERTIA=1]="INERTIA",t[t.POSITION=2]="POSITION",t[t.ZOOM=3]="ZOOM"}(m=e.BaseAnimatedMethods||(e.BaseAnimatedMethods={}));var b=(new u.Color).setRGB(38/255,50/255,78/255),x=new u.Vector3,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.atlasManager=new h.AtlasManager(2048,2048),e.atlasNames={colors:"colors",labels:"labels"},e.animatedMethodList=[],e.animatedMethodBreak=!1,e.distance=0,e.camera=null,e.disableMouseInteraction=0,e.sizeCamera=null,e.currentZoom=1,e.destinationX=0,e.destinationY=0,e.destinationZoom=1,e.isPanning=!1,e.lastMousePosition={x:0,y:0},e.propsMethodList=[],e.inertia=null,e.inertiaBuild=1.5,e.inertiaDecay=.9,e.inertiaMax=100,e.quadTree=null,e.shiftIsDown=!1,e.stop=!1,e.currentX=0,e.currentY=0,e.targetZoom=1,e.previousZoomToFit=0,e.zoomTargetX=0,e.zoomTargetY=0,e.animating=!1,e.labels=[],e.labelsReady=!1,e.colors=[],e.colorsReady=!1,e.currentHoverItems=[],e.animate=function(){if(!e.stop){requestAnimationFrame(function(){return e.animate()});var t,i=!1;e.animatedMethodList.some(function(n){return t=n(),i||(i=t.doDraw),t.stop&&(e.stop=!0),!!t.break})||(e.updateCameraUniforms(),e.disableMouseInteraction>0&&e.disableMouseInteraction--,(i||e.forceDraw)&&(e.forceDraw=!1,e.emitViewport(),e.draw()))}},e.applyProps=function(t){p("Applying props");var i;e.propsMethodList.some(function(e){return i=e(t),!!i.break}),y("current cam",e.currentX,e.currentY,e.destinationX,e.destinationY),y("Zoom Target: [%o, %o]",e.zoomTargetX,e.zoomTargetY),y("Last Mouse: [%o, %o]",e.lastMousePosition.x,e.lastMousePosition.y)},e.draw=function(){e.renderer.render(e.scene,e.camera)},e.init=function(t,i,n){if(t&&!e.scene&&(e.renderEl=t,0!==i&&0!==n)){p("Initializing GPU objects el: %o width: %o height: %o",t,i,n),e.ctx={height:n,heightHalf:n/2,width:i,widthHalf:i/2},e.initCamera(),window.scene=e.scene=new u.Scene,e.initBuffers(),e.renderer=new u.WebGLRenderer({antialias:!0}),p("Window Pixel Ratio: %o",window.devicePixelRatio),e.renderer.setPixelRatio(window.devicePixelRatio),e.renderer.setSize(i,n),e.renderer.setClearColor(b),e.renderer.setFaceCulling(u.CullFaceNone);t.appendChild(e.renderer.domElement)}},e.initCamera=function(){p("Initializing Camera");var t=e.ctx.height,i=t,n=e.ctx.width,r=n/t,o={aspectRatio:r,bottom:-i/2,far:1e7,left:-r*i/2,near:-100,right:r*i/2,top:i/2,viewSize:i};e.camera=new u.OrthographicCamera(o.left,o.right,o.top,o.bottom,o.near,o.far),e.sizeCamera=new u.OrthographicCamera(o.left,o.right,o.top,o.bottom,o.near,o.far),e.camera.position.z=300,e.sizeCamera.position.set(0,0,300)},e.resizeContext=function(){var t=e.props.width,i=e.props.height;if(!e.renderer)return!1;var n=e.renderer.getSize();if(n.width===t&&n.height===i)return!1;p("RENDERER RESIZE"),e.ctx={height:i,heightHalf:i/2,width:t,widthHalf:t/2};var r=e.camera.zoom,o=e.camera.position.clone();return e.initCamera(),e.camera.zoom=r,e.camera.position.set(o.x,o.y,o.z),e.camera.updateProjectionMatrix(),e.renderer.setPixelRatio(window.devicePixelRatio),e.renderer.setSize(t,i),e.renderer.setClearColor((new u.Color).setRGB(38/255,50/255,78/255)),e.renderer.setFaceCulling(u.CullFaceNone),!0},e.emitViewport=function(){var t=e.screenToWorld(0,0),i=e.screenToWorld(e.ctx.width,e.ctx.height);e.camera.updateMatrixWorld(!0);var n=e.quadTree.query(new l.Bounds(t.x,i.x,t.y,i.y));e.onViewport(n,e.projection,e.ctx)},e.handleMouseDown=function(t){e.disableMouseInteraction>0||(e.isPanning=!0,e.distance=0,e.onMouseDown())},e.handleMouseOut=function(t){e.disableMouseInteraction>0||(e.isPanning=!1,e.distance=0,e.onMouseOut())},e.handleMouseUp=function(t){if(!(e.disableMouseInteraction>0)){e.isPanning=!1;var i=d.eventElementPosition(t),n=e.screenToWorld(i.x,i.y);if(e.distance<5){for(var r=[],o=e.quadTree.query(n),s=0,a=o;s<a.length;s++){var u=a[s];u.pointInside(n)&&r.push(u)}r.length?e.onMouseUp(t,r,i,n,e.projection):e.onMouseUp(t,null,i,n,e.projection)}}},e.handleMouseMove=function(t){if(!(e.disableMouseInteraction>0)){var i=e.props.onMouse,r=e.props.zoom,o=d.eventElementPosition(t),s=e.screenToWorld(o.x,o.y);if(e.distance++,e.isPanning){var a=(o.x-e.lastMousePosition.x)/e.targetZoom,u=-(o.y-e.lastMousePosition.y)/e.targetZoom,h=e.willPan(a,u);a=h.x,u=h.y,e.destinationX-=a,e.destinationY-=u,e.inertia=e.inertia||{x:0,y:0},n(a)!==n(e.inertia.x)&&(e.inertia.x=0),n(u)!==n(e.inertia.y)&&(e.inertia.y=0),e.inertia.x=a*e.inertiaBuild,e.inertia.y=u*e.inertiaBuild;var c=e.inertiaMax/r,l=Math.sqrt(e.inertia.x*e.inertia.x+e.inertia.y*e.inertia.y);l>c&&(e.inertia.x=e.inertia.x/l*c,e.inertia.y=e.inertia.y/l*c)}if(e.quadTree&&!e.isPanning){for(var f=[],p=e.quadTree.query(s),y=[],g=0,m=p;g<m.length;g++){var b=m[g];b.pointInside(s)&&(y.push(b),f.push(b))}e.onMouseHover(y,o,s,e.projection);for(var x=[],v=0,w=e.currentHoverItems;v<w.length;v++){var b=w[v];f.indexOf(b)<0&&x.push(b)}e.onMouseLeave(x,o,s,e.projection),e.currentHoverItems=f}i&&e.onMouse(o,s,e.isPanning),e.lastMousePosition=o}},e.applyRef=function(t){e.init(t,e.props.width,e.props.height),e.applyProps(e.props)},e}return r(e,t),e.prototype.animatedMethods=function(t,e){return e},e.prototype.animatedMethodsBase=function(){var t=this;return e={},e[m.CONTEXT]=function(){var e={break:!1,doDraw:!1};return t.resizeContext()&&(e.doDraw=!0),t.quadTree||(e.break=!0),e},e[m.INERTIA]=function(){return t.isPanning||t.inertia&&(t.inertia.x*=t.inertiaDecay,t.inertia.y*=t.inertiaDecay,t.inertia.x*t.inertia.x+t.inertia.y*t.inertia.y<1&&(t.inertia=null)),{doDraw:!1}},e[m.POSITION]=function(){var e={doDraw:t.currentX!==t.destinationX||t.currentY!==t.destinationY};return t.currentX=t.destinationX,t.currentY=t.destinationY,t.positionCamera(t.currentX,t.currentY),e},e[m.ZOOM]=function(){var e={doDraw:!1},i=1*t.destinationZoom,n=Math.abs(i-t.targetZoom);n>.001?(t.targetZoom=t.targetZoom+(i-t.targetZoom)/3,e.doDraw=!0):0!==n&&(t.targetZoom=i,e.doDraw=!0);var r=t.zoomTargetX,o=t.zoomTargetY,s=t.worldToScreen(r,o);t.zoomCamera(t.targetZoom);var a=t.worldToScreen(r,o),u=-(a.x-s.x)/t.targetZoom,h=(a.y-s.y)/t.targetZoom;return t.currentX-=u,t.currentY-=h,t.destinationX-=u,t.destinationY-=h,t.positionCamera(t.currentX,t.currentY),e},e;var e},e.prototype.applyColorBufferChanges=function(t){},e.prototype.applyLabelBufferChanges=function(t){},e.prototype.applyPropsMethods=function(t,e){return e},e.prototype.applyPropsMethodsBase=function(){var t=this;return e={},e[o.INITIALIZE]=function(e){var i=e.height,n=e.width;if(t.init(t.renderEl,n,i),!t.renderEl||0===n||0===i)return{break:!0};if(t.camera){var r=t.screenToWorld(t.lastMousePosition.x,t.lastMousePosition.y);t.zoomTargetX=r.x,t.zoomTargetY=r.y}return p("props",e),{}},e[o.LABELS]=function(e){var i={};if(e.labels&&e.labels!==t.labels){g("Labels are being comitted to an Atlas %o",e.labels),t.labelsReady=!1,t.labels=e.labels,t.atlasManager.getAtlasTexture(t.atlasNames.labels)&&t.atlasManager.destroyAtlas(t.atlasNames.labels);var n=e.labels.map(function(t){return new c.AtlasTexture(null,t)});g("Creating the atlas for labels based on these textures %o",n),t.atlasManager.createAtlas(t.atlasNames.labels,n).then(function(){g("Labels rasterized within the atlas!"),t.forceDraw=!0,t.labelsReady=!0,t.applyProps(t.props)})}return i},e[o.COLORS]=function(e){var i={};return e.colors&&e.colors!==t.colors&&(g("Colors are being comitted to an Atlas %o",e.colors),t.colorsReady=!1,t.colors=e.colors,t.atlasManager.getAtlasTexture(t.atlasNames.colors)&&t.atlasManager.destroyAtlas(t.atlasNames.colors),g("Creating the atlas for colors based on these colors %o",t.colors),t.atlasManager.createAtlas(t.atlasNames.colors,null,t.colors).then(function(){g("Colors rasterized within the atlas!"),t.forceDraw=!0,t.colorsReady=!0,t.applyProps(t.props)})),i},e[o.BUFFERCHANGES]=function(e){return t.applyBufferChanges(e),t.labelsReady&&(g("labels changed %o",e),t.applyLabelBufferChanges(e)),t.colorsReady&&t.applyColorBufferChanges(e),{}},e[o.CAMERA]=function(e){if(t.destinationZoom=e.zoom,e.viewport&&e.viewport!==t.appliedViewport&&t.quadTree){y("Applying viewport to camera: %o World Space Bounds: %o",e.viewport,t.quadTree.bounds);var i=e.viewport.mid;t.currentX=t.destinationX=i.x,t.currentY=t.destinationY=i.y;var n=t.ctx.width/e.viewport.width,r=t.ctx.height/e.viewport.height,o=Math.min(n,r);t.destinationZoom=o/1,t.targetZoom=1*t.destinationZoom*1.001,t.zoomTargetX=i.x,t.zoomTargetY=i.y,t.lastMousePosition.x=t.ctx.widthHalf,t.lastMousePosition.y=t.ctx.heightHalf,t.positionCamera(t.currentX,t.currentY),t.zoomCamera(t.targetZoom),t.updateCameraUniforms(),e.onZoomRequest&&(e.onZoomRequest(t.destinationZoom),y("Requesting zoom level",t.destinationZoom));t.disableMouseInteraction=10,t.appliedViewport=e.viewport,y("init cam",t.currentX,t.currentY)}return t.quadTree||(t.quadTree=new f.QuadTree(0,1,1,0)),{}},e;var e},e.prototype.applyBufferChanges=function(t){},e.prototype.componentDidMount=function(){this.animate()},e.prototype.componentWillMount=function(){this.projection={screenSizeToWorld:this.screenSizeToWorld.bind(this),screenToWorld:this.screenToWorld.bind(this),worldSizeToScreen:this.worldSizeToScreen.bind(this),worldToScreen:this.worldToScreen.bind(this)};var t=this.applyPropsMethodsBase();this.propsMethodList=this.applyPropsMethods(t,[t[o.INITIALIZE],t[o.LABELS],t[o.COLORS],t[o.BUFFERCHANGES],t[o.CAMERA]]);var e=this.animatedMethodsBase();this.animatedMethodList=this.animatedMethods(e,[e[m.CONTEXT],e[m.INERTIA],e[m.POSITION],e[m.ZOOM]])},e.prototype.componentWillReceiveProps=function(t){this.applyProps(t)},e.prototype.componentWillUnmount=function(){this.stop=!0,this.quadTree&&this.quadTree.destroy(),this.quadTree=null,this.camera=null,this.sizeCamera=null,this.ctx=null,this.renderEl=null,this.renderer=null,this.scene=null},e.prototype.initBuffers=function(){},e.prototype.onMouse=function(t,e,i){},e.prototype.onMouseDown=function(){},e.prototype.onMouseOut=function(){},e.prototype.onMouseUp=function(t,e,i,n,r){},e.prototype.onMouseHover=function(t,e,i,n){},e.prototype.onMouseLeave=function(t,e,i,n){},e.prototype.onViewport=function(t,e,i){},e.prototype.positionCamera=function(t,e){this.camera&&this.camera.position.set(Math.floor(t),Math.floor(e),this.camera.position.z)},e.prototype.screenToWorld=function(t,e,i){return x.set(t/this.ctx.width*2-1,-e/this.ctx.height*2+1,0),x.unproject(this.camera),i=i||{x:0,y:0},i.x=x.x,i.y=x.y,i},e.prototype.screenSizeToWorld=function(t,e,i){return i=i||new l.Bounds(0,0,0,0),i.width=t/(this.sizeCamera?this.sizeCamera.zoom:1),i.height=e/(this.sizeCamera?this.sizeCamera.zoom:1),i},e.prototype.worldToScreen=function(t,e,i){return x.set(t,e,0),x.project(this.camera),i=s.merge(i||{},{x:x.x*this.ctx.widthHalf+this.ctx.widthHalf,y:-x.y*this.ctx.heightHalf+this.ctx.heightHalf})},e.prototype.worldSizeToScreen=function(t,e,i){return i=i||new l.Bounds(0,0,0,0),i.width=t*this.sizeCamera.zoom,i.height=e*this.sizeCamera.zoom,i},e.prototype.zoomCamera=function(t){this.camera.zoom=t,this.sizeCamera.zoom=t,this.camera.updateProjectionMatrix(),this.sizeCamera.updateProjectionMatrix()},e.prototype.updateCameraUniforms=function(){},e.prototype.shouldComponentUpdate=function(t){return this.props.width!==t.width||this.props.height!==t.height},e.prototype.willPan=function(t,e){return new u.Vector3(t,e,0)},e.prototype.render=function(){var t=this,e=this.props,i=e.width,n=e.height;return a.createElement("div",{onMouseDown:this.handleMouseDown,onMouseOut:this.handleMouseOut,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseOut,onMouseMove:this.handleMouseMove,onDoubleClick:function(e){t.props.onDoubleClick&&t.props.onDoubleClick(e)},style:{position:"relative",width:i,height:n}},a.createElement("div",{ref:this.applyRef}))},e}(a.Component);e.WebGLSurface=v},function(t,e){t.exports=n},function(t,e){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function r(t){if(c===setTimeout)return setTimeout(t,0);if((c===i||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function s(){y&&f&&(y=!1,f.length?p=f.concat(p):g=-1,p.length&&a())}function a(){if(!y){var t=r(s);y=!0;for(var e=p.length;e;){for(f=p,p=[];++g<e;)f&&f[g].run();g=-1,e=p.length}f=null,y=!1,o(t)}}function u(t,e){this.fun=t,this.array=e}function h(){}var c,l,d=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:i}catch(t){c=i}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(t){l=n}}();var f,p=[],y=!1,g=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];p.push(new u(t,e)),1!==p.length||y||r(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=h,d.addListener=h,d.once=h,d.off=h,d.removeListener=h,d.removeAllListeners=h,d.emit=h,d.prependListener=h,d.prependOnceListener=h,d.listeners=function(t){return[]},d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(t,e,i){function n(t){var i,n=0;for(i in t)n=(n<<5)-n+t.charCodeAt(i),n|=0;return e.colors[Math.abs(n)%e.colors.length]}function r(t){function i(){if(i.enabled){var t=i,n=+new Date,r=n-(h||n);t.diff=r,t.prev=h,t.curr=n,h=n;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var a=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(i,n){if("%%"===i)return i;a++;var r=e.formatters[n];if("function"==typeof r){var s=o[a];i=r.call(t,s),o.splice(a,1),a--}return i}),e.formatArgs.call(t,o);(i.log||e.log||console.log.bind(console)).apply(t,o)}}return i.namespace=t,i.enabled=e.enabled(t),i.useColors=e.useColors(),i.color=n(t),"function"==typeof e.init&&e.init(i),i}function o(t){e.save(t),e.names=[],e.skips=[];for(var i=("string"==typeof t?t:"").split(/[\s,]+/),n=i.length,r=0;r<n;r++)i[r]&&(t=i[r].replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))}function s(){e.enable("")}function a(t){var i,n;for(i=0,n=e.skips.length;i<n;i++)if(e.skips[i].test(t))return!1;for(i=0,n=e.names.length;i<n;i++)if(e.names[i].test(t))return!0;return!1}function u(t){return t instanceof Error?t.stack||t.message:t}e=t.exports=r.debug=r.default=r,e.coerce=u,e.disable=s,e.enable=o,e.enabled=a,e.humanize=i(25),e.names=[],e.skips=[],e.formatters={};var h},function(t,e){function i(t){if(t=String(t),!(t.length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var i=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return i*c;case"days":case"day":case"d":return i*h;case"hours":case"hour":case"hrs":case"hr":case"h":return i*u;case"minutes":case"minute":case"mins":case"min":case"m":return i*a;case"seconds":case"second":case"secs":case"sec":case"s":return i*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function n(t){return t>=h?Math.round(t/h)+"d":t>=u?Math.round(t/u)+"h":t>=a?Math.round(t/a)+"m":t>=s?Math.round(t/s)+"s":t+"ms"}function r(t){return o(t,h,"day")||o(t,u,"hour")||o(t,a,"minute")||o(t,s,"second")||t+" ms"}function o(t,e,i){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}var s=1e3,a=60*s,u=60*a,h=24*u,c=365.25*h;t.exports=function(t,e){e=e||{};var o=typeof t;if("string"===o&&t.length>0)return i(t);if("number"===o&&!1===isNaN(t))return e.long?r(t):n(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e){t.exports=r},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(3)),n(i(28)),n(i(29)),n(i(30)),n(i(31))},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),o=i(4),s=i(3),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(t,e){this.bufferItems=o.BufferUtil.makeBufferItems(),this.bufferItems.attributes=[{defaults:[0,0,0],name:"position",size:o.AttributeSize.THREE},{defaults:[0],name:"startColorPick",size:o.AttributeSize.ONE},{defaults:[0],name:"endColorPick",size:o.AttributeSize.ONE},{defaults:[1],name:"normalDirection",size:o.AttributeSize.ONE},{defaults:[0,0,0,0],name:"endPoints",size:o.AttributeSize.FOUR},{defaults:[0],name:"halfLinewidth",size:o.AttributeSize.ONE}];var i=e;this.bufferItems.geometry=o.BufferUtil.makeBuffer(6*i,this.bufferItems.attributes),this.bufferItems.system=new r.Mesh(this.bufferItems.geometry,t),this.bufferItems.system.frustumCulled=!1,this.bufferItems.system.drawMode=r.TriangleStripDrawMode},e.prototype.update=function(t,e,i){if(!t)return!1;if(t&&t.length>0&&e){var n=t[0].startColor,r=n.base,s=this.bufferItems.system.material,a=s.uniforms,u=e.getAtlasTexture(r.atlasReferenceID);a.colorAtlas.value=u,a.colorsPerRow.value=r.colorsPerRow,a.firstColor.value=[r.firstColor.x,r.firstColor.y],a.nextColor.value=[r.nextColor.x,r.nextColor.y],a.controlPoint.value=[i.x,i.y],u.needsUpdate=!0}var h,c,l,d,f,p=1,y=15,g=!1;o.BufferUtil.beginUpdates();for(var m=this,b=0,x=t;b<x.length;b++){var v=x[b];if("break"===function(e){if(f=e.startColor.base.opacity,l=e.startColor.base,d=e.endColor.base,p=e.lineWidth/2,y=e.resolution,h=e.p1,c=e.p2,!(g=o.BufferUtil.updateBuffer(t,m.bufferItems,6,y,function(t,i,n,r,o,s,a,u,f,g,m,b,x){i[n]=(t+1)/y,i[++n]=y,i[++n]=e.depth,b[x]=p,o+=1,a+=1,u[f]=1,g[m]=h.x,g[++m]=h.y,g[++m]=c.x,g[++m]=c.y,i[++n]=(t+1)/y,i[++n]=y,i[++n]=e.depth,b[++x]=p,u[++f]=1,g[++m]=h.x,g[++m]=h.y,g[++m]=c.x,g[++m]=c.y,r[o]=l.colorIndex,s[a]=d.colorIndex,i[++n]=(t+1)/y,i[++n]=y,i[++n]=e.depth,b[++x]=p,u[++f]=-1,g[++m]=h.x,g[++m]=h.y,g[++m]=c.x,g[++m]=c.y,r[++o]=l.colorIndex,s[++a]=d.colorIndex,i[++n]=t/y,i[++n]=y,i[++n]=e.depth,b[++x]=p,u[++f]=1,g[++m]=h.x,g[++m]=h.y,g[++m]=c.x,g[++m]=c.y,r[++o]=l.colorIndex,s[++a]=d.colorIndex,i[++n]=t/y,i[++n]=y,i[++n]=e.depth,b[++x]=p,u[++f]=-1,g[++m]=h.x,g[++m]=h.y,g[++m]=c.x,g[++m]=c.y,r[++o]=l.colorIndex,s[++a]=d.colorIndex,i[++n]=t/y,i[++n]=y,i[++n]=e.depth,b[++x]=p,o+=1,a+=1,u[++f]=-1,g[++m]=h.x,g[++m]=h.y,g[++m]=c.x,g[++m]=c.y})))return"break"}(v))break}var w=o.BufferUtil.endUpdates();return g?this.bufferItems.geometry.setDrawRange(0,6*w):0===t.length&&this.bufferItems.geometry.setDrawRange(0,0),g},e}(s.BaseBuffer);e.SharedControlCurvedLineBuffer=a},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),o=i(4),s=i(3),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(t,e){this.bufferItems=o.BufferUtil.makeBufferItems(),this.bufferItems.attributes=[{defaults:[0,0,0],name:"position",size:o.AttributeSize.THREE},{defaults:[0,0,0,1],name:"customColor",size:o.AttributeSize.FOUR},{defaults:[1],name:"normalDirection",size:o.AttributeSize.ONE},{defaults:[0,0,0,0],name:"endPoints",size:o.AttributeSize.FOUR},{defaults:[0,0],name:"controlPoint",size:o.AttributeSize.TWO},{defaults:[0],name:"halfLinewidth",size:o.AttributeSize.ONE}];var i=e;this.bufferItems.geometry=o.BufferUtil.makeBuffer(6*i,this.bufferItems.attributes),this.bufferItems.system=new r.Mesh(this.bufferItems.geometry,t),this.bufferItems.system.frustumCulled=!1,this.bufferItems.system.drawMode=r.TriangleStripDrawMode},e.prototype.update=function(t){if(!t)return!1;var e,i,n,r,s=1,a=15,u=!1;o.BufferUtil.beginUpdates();for(var h=this,c=0,l=t;c<l.length;c++){var d=l[c];if("break"===function(c){if(r=c.startColor.base.opacity,n=c.startColor.base.color,s=c.lineWidth/2,a=c.resolution,e=c.p1,i=c.p2,!(u=o.BufferUtil.updateBuffer(t,h.bufferItems,6,a,function(t,o,u,h,l,d,f,p,y,g,m,b,x){o[u]=(t+1)/a,o[++u]=a,o[++u]=c.depth,b[x]=s,l+=4,d[f]=1,p[y]=e.x,p[++y]=e.y,p[++y]=i.x,p[++y]=i.y,g[m]=c.controlPoints[0].x,g[++m]=c.controlPoints[0].y,o[++u]=(t+1)/a,o[++u]=a,o[++u]=c.depth,b[++x]=s,d[++f]=1,p[++y]=e.x,p[++y]=e.y,p[++y]=i.x,p[++y]=i.y,g[++m]=c.controlPoints[0].x,g[++m]=c.controlPoints[0].y,h[l]=n.r,h[++l]=n.g,h[++l]=n.b,h[++l]=r,o[++u]=(t+1)/a,o[++u]=a,o[++u]=c.depth,b[++x]=s,d[++f]=-1,p[++y]=e.x,p[++y]=e.y,p[++y]=i.x,p[++y]=i.y,g[++m]=c.controlPoints[0].x,g[++m]=c.controlPoints[0].y,h[++l]=n.r,h[++l]=n.g,h[++l]=n.b,h[++l]=r,o[++u]=t/a,o[++u]=a,o[++u]=c.depth,b[++x]=s,d[++f]=1,p[++y]=e.x,p[++y]=e.y,p[++y]=i.x,p[++y]=i.y,g[++m]=c.controlPoints[0].x,g[++m]=c.controlPoints[0].y,h[++l]=n.r,h[++l]=n.g,h[++l]=n.b,h[++l]=r,o[++u]=t/a,o[++u]=a,o[++u]=c.depth,b[++x]=s,d[++f]=-1,p[++y]=e.x,p[++y]=e.y,p[++y]=i.x,p[++y]=i.y,g[++m]=c.controlPoints[0].x,g[++m]=c.controlPoints[0].y,h[++l]=n.r,h[++l]=n.g,h[++l]=n.b,h[++l]=r,o[++u]=t/a,o[++u]=a,o[++u]=c.depth,b[++x]=s,l+=4,d[++f]=-1,p[++y]=e.x,p[++y]=e.y,p[++y]=i.x,p[++y]=i.y,g[++m]=c.controlPoints[0].x,g[++m]=c.controlPoints[0].y})))return"break"}(d))break}var f=o.BufferUtil.endUpdates();return u?this.bufferItems.geometry.setDrawRange(0,6*f):0===t.length&&this.bufferItems.geometry.setDrawRange(0,0),u},e}(s.BaseBuffer);e.SimpleStaticBezierLineBuffer=a},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),o=i(4),s=i(3),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(t,e){this.bufferItems=o.BufferUtil.makeBufferItems(),this.bufferItems.attributes=[{defaults:[0,0,0],name:"position",size:o.AttributeSize.THREE},{defaults:[0,0,0,1],name:"customColor",size:o.AttributeSize.FOUR}];var i=e;this.bufferItems.geometry=o.BufferUtil.makeBuffer(6*i,this.bufferItems.attributes),this.bufferItems.system=new r.Mesh(this.bufferItems.geometry,t),this.bufferItems.system.frustumCulled=!1,this.bufferItems.system.drawMode=r.TriangleStripDrawMode},e.prototype.update=function(t){var e=!1,i=0;o.BufferUtil.beginUpdates();for(var n,r,s,a,u,h,c=this,l=0,d=t;l<d.length;l++){var f=d[l];if("break"===function(l){var d=l.getTriangleStrip();if(u=l.startColor.base.color,h=l.startColor.base.opacity,!(e=o.BufferUtil.updateBuffer(t,c.bufferItems,6,d.length/4,function(t,e,o,c,f){i=4*t,n=d[i],r=d[i+1],s=d[i+2],a=d[i+3],e[o]=n.x,e[++o]=n.y,e[++o]=l.depth,f+=4,e[++o]=n.x,e[++o]=n.y,e[++o]=l.depth,c[f]=u.r,c[++f]=u.g,c[++f]=u.b,c[++f]=h,e[++o]=r.x,e[++o]=r.y,e[++o]=l.depth,c[++f]=u.r,c[++f]=u.g,c[++f]=u.b,c[++f]=h,e[++o]=s.x,e[++o]=s.y,e[++o]=l.depth,c[++f]=u.r,c[++f]=u.g,c[++f]=u.b,c[++f]=h,e[++o]=a.x,e[++o]=a.y,e[++o]=l.depth,c[++f]=u.r,c[++f]=u.g,c[++f]=u.b,c[++f]=h,e[++o]=a.x,e[++o]=a.y,e[++o]=l.depth,f+=4})))return"break"}(f))break}var p=o.BufferUtil.endUpdates();return e?this.bufferItems.geometry.setDrawRange(0,6*p):0===t.length&&this.bufferItems.geometry.setDrawRange(0,0),e},e}(s.BaseBuffer);e.SimpleStaticCircularLineBuffer=a},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),o=i(4),s=i(3),a=i(2)("simple-label-buffer"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(t,e){this.bufferItems=o.BufferUtil.makeBufferItems(),this.bufferItems.attributes=[{defaults:[0,0,0],name:"position",size:o.AttributeSize.THREE},{defaults:[0,0,0],name:"customColor",size:o.AttributeSize.THREE},{defaults:[0,0,1],name:"texCoord",size:o.AttributeSize.THREE}];var i=e;this.bufferItems.geometry=o.BufferUtil.makeBuffer(6*i,this.bufferItems.attributes),this.bufferItems.system=new r.Mesh(this.bufferItems.geometry,t),this.bufferItems.system.frustumCulled=!1,this.bufferItems.system.drawMode=r.TriangleStripDrawMode},e.prototype.update=function(t){var e,i;if(!t)return!1;var n=o.BufferUtil.updateBuffer(t,this.bufferItems,6,t.length,function(n,r,o,s,u,h,c){e=t[n],i=e.rasterizedLabel,a("texture is %o",i),e.update(),r[o]=e.TR.x,r[++o]=e.TR.y,r[++o]=e.depth,u+=3,c+=3,r[++o]=e.TR.x,r[++o]=e.TR.y,r[++o]=e.depth,h[c]=i.atlasTR.x,h[++c]=i.atlasTR.y,h[++c]=e.a,s[u]=e.r,s[++u]=e.g,s[++u]=e.b,r[++o]=e.BR.x,r[++o]=e.BR.y,r[++o]=e.depth,h[++c]=i.atlasBR.x,h[++c]=i.atlasBR.y,h[++c]=e.a,s[u]=e.r,s[++u]=e.g,s[++u]=e.b,r[++o]=e.TL.x,r[++o]=e.TL.y,r[++o]=e.depth,h[++c]=i.atlasTL.x,h[++c]=i.atlasTL.y,h[++c]=e.a,s[++u]=e.r,s[++u]=e.g,s[++u]=e.b,r[++o]=e.BL.x,r[++o]=e.BL.y,r[++o]=e.depth,h[++c]=i.atlasBL.x,h[++c]=i.atlasBL.y,h[++c]=e.a,s[++u]=e.r,s[++u]=e.g,s[++u]=e.b,r[++o]=e.BL.x,r[++o]=e.BL.y,r[++o]=e.depth});return this.bufferItems.geometry.setDrawRange(0,6*t.length),n},e}(s.BaseBuffer);e.SimpleStaticLabelBuffer=u},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(33)),n(i(34)),n(i(35)),n(i(36)),n(i(37)),n(i(38)),n(i(17)),n(i(39)),n(i(40)),n(i(10)),n(i(8)),n(i(19))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.base=t}return t}();e.ReferenceColor=n},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(7),o=i(14),s=function(t){function e(e,i,n,r,o,s,a){var u=t.call(this,e,i,n,a)||this;if(u.r=0,u.g=0,u.b=0,u.a=0,u.r2=0,u.g2=0,u.b2=0,u.a2=0,u.alpha=0,u.innerRadius=0,u.ringWidth=0,u.ringPad=0,u.outline=!1,r){var h=r.r,c=r.g,l=r.b,d=r.opacity;u.setOuterColor({r:h,g:c,b:l,opacity:d})}return void 0===s&&(s=0),u.innerRadius=s,o&&u.setInnerColor(o),u}return n(e,t),e.prototype.setOuterColor=function(t){var e=t.r,i=t.g,n=t.b,r=t.opacity;this.r=e,this.g=i,this.b=n,this.a=r},e.prototype.setInnerColor=function(t){this.r2=t.r,this.g2=t.g,this.b2=t.b,this.a2=t.opacity},e.prototype.clone=function(t){return Object.assign(new e(this._centerX,this._centerY,this._radius,r.rgb(this.r,this.g,this.b,this.a),r.rgb(this.r2,this.g2,this.b2,this.a2),this.innerRadius,this.d),this,t)},e.prototype.cloneWithData=function(t){return Object.assign(new e(this._centerX,this._centerY,this._radius,r.rgb(this.r,this.g,this.b,this.a),r.rgb(this.r2,this.g2,this.b2,this.a2),this.innerRadius),this,t)},e}(o.Circle);e.CircleShape=s},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(15),o=i(5),s=i(9),a=function(t){function e(e){var i=t.call(this,e)||this;return i.depth=0,i.lineWidth=1,i.encapsulatePoints(i.getTriangleStrip()),i.cachesQuadSegments=e.cacheSegments,i.depth=e.depth||0,i.lineWidth=e.lineWidth||1,i.startColor=e.startColor,i.endColor=e.endColor,i}return n(e,t),e.prototype.clone=function(){var t=new e({cacheSegments:this.cachesSegments,controlPoints:this.controlPoints,end:this.p2,endColor:this.endColor,lineWidth:this.lineWidth,resolution:this.resolution,start:this.p1,startColor:this.startColor,type:this.type});return t.d=this.d,t},e.prototype.distanceTo=function(e){return Math.max(0,t.prototype.distanceTo.call(this,e)-this.lineWidth/2)},e.prototype.getTriangleStrip=function(){if(this.cachesSegments&&this.cachedQuadSegments)return this.cachedQuadSegments;var t=[],e=[],i=this.getLineStrip(),n=this.lineWidth/2,r=new o.Line(s.Point.zero(),s.Point.zero()),a=s.Point.zero();if(i.length<2)return[];for(var u=0;u<i.length-1;u++){if(r.setPoints(i[u],i[u+1]),0===e.length)e.push(r.perpendicular);else{var h={x:e[u].x+r.perpendicular.x,y:e[u].y+r.perpendicular.y},c=Math.sqrt(h.x*h.x+h.y*h.y);h.x=h.x/c,h.y=h.y/c,e[u]=h}e.push(r.perpendicular)}for(var u=0;u<i.length-1;u++){var l=i[u],d=i[u+1];t.push(s.Point.add(s.Point.scale(e[u+1],-n,a),d)),t.push(s.Point.add(s.Point.scale(e[u+1],n,a),d)),t.push(s.Point.add(s.Point.scale(e[u],-n,a),l)),t.push(s.Point.add(s.Point.scale(e[u],n,a),l))}return t},e.prototype.setPoints=function(e,i,n){t.prototype.setPoints.call(this,e,i,n),this.cachedQuadSegments=[]},e}(r.CurvedLine);e.CurvedLineShape=a},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(7),o=i(5),s=i(17),a=function(t){function e(e,i,n,r,o,s,a){var u=t.call(this,e,i,n,r.r,r.g,r.b,r.opacity,o.r,o.g,o.b,o.opacity,s)||this;return u.tl={x:0,y:0},u.bl={x:0,y:0},u.tr={x:0,y:0},u.br={x:0,y:0},u.endWidth=1,u.endWidth=a,u.setPoints(e,i),u}return n(e,t),e.prototype.clone=function(t){return Object.assign(new e(this.p1,this.p2,this.d,r.rgb(this.r,this.g,this.b,this.a),r.rgb(this.r2,this.g2,this.b2,this.a2),this.thickness,this.endWidth),this,t)},e.prototype.pointInside=function(t){for(var e=t.x,i=t.y,n=[this.tl,this.tr,this.br,this.bl],r=n.length,o=!1,s=0,a=r-1;s<r;a=s++)n[s].y>i!=n[a].y>i&&e<(n[a].x-n[s].x)*(i-n[s].y)/(n[a].y-n[s].y)+n[s].x&&(o=!o);return o},e.prototype.setPoints=function(e,i){if(t.prototype.setPoints.call(this,e,i),this.tl){var n=this.thickness/2,r=this.endWidth/2,s=this.perpendicular.x*n,a=this.perpendicular.y*n,u=this.perpendicular.x*r,h=this.perpendicular.y*r;this.tl.x=this.p1.x+s,this.tl.y=this.p1.y+a,this.bl.x=this.p1.x-s,this.bl.y=this.p1.y-a,this.tr.x=this.p2.x+u,this.tr.y=this.p2.y+h,this.br.x=this.p2.x-u,this.br.y=this.p2.y-h,this.topEdge=new o.Line(this.tl,this.tr),this.bottomEdge=new o.Line(this.bl,this.br),this.encapsulatePoints([this.tl,this.tr,this.bl,this.br])}},e}(s.LineShape);e.EdgeShape=a},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),o=function(t){function e(e,i){var n=t.call(this,0,0,i,i)||this;return n.opacity=1,n.texture=e,n.size=i,n}return n(e,t),Object.defineProperty(e.prototype,"size",{get:function(){return Math.max(this.width,this.height)},set:function(t){this.texture.aspectRatio>1?(this.width=t,this.height=t/this.texture.aspectRatio):(this.width=t*this.texture.aspectRatio,this.height=t)},enumerable:!0,configurable:!0}),e.prototype.centerOn=function(t,e){this.x=t-this.width/2,this.y=e-this.height/2},e}(r.Bounds);e.ImageShape=o},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(6),o=i(18),s=i(19),a=new s.Sprite(200,200,1,1),u=function(t){function e(e){void 0===e&&(e={});var i=t.call(this,{x:0,y:1},{width:1,height:1},0,o.AnchorPosition.TopLeft)||this;i.depth=0,i.direction="inherit",i.font="serif",i.fontSize=10,i.fontWeight=400,i.maxWidth=void 0,i.text="",i.textAlign="start",i.textBaseline="alphabetic",i.zoomable=!1,i.rasterizationOffset={x:0,y:12},i.rasterizationPadding={width:0,height:0},i.r=1,i.g=1,i.b=1,i.a=1,Object.assign(i,e),a.context.font=i.makeCSSFont();var n=a.context.measureText(i.text);return i.setSize({height:i.fontSize+10,width:n.width}),i}return n(e,t),Object.defineProperty(e.prototype,"baseLabel",{get:function(){return this._baseLabel},set:function(t){this._baseLabel=t,this.text=t.text,this.fontSize=t.fontSize,this.font=t.font,this.textAlign=t.textAlign,this.textBaseline=t.textBaseline},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rasterizedLabel",{get:function(){return this.baseLabel?this.baseLabel.rasterizedLabel:this._rasterizedLabel},set:function(t){this._rasterizedLabel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{set:function(t){this.r=t.r,this.g=t.g,this.b=t.b},enumerable:!0,configurable:!0}),e.prototype.copyLabel=function(t){Object.assign(this,r.omit(["x","y","width","height"],t)),this.setText(t.text)},e.prototype.makeCSSFont=function(t){return this.fontWeight+" "+(t||this.fontSize)+"px "+this.font},e.prototype.position=function(t,e){this.x=t,this.y=e},e.prototype.setText=function(t){a.context.font=this.makeCSSFont();var e=a.context.measureText(t);this.height=this.fontSize,this.text=t,this.width=e.width},e}(o.RotateableQuad);e.Label=u},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),o=function(t){function e(e,i){var n=t.call(this,e.x,e.right,e.y,e.bottom)||this;return n.r=1,n.g=0,n.b=0,n.a=1,n}return n(e,t),e}(r.Bounds);e.QuadShape=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=function(){function t(t,e,i,r){void 0===r&&(r=1),this.opacity=1,this.pixelWidth=2,this.pixelHeight=2,t instanceof n.Color?(this.color=t.clone(),this.opacity=void 0===e?1:e):(this.color=new n.Color(t,e,i),this.opacity=r)}return t}();e.AtlasColor=r},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(42)),n(i(14)),n(i(15)),n(i(5)),n(i(9)),n(i(18))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n){this.height=0,this.width=0,this.x=0,this.y=0,4===arguments.length&&(this.x=t,this.width=e-t,this.y=i,this.height=i-n)}return Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y-this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mid",{get:function(){return{x:this.x+this.width/2,y:this.y-this.height/2}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),t.prototype.containsPoint=function(t){return!(t.x<this.x)&&(!(t.y>this.y)&&(!(t.x>this.right)&&!(t.y<this.bottom)))},t.prototype.copyBounds=function(t){this.height=t.height,this.width=t.width,this.x=t.x,this.y=t.y},t.prototype.encapsulate=function(t){t.x<this.x&&(this.width+=this.x-t.x,this.x=t.x),t.y>this.y&&(this.height+=t.y-this.y,this.y=t.y),t.right>this.right&&(this.width=t.right-this.x),t.bottom<this.bottom&&(this.height=this.y-t.bottom)},t.prototype.encapsulateBounds=function(e,i){if(i&&e.length&&this.copyBounds(e[0]),0!==e.length){var n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=Number.MAX_VALUE,s=-Number.MAX_VALUE;e.forEach(function(t){t.x<n?n=t.x:t.right>r&&(r=t.right),t.bottom<o?o=t.bottom:t.y>s&&(s=t.y)}),this.encapsulate(new t(n,r,s,o))}},t.prototype.encapsulatePoint=function(t){t.x<this.x&&(this.width+=this.x-t.x,this.x=t.x),t.y>this.y&&(this.height+=t.y-this.y,this.y=t.y),t.x>this.right&&(this.width=t.x-this.x),t.y<this.bottom&&(this.height=this.y-t.y)},t.prototype.encapsulatePoints=function(e){var i=Number.MAX_VALUE,n=-Number.MAX_VALUE,r=Number.MAX_VALUE,o=-Number.MAX_VALUE;void 0!==e[0]&&e[0].x?e.forEach(function(t){t.x<i?i=t.x:t.x>n&&(n=t.x),t.y<r?r=t.y:t.y>o&&(o=t.y)}):e.forEach(function(t){t[0]<i?i=t[0]:t[0]>n&&(n=t[0]),t[1]<r?r=t[1]:t[1]>o&&(o=t[1])}),this.encapsulate(new t(i,n,o,r))},t.prototype.fits=function(t){return this.width===t.width&&this.height===t.height?1:this.width>=t.width&&this.height>=t.height?2:0},t.prototype.hitBounds=function(t){return!(t.right<this.x)&&(!(t.x>this.right)&&(!(t.bottom>this.y)&&!(t.y<this.bottom)))},t.prototype.pointInside=function(t){return!(t.x<this.x)&&(!(t.y>this.y)&&(!(t.x>this.right)&&!(t.y<this.bottom)))},t.isBounds=function(t){return!!t&&(t instanceof this||t&&"containsPoint"in t&&"encapsulate"in t&&"hitTest"in t)},t.prototype.isInside=function(t){return t.x<=this.x&&t.right>=this.right&&t.y>=this.y&&t.bottom<=this.bottom},t.maxBounds=function(){return new t(Number.MIN_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MAX_VALUE)},t}();e.Bounds=n},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(4)),n(i(44)),n(i(45)),n(i(11)),n(i(13)),n(i(46)),n(i(16)),n(i(12))},function(t,e,i){"use strict";function n(t){return Array.from(t).filter(function(t){return t[1]}).map(function(t){return t[0]})}Object.defineProperty(e,"__esModule",{value:!0}),e.boolMapToArray=n;var r=function(){function t(){this.cachedSelection=new Map,this.selections=new Map,this._didSelectionChange=new Map}return t.prototype.clearAllSelections=function(){for(var t=0,e=Array.from(this.selections.keys());t<e.length;t++){var i=e[t];this.clearSelection(i)}},t.prototype.clearSelection=function(t){this.getSelection(t).length&&(this.selections.set(t,null),this.cachedSelection.set(t,null),this._didSelectionChange.set(t,!0))},t.prototype.deselect=function(t,e){var i=this.selections.get(t);i&&i.get(e)&&(this.cachedSelection.set(t,null),i.set(e,!1),this._didSelectionChange.set(t,!0))},t.prototype.didSelectionCategoryChange=function(t){return this._didSelectionChange.get(t)},t.prototype.didSelectionChange=function(){return n(this._didSelectionChange).length>0},t.prototype.finalizeUpdate=function(){for(var t=0,e=Array.from(this._didSelectionChange.keys());t<e.length;t++){var i=e[t];this._didSelectionChange.set(i,!1)}},t.prototype.getSelection=function(t){if(!this.cachedSelection.get(t)){var e=this.selections.get(t);e?this.cachedSelection.set(t,n(e)):this.cachedSelection.set(t,[])}return this.cachedSelection.get(t)},t.prototype.select=function(t,e){var i=this.selections.get(t);i||(i=new Map,this.selections.set(t,i)),i.get(e)||(this.cachedSelection.set(t,null),i.set(e,!0),this._didSelectionChange.set(t,!0))},t.prototype.toggleSelect=function(t,e){var i=this.selections.get(t);i||(i=new Map,this.selections.set(t,i)),this.cachedSelection.set(t,null),i.get(e)?this.deselect(t,e):this.select(t,e),this._didSelectionChange.set(t,!0)},t}();e.CustomSelection=r},function(t,e,i){"use strict";function n(t){var e=t.ctx,i=t.text,n=t.bboxHeight,r=t.ctx.canvas.height,o=t.baseline||"alphabetic",s=t.flip||!1,a=t.drawBaseline||!1,u="Arial, san-serif",h=14;t.fontFamily&&(u=t.fontFamily),t.fontSize&&(h=t.fontSize),e.save(),e.font=h+"px "+u;var c=e.measureText(i).width,l=2*h,d=2*h,f=e.canvas.width=Math.round(c+2*l),p=e.canvas.height=r||Math.round(2*d);"string"==typeof o&&(d=0,e.textBaseline=o),s&&e.scale(1,-1),e.font=h+"px "+u,e.fillText(i,l,"number"==typeof n?n:d),a&&e.fillRect(0,r/2,e.canvas.width,1);for(var y=e.getImageData(0,0,f,p),g=y.data,m=g.length,b=0,x=0,v=0,w=0;m>0;){g[m+3]&&(m-=m%(4*f),g[m+3]&&(m-=m%(4*f),b=m/4/f,b-=d-h,m=0),m-=4),v=0;for(var _=0,M=0;M<p&&_<f;){g[M*f*4+4*_+3]&&(v=_-l,M=p,_=f),M++,M%p==0&&(M=0,_++)}for(w=0,_=f,M=0;M<p&&_>0;)g[M*f*4+4*_+3]&&(w=_-l,M=p,_=f),++M%p==0&&(M=0,_--);for(x=0,m=g.length;m>0;)g[m+3]&&(m-=m%(4*f),x=m/4/f,m=0),m-=4;e.restore()}return{bottom:x,height:b-0,left:-v,top:h-0,width:w-v}}Object.defineProperty(e,"__esModule",{value:!0}),e.getFontMetrics=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.buffer=[],this.bustCache=!0}return t.prototype.generate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.bustCache&&(this.buildCache.apply(this,t),this.bustCache=!1)},t.prototype.buildCache=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.getBuffer=function(){return this.buffer},t}();e.ShapeBufferCache=n}])});