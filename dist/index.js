!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("three"),require("d3-color"),require("ramda"),require("react"),require("bowser")):"function"==typeof define&&define.amd?define(["three","d3-color","ramda","react","bowser"],e):"object"==typeof exports?exports.voidgl=e(require("three"),require("d3-color"),require("ramda"),require("react"),require("bowser")):t.voidgl=e(t.three,t["d3-color"],t.ramda,t.react,t.bowser)}(this,function(t,e,n,r,i){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=26)}([function(e,n){e.exports=t},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r){this.height=0,this.width=0,this.x=0,this.y=0,4===arguments.length&&(this.x=t,this.width=e-t,this.y=n,this.height=n-r)}return Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y-this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mid",{get:function(){return{x:this.x+this.width/2,y:this.y-this.height/2}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),t.prototype.containsPoint=function(t){return!(t.x<this.x)&&(!(t.y>this.y)&&(!(t.x>this.right)&&!(t.y<this.bottom)))},t.prototype.copyBounds=function(t){this.height=t.height,this.width=t.width,this.x=t.x,this.y=t.y},t.prototype.encapsulate=function(t){t.x<this.x&&(this.width+=this.x-t.x,this.x=t.x),t.y>this.y&&(this.height+=t.y-this.y,this.y=t.y),t.right>this.right&&(this.width=t.right-this.x),t.bottom<this.bottom&&(this.height=this.y-t.bottom)},t.prototype.encapsulateBounds=function(e,n){if(n&&e.length&&this.copyBounds(e[0]),0!==e.length){var r=Number.MAX_VALUE,i=-Number.MAX_VALUE,o=Number.MAX_VALUE,s=-Number.MAX_VALUE;e.forEach(function(t){t.x<r&&(r=t.x),t.right>i&&(i=t.right),t.bottom<o&&(o=t.bottom),t.y>s&&(s=t.y)}),this.encapsulate(new t(r,i,s,o))}},t.prototype.encapsulatePoint=function(t){t.x<this.x&&(this.width+=this.x-t.x,this.x=t.x),t.y>this.y&&(this.height+=t.y-this.y,this.y=t.y),t.x>this.right&&(this.width=t.x-this.x),t.y<this.bottom&&(this.height=this.y-t.y)},t.prototype.encapsulatePoints=function(e){var n=Number.MAX_VALUE,r=-Number.MAX_VALUE,i=Number.MAX_VALUE,o=-Number.MAX_VALUE;void 0!==e[0]&&e[0].x?e.forEach(function(t){t.x<n?n=t.x:t.x>r&&(r=t.x),t.y<i?i=t.y:t.y>o&&(o=t.y)}):e.forEach(function(t){t[0]<n?n=t[0]:t[0]>r&&(r=t[0]),t[1]<i?i=t[1]:t[1]>o&&(o=t[1])}),this.encapsulate(new t(n,r,o,i))},t.prototype.fits=function(t){return this.width===t.width&&this.height===t.height?1:this.width>=t.width&&this.height>=t.height?2:0},t.prototype.hitBounds=function(t){return!(t.right<this.x)&&(!(t.x>this.right)&&(!(t.bottom>this.y)&&!(t.y<this.bottom)))},t.prototype.pointInside=function(t){return!(t.x<this.x)&&(!(t.y>this.y)&&(!(t.x>this.right)&&!(t.y<this.bottom)))},t.isBounds=function(t){return!!t&&(t instanceof this||t&&"containsPoint"in t&&"encapsulate"in t&&"hitTest"in t)},t.prototype.isInside=function(t){return t.x<=this.x&&t.right>=this.right&&t.y>=this.y&&t.bottom<=this.bottom},t.maxBounds=function(){return new t(Number.MIN_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MAX_VALUE)},t}();e.Bounds=r},function(t,e,n){(function(r){function i(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),n){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))}),t.splice(o,0,r)}}function s(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}}function u(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}e=t.exports=n(30),e.log=s,e.formatArgs=o,e.save=a,e.load=u,e.useColors=i,e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(u())}).call(e,n(29))},function(t,e,n){"use strict";function r(t,e){O=t[0],B=t[1],T=t[2],A=t[3],z=t[4],L=t[5],R=t[6],E=t[7],D=t[8],j=t[9],U=t[10],Q=e[0],$=e[1],J=e[2],K=e[3],tt=e[4],et=e[5],nt=e[6],rt=e[7],it=e[8],ot=e[9],st=e[10]}function i(t,e){for(var n=at;n<t;++n)N=n*Q,e(n-at,O,N)}function o(t,e){for(var n=at;n<t;++n)N=n*Q,W=n*$,e(n-at,O,N,B,W)}function s(t,e){for(var n=at;n<t;++n)N=n*Q,W=n*$,X=n*J,e(n-at,O,N,B,W,T,X)}function a(t,e){for(var n=at;n<t;++n)N=n*Q,W=n*$,X=n*J,k=n*K,e(n-at,O,N,B,W,T,X,A,k)}function u(t,e){for(var n=at;n<t;++n)N=n*Q,W=n*$,X=n*J,k=n*K,Y=n*tt,e(n-at,O,N,B,W,T,X,A,k,z,Y)}function h(t,e){for(var n=at;n<t;++n)N=n*Q,W=n*$,X=n*J,k=n*K,Y=n*tt,F=n*et,e(n-at,O,N,B,W,T,X,A,k,z,Y,L,F)}function c(t,e){for(var n=at;n<t;++n)N=n*Q,W=n*$,X=n*J,k=n*K,Y=n*tt,F=n*et,q=n*nt,e(n-at,O,N,B,W,T,X,A,k,z,Y,L,F,R,q)}function l(t,e){for(var n=at;n<t;++n)N=n*Q,W=n*$,X=n*J,k=n*K,Y=n*tt,F=n*et,q=n*nt,H=n*rt,e(n-at,O,N,B,W,T,X,A,k,z,Y,L,F,R,q,E,H)}function f(t,e){for(var n=at;n<t;++n)N=n*Q,W=n*$,X=n*J,k=n*K,Y=n*tt,F=n*et,q=n*nt,H=n*rt,V=n*it,e(n-at,O,N,B,W,T,X,A,k,z,Y,L,F,R,q,E,H,D,V)}function d(t,e){for(var n=at;n<t;++n)N=n*Q,W=n*$,X=n*J,k=n*K,Y=n*tt,F=n*et,q=n*nt,H=n*rt,V=n*it,Z=n*ot,e(n-at,O,N,B,W,T,X,A,k,z,Y,L,F,R,q,E,H,D,V,j,Z)}function p(t,e){for(var n=at;n<t;++n)N=n*Q,W=n*$,X=n*J,k=n*K,Y=n*tt,F=n*et,q=n*nt,H=n*rt,V=n*it,Z=n*ot,G=n*st,e(n-at,O,N,B,W,T,X,A,k,z,Y,L,F,R,q,E,H,D,V,j,Z,U,G)}function y(t){C=t[0]||0,P=t[1]||0,I=t[2]||0,S=t[3]||0}function g(t,e){t[e]=C}function m(t,e){t[e]=C,t[++e]=P}function b(t,e){t[e]=C,t[++e]=P,t[++e]=I}function v(t,e){t[e]=C,t[++e]=P,t[++e]=I,t[++e]=S}Object.defineProperty(e,"__esModule",{value:!0});var x=n(0),w=n(2),_=n(2)("WebGLSurface:BufferUtil");!function(t){t[t.CW=0]="CW",t[t.CCW=1]="CCW",t[t.DEGENERATE=2]="DEGENERATE"}(e.TriangleOrientation||(e.TriangleOrientation={}));var M;!function(t){t[t.ONE=0]="ONE",t[t.TWO=1]="TWO",t[t.THREE=2]="THREE",t[t.FOUR=3]="FOUR"}(M=e.AttributeSize||(e.AttributeSize={}));var C=0,P=0,I=0,S=0,O=[],B=[],T=[],A=[],z=[],L=[],R=[],E=[],D=[],j=[],U=[],N=0,W=0,X=0,k=0,Y=0,F=0,q=0,H=0,V=0,Z=0,G=0,Q=0,$=0,J=0,K=0,tt=0,et=0,nt=0,rt=0,it=0,ot=0,st=0,at=0,ut=!1,ht=(ft={},ft[M.ONE]=g,ft[M.TWO]=m,ft[M.THREE]=b,ft[M.FOUR]=v,ft),ct={1:i,2:o,3:s,4:a,5:u,6:h,7:c,8:l,9:f,10:d,11:p},lt=function(){function t(){}return t.beginUpdates=function(){ut=!0,at=0},t.dispose=function(t){t&&t.forEach(function(t){t.attributes=null,t.currentData=null,t.geometry.dispose(),t.geometry=null,t.system=null})},t.endUpdates=function(){var t=at;return ut=!1,at=0,t},t.examineBuffer=function(t,e,n){var r=w(n);if(r.enabled){var i=t.attributes,o=t.geometry,s=i.map(function(t){return o.attributes[t.name]}),a=s.map(function(t){return t.array}),u=[];if(t.system.drawMode===x.TrianglesDrawMode)for(var h=0,c=0,l=0,f=o.drawRange.start+o.drawRange.count;h<f;)!function(){for(var t={vertex_0:{},vertex_1:{},vertex_2:{}},e=0;e<3;++e)!function(e){i.forEach(function(n,r){c=n.size+1,l=h*c,t["vertex_"+e][n.name]=a[r].slice(l,l+c)}),h++}(e);u.push(t)}();else if(t.system.drawMode===x.TriangleStripDrawMode)for(var d=0,p=0,y=0,g=o.drawRange.start+o.drawRange.count;d<g;)!function(){for(var t={vertex_0:{},vertex_1:{},vertex_2:{}},e=0;e<3;++e)!function(e){i.forEach(function(n,r){p=n.size+1,y=d*p,t["vertex_"+e][n.name]=a[r].slice(y,y+p)}),d++}(e);d-=2,u.push(t)}();r(e,{drawRange:o.drawRange,triangles:u},t.system.material.uniforms)}},t.flattenMultiBuffers=function(t){var e=[];return t.forEach(function(t){t.getBuffers().forEach(function(t){return e=e.concat(t)})}),e},t.updateMultiBuffer=function(t,e,n,r,i){var o=!1,s=t.getBuffers(),a=new Map;e.forEach(function(t){return a.set(t.bufferItems.currentData,t)});var u=[];if(i?u=[].concat(s):s.forEach(function(t){a.get(t)?a.delete(t):u.push(t)}),u.length>=a.size)a.forEach(function(t){o=r(t,u.shift())||o}),u.forEach(function(t){var i=n();e.push(i),o=r(i,t)||o});else{var h=Array.from(a.values());u.forEach(function(t){var e=h.shift();o=r(e,t)||o}),h.forEach(function(t){t.bufferItems.geometry.setDrawRange(0,0)})}return o},t.makeBuffer=function(t,e){for(var n=e.length,r=new x.BufferGeometry,i=0,o=0;o<n;++o){var s=e[o],a=s.size+1;i+=a;var u=new Float32Array(a*t),h=ht[s.size],c=s.name;y(s.defaults);for(var l=0;l<t;++l)h(u,l*a);r.addAttribute(c,new x.BufferAttribute(u,a)),_("Made Buffer Attribute:",c,a)}return i>16&&console.warn("A Buffer has specified more attributes than available. The max is 16 and the buffer provided:",i),r},t.updateBuffer=function(t,e,n,i,o,s){var a=e.attributes,u=e.geometry,h=0!==at&&ut;if(void 0!==t&&t!==e.currentData||h||s){ut||(at=0),e.currentData=t;var c=a.map(function(t){return u.attributes[t.name]});r(c.map(function(t){return t.array}),a.map(function(t){return(t.size+1)*n}));return(0,ct[a.length])(i+at,o),c.forEach(function(t){t.updateRange&&(t.updateRange.offset=0,t.updateRange.count=n*i),t.needsUpdate=!0}),at+=i,!0}return at+=i,!1},t.makeBufferItems=function(){return{attributes:[],currentData:[],geometry:null,system:null}},t}();e.BufferUtil=lt;var ft},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=function(){function t(){}return t.prototype.dispose=function(){this.bufferItems&&r.BufferUtil.dispose([this.bufferItems])},t.prototype.init=function(t,e){},t.prototype.update=function(t){return!1},t}();e.BaseBuffer=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=function(t){function e(e,n){var r=t.call(this,0,1,1,0)||this;return r.setPoints(e,n),r}return r(e,t),e.prototype.directionTo=function(t){var e={x:this.p1.x-t.x,y:this.p1.y-t.y};return this.perpendicular.x*e.x+this.perpendicular.y*e.y},e.prototype.distanceTo=function(t){var e={x:this.p1.x-t.x,y:this.p1.y-t.y};return Math.abs(this.perpendicular.x*e.x+this.perpendicular.y*e.y)},e.getClosest=function(t,e){var n,r=Number.MAX_VALUE,i=0;return t.forEach(function(t){(i=t.distanceTo(e))<r&&(n=t,r=i)}),n},e.prototype.setPoints=function(t,e){this.x=t.x-1,this.y=t.y-1,this.width=2,this.height=2,this.encapsulatePoint(e);var n=e.x-t.x,r=e.y-t.y;this.slope=r/n,this.p1=t,this.p2=e,this.magnitude=Math.sqrt(n*n+r*r),this.perpendicular={x:this.p2.y-this.p1.y,y:-(this.p2.x-this.p1.x)};var i=Math.sqrt(this.perpendicular.x*this.perpendicular.x+this.perpendicular.y*this.perpendicular.y);this.perpendicular.x/=i,this.perpendicular.y/=i},e}(i.Bounds);e.Line=o},function(t,e,n){"use strict";function r(t,e){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.add=function(t,e,n){return n?(n.x=t.x+e.x,n.y=t.y+e.y,n):{x:t.x+e.x,y:t.y+e.y}},t.getClosest=function(t,e){var n,i=Number.MAX_VALUE,o=null,s=function(e){(n=r(e,t))<i&&(i=n,o=e)};return e.forEach(s),o},t.getClosestIndex=function(t,e){var n,i=Number.MAX_VALUE,o=0,s=function(e,s){(n=r(e,t))<i&&(i=n,o=s)};return e.forEach(s),o},t.getDirection=function(t,e,n){void 0===n&&(n=!1);var r=e.x-t.x,i=e.y-t.y;if(n){var o=Math.sqrt(r*r+i*i);r/=o,i/=o}return{x:r,y:i}},t.getDistance=function(t,e,n){return void 0===n&&(n=!1),n?r(t,e):Math.sqrt(r(t,e))},t.getMidpoint=function(e,n){var r=t.getDirection(e,n);return{x:r.x/2+e.x,y:r.y/2+e.y}},t.make=function(t,e){return{x:t,y:e}},t.scale=function(t,e,n){return n?(n.x=t.x*e,n.y=t.y*e,n):{x:t.x*e,y:t.y*e}},t.zero=function(){return{x:0,y:0}},t}();e.Point=i},function(t,n){t.exports=e},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.aspectRatio=1,this.imagePath=t,this.label=e,e&&(this.label.rasterizedLabel=this)}return t}();e.AtlasTexture=r},function(t,e,n){"use strict";function r(){var t=i.lastFrameTime/1e7;return Math.floor(1e7*(t-Math.floor(t)))}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.lastFrameTime=Date.now(),t.nextFrameTime=Date.now(),t.framesPlayed=new Map,t}();e.FrameInfo=i,e.getAttributeCurrentTime=r},function(t,e,n){"use strict";function r(t,e,n,r){return n*t/r+e}function i(t,e,n,r){return n*(t/=r)*t+e}function o(t,e,n,r){return-n*(t/=r)*(t-2)+e}function s(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e}function a(t,e,n,r){return n*(t/=r)*t*t+e}function u(t,e,n,r){return n*((t=t/r-1)*t*t+1)+e}function h(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e}function c(t,e,n,r){return n*(t/=r)*t*t*t+e}function l(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e}function f(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e}function d(t,e,n,r){return n*(t/=r)*t*t*t*t+e}function p(t,e,n,r){return n*((t=t/r-1)*t*t*t*t+1)+e}function y(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e}function g(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e}function m(t,e,n,r){return n*Math.sin(t/r*(Math.PI/2))+e}function b(t,e,n,r){return-n/2*(Math.cos(Math.PI*t/r)-1)+e}function v(t,e,n,r){return 0===t?e:n*Math.pow(2,10*(t/r-1))+e}function x(t,e,n,r){return t===r?e+n:n*(1-Math.pow(2,-10*t/r))+e}function w(t,e,n,r){return 0===t?e:t===r?e+n:(t/=r/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e}function _(t,e,n,r){return-n*(Math.sqrt(1-(t/=r)*t)-1)+e}function M(t,e,n,r){return n*Math.sqrt(1-(t=t/r-1)*t)+e}function C(t,e,n,r){return(t/=r/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e}function P(t,e,n,r){var i=1.70158,o=0,s=n;return 0===t?e:1==(t/=r)?e+n:(o||(o=.3*r),s<Math.abs(n)?(s=n,i=o/4):i=o/(2*Math.PI)*Math.asin(n/s),-s*Math.pow(2,10*(t-=1))*Math.sin((t*r-i)*(2*Math.PI)/o)+e)}function I(t,e,n,r){var i=1.70158,o=0,s=n;return 0===t?e:1==(t/=r)?e+n:(o||(o=.3*r),s<Math.abs(n)?(s=n,i=o/4):i=o/(2*Math.PI)*Math.asin(n/s),s*Math.pow(2,-10*t)*Math.sin((t*r-i)*(2*Math.PI)/o)+n+e)}function S(t,e,n,r){var i=1.70158,o=0,s=n;return 0===t?e:2==(t/=r/2)?e+n:(o||(o=r*(.3*1.5)),s<Math.abs(n)?(s=n,i=o/4):i=o/(2*Math.PI)*Math.asin(n/s),t<1?s*Math.pow(2,10*(t-=1))*Math.sin((t*r-i)*(2*Math.PI)/o)*-.5+e:s*Math.pow(2,-10*(t-=1))*Math.sin((t*r-i)*(2*Math.PI)/o)*.5+n+e)}function O(t,e,n,r,i){return void 0===i&&(i=1.70158),n*(t/=r)*t*((i+1)*t-i)+e}function B(t,e,n,r,i){return void 0===i&&(i=1.70158),n*((t=t/r-1)*t*((i+1)*t+i)+1)+e}function T(t,e,n,r,i){return void 0===i&&(i=1.70158),(t/=r/2)<1?n/2*(t*t*((1+(i*=1.525))*t-i))+e:n/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+e}function A(t,e,n,r){return n-z(r-t,0,n,r)+e}function z(t,e,n,r){return(t/=r)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e}function L(t,e,n,r){return t<r/2?.5*A(2*t,0,n,r)+e:.5*z(2*t-r,0,n,r)+.5*n+e}Object.defineProperty(e,"__esModule",{value:!0}),e.linear=r,e.easeInQuad=i,e.easeOutQuad=o,e.easeInOutQuad=s,e.easeInCubic=a,e.easeOutCubic=u,e.easeInOutCubic=h,e.easeInQuart=c,e.easeOutQuart=l,e.easeInOutQuart=f,e.easeInQuint=d,e.easeOutQuint=p,e.easeInOutQuint=y,e.easeInSine=g,e.easeOutSine=m,e.easeInOutSine=b,e.easeInExpo=v,e.easeOutExpo=x,e.easeInOutExpo=w,e.easeInCirc=_,e.easeOutCirc=M,e.easeInOutCirc=C,e.easeInElastic=P,e.easeOutElastic=I,e.easeInOutElastic=S,e.easeInBack=O,e.easeOutBack=B,e.easeInOutBack=T,e.easeInBounce=A,e.easeOutBounce=z,e.easeInOutBounce=L},function(t,e,n){"use strict";function r(t,e,n,r){var i=t*t,o=1-t,s=o*o;return{x:e.x*s+2*r.x*o*t+n.x*i,y:e.y*s+2*r.y*o*t+n.y*i}}function i(t,e,n,r,i){var o=t*t,s=o*t,a=1-t,u=a*a,h=u*a;return{x:e.x*h+3*r.x*u*t+3*i.x*a*o+n.x*s,y:e.y*h+3*r.y*u*t+3*i.y*a*o+n.y*s}}function o(t,e,n,r,i){var o=a.Point.getDirection(r,e),s=Math.atan2(o.y,o.x),h=a.Point.getDirection(r,n),c=Math.atan2(h.y,h.x);s<0&&(s+=2*Math.PI),c<0&&(c+=2*Math.PI);var l=c-s;l>Math.PI&&(l=s-c),l*=t;var f=a.Point.getDistance(e,r),d=a.Point.getDistance(n,r),p=(i||u.linear)(t,f,d-f,1);return{x:Math.cos(s+l)*p+r.x,y:Math.sin(s+l)*p+r.y}}Object.defineProperty(e,"__esModule",{value:!0});var s,a=n(6),u=n(10);!function(t){t[t.BEZIER2=0]="BEZIER2",t[t.BEZIER3=1]="BEZIER3",t[t.CIRCULAR=2]="CIRCULAR"}(s=e.InterpolationMethod||(e.InterpolationMethod={})),e.bezier2=r,e.bezier3=i,e.circular=o,e.pickInterpolation=(h={},h[s.BEZIER2]=r,h[s.BEZIER3]=i,h[s.CIRCULAR]=o,h);var h},function(t,e){t.exports=n},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),s=n(0),a=n(1),u=n(14),h=n(15),c=n(8),l=n(2)("webgl-surface:Atlas"),f=n(2)("webgl-surface:Labels"),d={atlasBL:{x:0,y:0},atlasBR:{x:0,y:0},atlasTL:{x:0,y:0},atlasTR:{x:0,y:0},label:new h.Label({text:" "}),pixelHeight:0,pixelWidth:0},p=function(){function t(t,e){this.atlasImages={},this.atlasMap={},this.atlasTexture={},this.textureWidth=t,this.textureHeight=e}return t.prototype.createAtlas=function(t,e,n){return r(this,void 0,void 0,function(){var r,o,a,h,c,c,f,d;return i(this,function(i){switch(i.label){case 0:if(r=new u.PackNode(0,0,this.textureWidth,this.textureHeight),this.atlasMap[t]=r,this.atlasImages[t]=[],o=document.createElement("canvas").getContext("2d"),o.canvas.width=this.textureWidth,o.canvas.height=this.textureHeight,!e)return[3,4];a=0,h=e,i.label=1;case 1:return a<h.length?(c=h[a],[4,this.draw(c,t,o)]):[3,4];case 2:i.sent(),i.label=3;case 3:return a++,[3,1];case 4:return n?[4,this.drawColors(n,t,o)]:[3,6];case 5:c=i.sent(),c&&this.atlasImages[t].push(c),i.label=6;case 6:return f=new s.Texture(o.canvas),f.premultiplyAlpha=!0,f.generateMipmaps=!0,this.atlasTexture[t]=f,e&&(d=this.atlasImages[t]).push.apply(d,e),l("Atlas Created-> texture: %o mapping: %o images: %o",f,r,e),[2,f]}})})},t.prototype.destroyAtlas=function(t){if(this.atlasTexture[t]&&(this.atlasTexture[t].dispose(),this.atlasTexture[t]=null),this.atlasMap[t]&&(this.atlasMap[t].destroy(),this.atlasMap[t]=null),this.atlasImages[t]){var e={x:0,y:0};this.atlasImages[t].forEach(function(t){t.atlasReferenceID=null,t.pixelWidth=0,t.pixelHeight=0,t.atlasBL=e,t.atlasBR=e,t.atlasTL=e,t.atlasTR=e}),this.atlasImages[t]=null}},t.prototype.isValidImage=function(t){var e=!1;return t&&(t.imagePath||t.label&&t.label.text)&&t.pixelWidth&&t.pixelHeight&&(e=!0),e},t.prototype.setDefaultImage=function(t,e){return t=Object.assign(t,d,{atlasReferenceID:e})},t.prototype.draw=function(t,e,n){return r(this,void 0,void 0,function(){var r,o,s,u,h,c,d,p,y,g;return i(this,function(i){switch(i.label){case 0:return this.atlasMap[e]?[4,this.loadImage(t)]:(l("Can not load image, invalid Atlas Name: %o for atlasMaps: %o",e,this.atlasMap),[2,!1]);case 1:return r=i.sent(),t.atlasReferenceID=null,r&&this.isValidImage(t)?(l("Image loaded: %o",t.imagePath),o=new a.Bounds(0,t.pixelWidth,t.pixelHeight,0),s={first:t,second:o},s.second.width+=1,s.second.height+=1,u=this.atlasMap[e],h=u.insert(s),h?(l("Atlas location determined: %o",h),t.label&&f("Atlas location determined. PackNode: %o Dimensions: %o",h,s),h.nodeImage=t,c=h.nodeDimensions.x/this.textureWidth,d=h.nodeDimensions.y/this.textureHeight,p=h.nodeDimensions.width/this.textureWidth,y=h.nodeDimensions.height/this.textureHeight,f("uy is %o",d),g=new a.Bounds(c,c+p,1-d,1-(d+y)),t.atlasReferenceID=e,t.atlasBL={x:g.x,y:g.y-g.height},t.atlasBR={x:g.x+g.width,y:g.y-g.height},t.atlasTL={x:g.x,y:g.y},t.atlasTR={x:g.x+g.width,y:g.y},n.drawImage(r,h.nodeDimensions.x,h.nodeDimensions.y),[2,!0]):(console.error("Could not fit image into atlas "+t.imagePath),t=this.setDefaultImage(t,e),[2,!1])):(console.error("Could not load image "+t.imagePath),t=this.setDefaultImage(t,e),[2,!1])}})})},t.prototype.drawColors=function(t,e,n){return r(this,void 0,void 0,function(){var r,o,s,u,h,f,d,p,y,g,m,b,v,x,w,_,M,C,P,I,S,O,B,T,A,z,L,R,E,D,j,U;return i(this,function(i){if(l("Finding space for colors on the atlas: %o",t),r=2,o=2,s=1024/r,u=Math.min(this.textureWidth,s*r),h=Math.ceil(t.length*r/u),f=Math.ceil(u/r),d=h*o,p={first:new c.AtlasTexture(null,null),second:new a.Bounds(0,u,d,0)},p.second.width+=1,p.second.height+=1,y=this.atlasMap[e],g=y.insert(p)){for(l("Atlas location determined for colors: %o",g),m=g.nodeImage=p.first,b=g.nodeDimensions.x/this.textureWidth,v=g.nodeDimensions.y/this.textureHeight,x=g.nodeDimensions.width/this.textureWidth,w=g.nodeDimensions.height/this.textureHeight,_=new a.Bounds(b,b+x,1-v,1-(v+w)),m.atlasReferenceID=e,m.atlasBL={x:_.x,y:_.y-_.height},m.atlasBR={x:_.x+_.width,y:_.y-_.height},m.atlasTL={x:_.x,y:_.y},m.atlasTR={x:_.x+_.width,y:_.y},M=g.nodeDimensions,C=M.x,P=M.y,I=r/this.textureWidth,S=-o/this.textureHeight,O=C/this.textureWidth+I/2,B=1-P/this.textureHeight+S/2,T=0,A=0,z=0,L=t;z<L.length;z++)R=L[z],R.atlasReferenceID=e,R.colorIndex=T+A*f,R.colorsPerRow=f,R.firstColor={x:O,y:B},R.nextColor={x:I,y:S},E=R.color,D=E.r,j=E.g,U=E.b,n.fillStyle="rgba("+Math.round(255*D)+", "+Math.round(255*j)+", "+Math.round(255*U)+", "+R.opacity+")",n.fillRect(T*r+C,A*o+P,r,o),++T===f&&(T=0,A++);return[2,m]}throw new Error("Could not fit colors into atlas")})})},t.prototype.getAtlasTexture=function(t){return this.atlasTexture[t]},t.prototype.loadImage=function(t){return t.imagePath?new Promise(function(e,n){var r=new Image;r.onload=function(){t.pixelWidth=r.width,t.pixelHeight=r.height,t.aspectRatio=r.width/r.height,e(r)},r.onerror=function(){e(null)},r.src=t.imagePath}):t.label?new Promise(function(e,n){var r=t.label,i=r.getSize(),s=document.createElement("canvas"),a=s.getContext("2d");if(s.width=i.width+t.label.rasterizationPadding.width,s.height=i.height+t.label.rasterizationPadding.height,a){var u=r.fontSize,h=o.rgb(255*r.color.base.color.r,255*r.color.base.color.g,255*r.color.base.color.b,r.color.base.opacity);a.font=r.makeCSSFont(u),a.textAlign=r.textAlign,a.textBaseline=r.textBaseline,a.fillStyle=h.toString(),a.fillText(r.text,t.label.rasterizationOffset.x,t.label.height/2+t.label.rasterizationOffset.y);var c=new Image;c.onload=function(){t.pixelWidth=c.width,t.pixelHeight=c.height,t.aspectRatio=c.width/c.height,f("Applying size based on rasterization to the Label: w: %o h: %o",c.width,c.height),r.setSize({height:c.height,width:c.width}),e(c)},c.onerror=function(){e(null)},c.src=s.toDataURL("image/png")}}):Promise.resolve(null)},t}();e.AtlasManager=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=function(){function t(t,e,n,i){this.child=[null,null],this.isLeaf=!0,this.nodeImage=null,this.nodeDimensions=new r.Bounds(t,t+n,e,e-i)}return t.prototype.destroy=function(){this.nodeImage=null,this.child[0]&&this.child[0].destroy(),this.child[1]&&this.child[1].destroy(),this.child[0]=void 0,this.child[1]=void 0},t.prototype.hasChild=function(){return this.child[0]&&!this.child[0].nodeImage?!this.child[0].isLeaf:!(!this.child[1]||this.child[1].nodeImage)&&!this.child[1].isLeaf},t.prototype.insert=function(e){if(!this.isLeaf){var n=this.child[0].insert(e);return null!==n?n:this.child[1].insert(e)}if(this.nodeImage)return null;var r=this.nodeDimensions.fits(e.second);if(0===r)return null;if(1===r)return this;this.isLeaf=!1;var i=e.second.width,o=e.second.height,s=this.nodeDimensions.width-i,a=this.nodeDimensions.height-e.second.height;return s>a?(this.child[0]=new t(this.nodeDimensions.x,this.nodeDimensions.y,i,this.nodeDimensions.height),this.child[1]=new t(this.nodeDimensions.x+i,this.nodeDimensions.y,s,this.nodeDimensions.height)):(this.child[0]=new t(this.nodeDimensions.x,this.nodeDimensions.y,this.nodeDimensions.width,o),this.child[1]=new t(this.nodeDimensions.x,this.nodeDimensions.y+o,this.nodeDimensions.width,a)),this.child[0].insert(e)},t.prototype.remove=function(t){if(this.isLeaf)return this.nodeImage===t&&(this.nodeImage=null,t.atlasReferenceID=null,t.pixelWidth=0,!0);var e=this.child[0].remove(t);return!!e||(e=this.child[1].remove(t),this.child[0].hasChild()||this.child[1].hasChild()||(this.child[0]=null,this.child[1]=null),e)},t}();e.PackNode=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(12),o=n(16),s=n(17),a=new s.Sprite(200,200,1,1),u=function(t){function e(e){void 0===e&&(e={});var n=t.call(this,{x:0,y:1},{width:1,height:1},0,o.AnchorPosition.TopLeft)||this;return n.depth=0,n.direction="inherit",n.font="serif",n.fontSize=10,n.fontWeight=400,n.maxWidth=void 0,n.text="",n.id="",n.textAlign="start",n.textBaseline="alphabetic",n.zoomable=!1,n.rasterizationOffset={x:0,y:12},n.rasterizationPadding={width:0,height:0},Object.assign(n,e),n.setFontSize(e.fontSize||12),n}return r(e,t),Object.defineProperty(e.prototype,"baseLabel",{get:function(){return this._baseLabel},set:function(t){this._baseLabel=t,this.text=t.text,this.fontSize=t.fontSize,this.font=t.font,this.textAlign=t.textAlign,this.textBaseline=t.textBaseline},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rasterizedLabel",{get:function(){return this.baseLabel?this.baseLabel.rasterizedLabel:this._rasterizedLabel},set:function(t){this._rasterizedLabel=t},enumerable:!0,configurable:!0}),e.prototype.copyLabel=function(t){Object.assign(this,i.omit(["x","y","width","height"],t)),this.setText(t.text)},e.prototype.getText=function(){return this._baseLabel?this._baseLabel.getText():this.text},e.prototype.makeCSSFont=function(t){return this.fontWeight+" "+(t||this.fontSize)+"px "+this.font},e.prototype.position=function(t,e){this.x=t,this.y=e},e.prototype.setFontSize=function(t){var e=this.getText(),n=this.getSize(),r=n.width,i=n.height;if(this.baseLabel){var o=this.baseLabel.getSize(),s=t/this.baseLabel.fontSize;i=o.height*s,r=o.width*s}else{a.context.font=this.makeCSSFont();var u=a.context.measureText(e);i=t,r=u.width}this.fontSize=t,this.setSize({width:r,height:i})},e.prototype.setText=function(t){this.text=t,this.setFontSize(this.fontSize)},e.prototype.update=function(){this.setFontSize(this.fontSize),t.prototype.update.call(this)},e}(o.RotateableQuad);e.Label=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i,o=n(0),s=n(1);!function(t){t[t.BottomLeft=0]="BottomLeft",t[t.BottomRight=1]="BottomRight",t[t.Custom=2]="Custom",t[t.Middle=3]="Middle",t[t.MiddleBottom=4]="MiddleBottom",t[t.MiddleLeft=5]="MiddleLeft",t[t.MiddleRight=6]="MiddleRight",t[t.MiddleTop=7]="MiddleTop",t[t.TopLeft=8]="TopLeft",t[t.TopRight=9]="TopRight"}(i=e.AnchorPosition||(e.AnchorPosition={}));var a=(h={},h[i.BottomLeft]=function(t){return{x:0,y:0}},h[i.BottomRight]=function(t){return{x:t.getSize().width,y:0}},h[i.Custom]=function(t){return{x:0,y:t.getSize().height}},h[i.Middle]=function(t){return{x:t.getSize().width/2,y:t.getSize().height/2}},h[i.MiddleBottom]=function(t){return{x:t.getSize().width/2,y:0}},h[i.MiddleLeft]=function(t){return{x:0,y:t.getSize().height/2}},h[i.MiddleRight]=function(t){return{x:t.getSize().width,y:t.getSize().height/2}},h[i.MiddleTop]=function(t){return{x:t.getSize().width/2,y:t.getSize().height}},h[i.TopLeft]=function(t){return{x:0,y:t.getSize().height}},h[i.TopRight]=function(t){return{x:t.getSize().width,y:t.getSize().height}},h),u=function(t){function e(e,n,r,o){void 0===o&&(o=i.Middle);var s=t.call(this,0,0,0,0)||this;return s.setSize(n),s.setAnchor(o),s.setLocation(e),s.setRotation(r),s.update(),s}return r(e,t),e.prototype.calculateAnchor=function(t){this.anchor=a[t](this)},e.prototype.getSize=function(){return this.size},e.prototype.setAnchor=function(t,e){if(void 0===t&&(t=i.Middle),this.anchorType=t,e)return this.anchorType=i.Custom,void(this.anchor=e);this.calculateAnchor(t)},e.prototype.getAnchor=function(){return this.anchor},e.prototype.getAnchorType=function(){return this.anchorType},e.prototype.setLocation=function(t){this.location=t},e.prototype.getLocation=function(){return this.location},e.prototype.setRotation=function(t){this.rotation=t},e.prototype.getRotation=function(){return this.rotation},e.prototype.getDirection=function(){var t=this.rotation;return{x:Math.cos(t),y:Math.sin(t)}},e.prototype.setSize=function(t){this.size=t,this.base=[new o.Vector4(0,t.height,0,1),new o.Vector4(t.width,t.height,0,1),new o.Vector4(0,0,0,1),new o.Vector4(t.width,0,0,1)],this.anchorType&&this.calculateAnchor(this.anchorType)},e.prototype.update=function(){var t=(new o.Matrix4).makeTranslation(this.anchor.x,-this.anchor.y,0),e=(new o.Matrix4).makeRotationZ(this.rotation),n=(new o.Matrix4).makeTranslation(this.location.x,this.location.y,0);this.transform=(new o.Matrix4).multiply(n).multiply(e).multiply(t),this.TL=this.base[0].clone().applyMatrix4(this.transform),this.TR=this.base[1].clone().applyMatrix4(this.transform),this.BL=this.base[2].clone().applyMatrix4(this.transform),this.BR=this.base[3].clone().applyMatrix4(this.transform),this.x=this.TL.x,this.y=this.TL.y,this.width=1,this.height=1,this.encapsulatePoints([this.TR,this.BL,this.BR])},e}(s.Bounds);e.RotateableQuad=u;var h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r){this.scaleX=1,this.scaleY=1;var i=document.createElement("canvas");i&&(this.scaleX=n||this.scaleX,this.scaleY=r||this.scaleY,i.width=t*this.scaleX,i.height=e*this.scaleY,this.context=i.getContext("2d"),this.canvas=i)}return t.prototype.getContentScale=function(){return{x:this.scaleX,y:this.scaleY}},t.prototype.getContentSize=function(){return{height:this.canvas.height,width:this.canvas.width}},t.prototype.getWidth=function(){return this.canvas.width/this.scaleX},t.prototype.getHeight=function(){return this.canvas.height/this.scaleY},t}();e.Sprite=r},function(t,e,n){"use strict";function r(t){var e=t.nativeEvent,n=0,r=0;return Math.sign(y[0])!==Math.sign(r)&&y.splice(0,y.length,0,0,0,0),n=e.deltaX*p,r=e.deltaY*p*g+y[0]*m+y[1]*b+y[2]*v,y.unshift(r),y.pop(),new c.Vector2(-n,-r)}function i(t){var e=t.nativeEvent;return new c.Vector2(e.deltaX,-e.deltaY)}function o(t){var e=t.nativeEvent,n=e.deltaX;void 0===n&&(n=void 0!==e.wheelDeltaX?e.wheelDeltaX*f:0);var r=e.deltaY;return void 0===r&&(r=void 0!==e.wheelDeltaY?e.wheelDeltaY*f:(e.wheelDelta||-e.detail)*d),new c.Vector2(-n,-r)}function s(t){var e=t.nativeEvent,n=e.deltaX,r=e.deltaY;void 0===n&&(n=void 0!==e.wheelDeltaX?e.wheelDeltaX*f:0),void 0===r&&(r=void 0!==e.wheelDeltaY?e.wheelDeltaY*f:e.wheelDelta||-e.detail);var i=new c.Vector2(n,-r);return i.multiplyScalar(.25),i}function a(t,e){var n=0,r=0,i=0,o=0,s=e||t.nativeEvent.target;if(t||(t=window.event),t.pageX||t.pageY?(n=t.pageX,r=t.pageY):(t.clientX||t.clientY)&&(n=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,r=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),s.offsetParent)do{i+=s.offsetLeft,o+=s.offsetTop,s=s.offsetParent}while(s);return{x:n-i,y:r-o}}Object.defineProperty(e,"__esModule",{value:!0});var u,h=n(32),c=n(0),l=n(2)("CommunicationsView:Mouse"),f=1/30,d=-.25,p=100,y=[0,0,0,0],g=.1,m=.2,b=.2,v=.5;e.normalizeWheel=u,h.firefox?(l("Using mouse wheel for firefox"),e.normalizeWheel=u=r):h.msie&&+h.version>=11?(l("Using mouse wheel for IE 11"),e.normalizeWheel=u=o):h.msedge?(l("Using mouse wheel for MS EDGE"),e.normalizeWheel=u=s):(l("Using mouse wheel for Chrome"),e.normalizeWheel=u=i),e.eventElementPosition=a},function(t,e,n){"use strict";function r(t,e){var n=[];return e.forEach(function(e){t.find(function(t){return e instanceof t})&&n.push(e)}),n}var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(1);e.filterQuery=r;var s=function(){function t(t,e){this.TL=null,this.TR=null,this.BL=null,this.BR=null;var n=t.mid;this.TL=new a(t.x,n.x,t.y,n.y,e),this.TR=new a(n.x,t.right,t.y,n.y,e),this.BL=new a(t.x,n.x,n.y,t.bottom,e),this.BR=new a(n.x,t.right,n.y,t.bottom,e)}return t.prototype.destroy=function(){this.TL.destroy(),this.TR.destroy(),this.BL.destroy(),this.BR.destroy(),this.TL=null,this.TR=null,this.BL=null,this.BR=null},t}();e.Quadrants=s;var a=function(){function t(t,e,n,r,i){this.bounds=null,this.children=[],this.childrenProps=[],this.depth=0,this.nodes=null,arguments.length>=4?this.bounds=new o.Bounds(t,e,n,r):this.bounds=new o.Bounds(0,1,1,0),this.depth=i||0}return t.prototype.destroy=function(){this.children=null,this.bounds=null,this.nodes&&(this.nodes.destroy(),this.nodes=null)},t.prototype.add=function(t,e){return t.isInside(this.bounds)?this.doAdd(t):(this.cover(t),this.add(t,e))},t.prototype.addAll=function(t,e){var n=this;e=e||[];var r=Number.MAX_VALUE,i=Number.MAX_VALUE,s=-Number.MAX_VALUE,a=-Number.MAX_VALUE;t.forEach(function(t){t.x<r&&(r=t.x),t.right>s&&(s=t.right),t.bottom<i&&(i=t.bottom),t.y>a&&(a=t.y)}),this.cover(new o.Bounds(r,s,a,i)),t.forEach(function(t,e){return n.doAdd(t)})},t.prototype.cover=function(t){var e=this;if(!t.isInside(this.bounds)){this.bounds.encapsulate(t),this.bounds.x-=1,this.bounds.y+=1,this.bounds.width+=2,this.bounds.height+=4;var n=this.gatherChildren([]);this.nodes&&(this.nodes.destroy(),this.nodes=null),n.forEach(function(t,n){return e.doAdd(t)})}},t.prototype.doAdd=function(t){return this.nodes?t.isInside(this.nodes.TL.bounds)?this.nodes.TL.doAdd(t):t.isInside(this.nodes.TR.bounds)?this.nodes.TR.doAdd(t):t.isInside(this.nodes.BL.bounds)?this.nodes.BL.doAdd(t):t.isInside(this.nodes.BR.bounds)?this.nodes.BR.doAdd(t):(this.children.push(t),!0):t.isInside(this.bounds)?(this.children.push(t),this.children.length>5&&this.depth<10&&this.split(),!0):(isNaN(t.width+t.height+t.x+t.y)?console.error("Child did not fit into bounds because a dimension is NaN",t):0===t.area&&console.error("Child did not fit into bounds because the area is zero",t),!0)},t.prototype.gatherChildren=function(t){return t=t.concat(this.children),this.nodes&&(this.nodes.TL.gatherChildren(t),this.nodes.TR.gatherChildren(t),this.nodes.BL.gatherChildren(t),this.nodes.BR.gatherChildren(t)),t},t.prototype.gatherProps=function(t){var e=this;return this.children.forEach(function(n,r){t.push(e.childrenProps[r])}),this.nodes&&(this.nodes.TL.gatherProps(t),this.nodes.TR.gatherProps(t),this.nodes.BL.gatherProps(t),this.nodes.BR.gatherProps(t)),t},t.prototype.query=function(t,e){return t instanceof o.Bounds?t.hitBounds(this.bounds)?this.queryBounds(t,[],e):[]:this.bounds.containsPoint(t)?this.queryPoint(t,[],e):[]},t.prototype.queryBounds=function(t,e,n){return this.children.forEach(function(n,r){n.hitBounds(t)&&e.push(n)}),n&&n(this),this.nodes&&(t.hitBounds(this.nodes.TL.bounds)&&this.nodes.TL.queryBounds(t,e,n),t.hitBounds(this.nodes.TR.bounds)&&this.nodes.TR.queryBounds(t,e,n),t.hitBounds(this.nodes.BL.bounds)&&this.nodes.BL.queryBounds(t,e,n),t.hitBounds(this.nodes.BR.bounds)&&this.nodes.BR.queryBounds(t,e,n)),e},t.prototype.queryPoint=function(t,e,n){return this.children.forEach(function(n,r){n.containsPoint(t)&&e.push(n)}),n&&n(this),this.nodes&&(this.nodes.TL.bounds.containsPoint(t)&&this.nodes.TL.queryPoint(t,e,n),this.nodes.TR.bounds.containsPoint(t)&&this.nodes.TR.queryPoint(t,e,n),this.nodes.BL.bounds.containsPoint(t)&&this.nodes.BL.queryPoint(t,e,n),this.nodes.BR.bounds.containsPoint(t)&&this.nodes.BR.queryPoint(t,e,n)),e},t.prototype.split=function(){var t=this.gatherChildren([]);for(this.nodes=new s(this.bounds,this.depth+1),this.children=[],this.childrenProps=[];t.length>0;)this.doAdd(t.pop())},t.prototype.visit=function(t){var e=Boolean(t(this));this.nodes&&!e&&(this.nodes.TL.visit(t),this.nodes.TR.visit(t),this.nodes.BL.visit(t),this.nodes.BR.visit(t))},t}();e.Node=a;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(a);e.QuadTree=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(21),o=n(5),s=n(6),a=function(t){function e(e){var n=t.call(this,e)||this;return n.depth=0,n.lineWidth=1,n.encapsulatePoints(n.getTriangleStrip()),n.cachesQuadSegments=e.cacheSegments,n.depth=e.depth||0,n.lineWidth=e.lineWidth||1,n.startColor=e.startColor,n.endColor=e.endColor,n}return r(e,t),e.prototype.clone=function(){var t=new e({cacheSegments:this.cachesSegments,controlPoints:this.controlPoints,end:this.end,endColor:this.endColor,lineWidth:this.lineWidth,resolution:this.resolution,start:this.start,startColor:this.startColor,type:this.type});return t.d=this.d,t},e.prototype.distanceTo=function(e){return Math.max(0,t.prototype.distanceTo.call(this,e)-this.lineWidth/2)},e.prototype.getTriangleStrip=function(){if(this.cachesSegments&&this.cachedQuadSegments)return this.cachedQuadSegments;var t=[],e=[],n=this.getLineStrip(),r=this.lineWidth/2,i=new o.Line(s.Point.zero(),s.Point.zero()),a=s.Point.zero();if(n.length<2)return[];for(var u=0;u<n.length-1;u++){if(i.setPoints(n[u],n[u+1]),0===e.length)e.push(i.perpendicular);else{var h={x:e[u].x+i.perpendicular.x,y:e[u].y+i.perpendicular.y},c=Math.sqrt(h.x*h.x+h.y*h.y);h.x=h.x/c,h.y=h.y/c,e[u]=h}e.push(i.perpendicular)}for(var u=0;u<n.length-1;u++){var l=n[u],f=n[u+1];t.push(s.Point.add(s.Point.scale(e[u+1],-r,a),f)),t.push(s.Point.add(s.Point.scale(e[u+1],r,a),f)),t.push(s.Point.add(s.Point.scale(e[u],-r,a),l)),t.push(s.Point.add(s.Point.scale(e[u],r,a),l))}return t},e.prototype.setPoints=function(e,n,r){t.prototype.setPoints.call(this,e,n,r),this.cachedQuadSegments=[]},e}(i.CurvedLine);e.CurvedLineShape=a},function(t,e,n){"use strict";function r(t,e){var n,r=t.getLineStrip(),i=g.Point.getClosestIndex(e,r),o=Number.MAX_VALUE;return i>0&&(n=new y.Line(r[i],r[i-1]),o=n.distanceTo(e)),i<r.length-1&&(n=new y.Line(r[i],r[i+1]),o=Math.min(o,n.distanceTo(e))),o}function i(t,e){var n,r=t.getLineStrip(),i=g.Point.getClosestIndex(e,r),o=Number.MAX_VALUE;return i>0&&(n=new y.Line(r[i],r[i-1]),o=n.distanceTo(e)),i<r.length-1&&(n=new y.Line(r[i],r[i+1]),o=Math.min(o,n.distanceTo(e))),o}function o(t,e){return new y.Line(t.start,t.end).distanceTo(e)}function s(t){if(t.cachesSegments&&t.cachedSegments)return t.cachedSegments;for(var e=[],n=1/t.resolution,r=t.start,i=(t.end,t.controlPoints[0]),o=0,s=t.resolution;o<=s;++o)e.push(d.bezier2(n*o,r,s,i));return t.cachesSegments&&(t.cachedSegments=e),e}function a(t){if(t.cachesSegments&&t.cachedSegments)return t.cachedSegments;for(var e=[],n=1/t.resolution,r=t.start,i=(t.end,t.controlPoints[0]),o=t.controlPoints[1],s=0,a=t.resolution;s<=a;++s)e.push(d.bezier3(n*s,r,a,i,o));return t.cachesSegments&&(t.cachedSegments=e),e}function u(t){if(t.cachesSegments&&t.cachedSegments)return t.cachedSegments;m("CW");var e=new y.Line(t.start,t.end),n=g.Point.getDistance(t.start,t.controlPoints[0]),r=t.controlPoints[1];if(!r){var i=g.Point.getMidpoint(t.start,t.end),o=g.Point.getDistance(i,t.start);n<o&&(n=g.Point.getDistance(i,t.start));var s=e.perpendicular,a=Math.sqrt(n*n-o*o);r={x:s.x*a+i.x,y:s.y*a+i.y},t.controlPoints[1]=r}m(" center of circle is %o  %o",r.x,r.y);var u=g.Point.getDirection(r,t.start),h=Math.atan2(u.y,u.x),c=g.Point.getDirection(r,t.end),l=Math.atan2(c.y,c.x);h<l&&(h+=2*Math.PI);var f=(h-l)/t.resolution;m("theta1 is %o, theta2 is %o",h,l);for(var d=[],p=0,b=t.resolution+1;p<b;++p)d.push({x:Math.cos(h-f*p)*n+r.x,y:Math.sin(h-f*p)*n+r.y});return t.cachesSegments&&(t.cachedSegments=d),m("Generated Circular Segments: %o dTheta: %o radius: %o",d,f,n),d}function h(t){if(t.cachesSegments&&t.cachedSegments)return t.cachedSegments;var e=new y.Line(t.start,t.end),n=g.Point.getDistance(t.start,t.controlPoints[0]),r=t.controlPoints[1];if(!r){var i=g.Point.getMidpoint(t.start,t.end),o=g.Point.getDistance(i,t.start);n<o&&(n=g.Point.getDistance(i,t.start));var s=e.perpendicular,a=Math.sqrt(n*n-o*o);r={x:-s.x*a+i.x,y:-s.y*a+i.y},t.controlPoints[1]=r}var u=g.Point.getDirection(r,t.start),h=Math.atan2(u.y,u.x),c=g.Point.getDirection(r,t.end),l=Math.atan2(c.y,c.x);l<h&&(l+=2*Math.PI);for(var f=(l-h)/t.resolution,d=[],p=0,m=t.resolution+1;p<m;++p)d.push({x:Math.cos(h+f*p)*n+r.x,y:Math.sin(h+f*p)*n+r.y});return t.cachedSegments&&(t.cachedSegments=d),d}function c(t){return[t.start,t.end]}var l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var f,d=n(11),p=n(1),y=n(5),g=n(6),m=n(2)("bezier");!function(t){t[t.Bezier=0]="Bezier",t[t.CircularCCW=1]="CircularCCW",t[t.CircularCW=2]="CircularCW",t[t.Straight=3]="Straight"}(f=e.CurveType||(e.CurveType={}));var b=(w={},w[f.Bezier]=[null,s,a],w[f.CircularCW]=[null,u,u],w[f.CircularCCW]=[null,h,h],w[f.Straight]=[c],w),v=(_={},_[f.Bezier]=r,_[f.CircularCW]=i,_[f.CircularCCW]=i,_[f.Straight]=o,_),x=function(t){function e(e){var n=this,r=Number.MAX_VALUE,i=-Number.MAX_VALUE,o=Number.MAX_VALUE,s=-Number.MAX_VALUE;return n=t.call(this,r,i,s,o)||this,n.cachesSegments=e.cacheSegments||!1,n.type=e.type,n.resolution=e.resolution||20,n.setPoints(e.start,e.end,e.controlPoints),n.distanceMethod=v[e.type],n}return l(e,t),Object.defineProperty(e.prototype,"values",{get:function(){return{controlPoints:this.controlPoints,end:this.end,start:this.start}},enumerable:!0,configurable:!0}),e.prototype.distanceTo=function(t){return this.distanceMethod(this,t)},e.getClosest=function(t,e){var n,r=Number.MAX_VALUE,i=0;return t.forEach(function(t){(i=t.distanceTo(e))<r&&(n=t,r=i)}),n},e.prototype.getLineStrip=function(){return this.segmentMethod(this)},e.prototype.setPoints=function(t,e,n){this.start=t,this.end=e,0===n.length&&m("start: %o, end:%o",t,e);var r=b[this.type];if(n){this.controlPoints=n;var i=n.length;if(i>r.length&&(i=r.length-1),this.segmentMethod=r[i],!this.segmentMethod)throw new Error("An Invalid number of control points was provided to a curved line. You must have at LEAST 1 control point. Or 0 for a straight line");this.type===f.Bezier?this.encapsulatePoints(n):this.type!==f.CircularCCW&&this.type!==f.CircularCW||this.encapsulatePoints(this.getLineStrip())}this.encapsulatePoint(t),this.encapsulatePoint(e),this.cachedSegments=null},e}(p.Bounds);e.CurvedLine=x;var w,_},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=0,s=function(t){function e(e,n,r,i){var s=t.call(this,0,0,0,0)||this;return s._id=++o,s._radius=0,s._centerX=0,s._centerY=0,s._centerX=e,s._centerY=n,s._radius=r,s.d=i,s.updateBounds(),s}return r(e,t),Object.defineProperty(e.prototype,"values",{get:function(){return{radius:this._radius,x:this._centerX,y:this._centerY}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this.updateBounds()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"centerX",{get:function(){return this._centerX},set:function(t){this._centerX=t,this.updateBounds()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"centerY",{get:function(){return this._centerY},set:function(t){this._centerY=t,this.updateBounds()},enumerable:!0,configurable:!0}),e.prototype.boundsInside=function(t){var e=this._radius*this._radius,n=t.x-this._centerX,r=t.y-this._centerY,i=r*r,o=n*n;return!(o+i>e)&&(n=t.right-this._centerX,!((o=n*n)+i>e)&&(r=t.bottom-this._centerY,i=r*r,!(o+i>e)&&(n=t.x-this._centerX,(o=n*n)+i<e)))},e.prototype.distanceTo=function(t,e){var n=this._centerX-t.x,r=this._centerY-t.y;return e?n*n+r*r:Math.sqrt(n*n+r*r)},e.getClosest=function(t,e){var n,r=Number.MAX_VALUE,i=0;return t.forEach(function(t){(i=t.distanceTo(e,!0))<r&&(n=t,r=i)}),n},e.prototype.hitCircle=function(t){var e=t._radius+this._radius;return e*=e,this.distanceTo({x:t._centerX,y:t._centerY},!0)<e},e.prototype.hitPoint=function(t){var e=this._radius*this._radius,n=t.x-this._centerX,r=t.y-this._centerY;return n*n+r*r<e},e.prototype.position=function(t,e,n){this._centerX=t,this._centerY=e,this._radius=n,this.updateBounds()},e.prototype.pointInside=function(t){var e=this._radius*this._radius,n=t.x-this._centerX,r=t.y-this._centerY;return n*n+r*r<e},e.prototype.updateBounds=function(){var t=this._radius;this.x=this._centerX-t,this.y=this._centerY-t,this.height=2*t,this.width=2*t},e.prototype.toString=function(){return"[Circle {x: "+this._centerX+", y: "+this._centerY+", r: "+this._radius+"}]"},e}(i.Bounds);e.Circle=s},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),o=function(t){function e(e,n,r,i,o,s,a,u,h,c,l,f){var d=t.call(this,e,n)||this;return d.a=0,d.b=0,d.g=0,d.r=1,d.a2=0,d.b2=0,d.g2=0,d.r2=1,d.cull=!0,d.thickness=1,Object.assign(d,{a:a,a2:l,b:s,b2:c,d:r,g:o,g2:h,r:i,r2:u}),void 0!==f&&(d.thickness=f),d}return r(e,t),e.prototype.clone=function(t){return Object.assign(new e(this.p1,this.p2,this.d,this.r,this.g,this.b,this.a,this.r2,this.g2,this.b2,this.a2),this,t)},e}(i.Line);e.LineShape=o},function(t,e,n){"use strict";function r(t){return t.id}function i(t,e){var n=e[0].buffer.length,r=e[0];return e.some(function(t){return t.buffer.length<n&&(r=t,!0)}),r.buffer.push(t),[r]}function o(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]}function s(t,e,n){return[e]}var a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var u=n(25),h="__mb__",c=0,l=function(t){function e(e,n){var a=t.call(this)||this;return a.numBuffers=0,a.selectionUID=h+ ++c,a.addMethod=i,a.idMethod=r,a.initMethod=o,a.removeMethod=s,a.updateMethod=s,a.numBuffers=e,n&&(a.addMethod=n.add||a.addMethod,a.idMethod=n.id||a.idMethod,a.initMethod=n.init||a.initMethod,a.removeMethod=n.remove||a.removeMethod,a.updateMethod=n.update||a.updateMethod),a}return a(e,t),e.prototype.addShape=function(t){var e=this.addMethod(t,this.store.allBuffers);this.store.idToItem.set(this.idMethod(t),t),this.store.itemToBuffer.set(t,e[0]),this.flagBuffersDirty(e)},e.prototype.containsId=function(t){return Boolean(this.store.idToItem.get(t))},e.prototype.containsShape=function(t){return Boolean(this.store.itemToBuffer.get(t))},e.prototype.flagBuffersDirty=function(t){t?t.forEach(function(t){return t.isDirty=!0}):this.store.allBuffers.forEach(function(t){return t.isDirty=!0})},e.prototype.generate=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.getStorage(e),t.prototype.generate.apply(this,arguments),this.processDirtyBuffers()},e.prototype.getBuffer=function(){return console.warn("A multishape buffer should have getBuffers called instead"),[]},e.prototype.getBuffers=function(){return this.store?this.store.allBuffers.map(function(t){return t.buffer}):[]},e.prototype.getNumBuffers=function(){return this.store.allBuffers.length},e.prototype.getShapeById=function(t){return this.store.idToItem.get(t)},e.prototype.processDirtyBuffers=function(){this.store.allBuffers.forEach(function(t){t.isDirty&&(t.isDirty=!1,t.buffer=[].concat(t.buffer))})},e.prototype.getStorage=function(t){var e=(t.getSelection(this.selectionUID)||[])[0];if(!e){e={allBuffers:[],idToItem:new Map,itemToBuffer:new Map};for(var n=0;n<this.numBuffers;++n)e.allBuffers.push({buffer:[],isDirty:!1});this.initMethod(e.allBuffers),t.select(this.selectionUID,e)}return this.store=e},e.prototype.removeShape=function(t){var e=this.store.itemToBuffer.get(t),n=this.removeMethod(t,e,this.store.allBuffers);e.buffer.splice(e.buffer.indexOf(t),1),this.store.idToItem.delete(this.idMethod(t)),this.flagBuffersDirty(n)},e.prototype.updateShape=function(t){var e=this.updateMethod(t,this.store.itemToBuffer.get(t),this.store.allBuffers);this.flagBuffersDirty(e)},e}(u.ShapeBufferCache);e.MultiShapeBufferCache=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.buffer=[],this.bustCache=!0}return t.prototype.generate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.bustCache&&(this.buildCache.apply(this,t),this.bustCache=!1)},t.prototype.buildCache=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.getBuffer=function(){return this.buffer},t}();e.ShapeBufferCache=r},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(27)),r(n(33)),r(n(40)),r(n(48)),r(n(49))},function(t,e,n){"use strict";function r(t){return!!t.options}function i(t){return!t.options}function o(t){return t?t>0?1:t<0?-1:0:0}var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var a,u=n(12),h=n(28),c=n(0),l=n(13),f=n(8),d=n(1),p=n(9),y=n(18),g=n(19),m=n(2)("webgl-surface:GPU"),b=n(2)("webgl-surface:Camera"),v=n(2)("webgl-surface:Labels"),x=n(2)("webgl-surface:Colors");!function(t){t[t.INITIALIZE=0]="INITIALIZE",t[t.BUFFERCHANGES=1]="BUFFERCHANGES",t[t.CAMERA=2]="CAMERA",t[t.LABELS=3]="LABELS",t[t.COLORS=4]="COLORS"}(a=e.BaseApplyPropsMethods||(e.BaseApplyPropsMethods={}));var w;!function(t){t[t.CONTEXT=0]="CONTEXT",t[t.INERTIA=1]="INERTIA",t[t.POSITION=2]="POSITION",t[t.ZOOM=3]="ZOOM"}(w=e.BaseAnimatedMethods||(e.BaseAnimatedMethods={}));var _=(new c.Color).setRGB(38/255,50/255,78/255),M=new c.Vector3,C=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(t){return!1}}(),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.atlasManager=new l.AtlasManager(2048,2048),e.atlasNames={colors:"colors",labels:"labels"},e.animatedMethodList=[],e.animatedMethodBreak=!1,e.distance=0,e.camera=null,e.disableMouseInteraction=0,e.sizeCamera=null,e.currentZoom=1,e.destinationX=0,e.destinationY=0,e.destinationZoom=1,e.isPanning=!1,e.lastMousePosition={x:0,y:0},e.propsMethodList=[],e.inertia=null,e.inertiaBuild=1.5,e.inertiaDecay=.9,e.inertiaMax=100,e.quadTree=null,e.shiftIsDown=!1,e.stop=!1,e.currentX=0,e.currentY=0,e.targetZoom=1,e.previousZoomToFit=0,e.zoomTargetX=0,e.zoomTargetY=0,e.animating=!1,e.labels=[],e.labelsReady=!1,e.labelsCurrentLoadedId=0,e.labelsLoadId=0,e.colors=[],e.colorsReady=!1,e.currentHoverItems=[],e.animate=function(){if(!e.stop){p.FrameInfo.lastFrameTime=Date.now(),p.FrameInfo.framesPlayed.set(e,(p.FrameInfo.framesPlayed.get(e)||0)+1),requestAnimationFrame(function(){return e.animate()});var t,n=!1;e.animatedMethodList.some(function(o){return r(o)?o.options.labelsReady&&o.options.colorsReady?e.labelsReady&&e.colorsReady&&(t=o.method()):o.options.labelsReady?e.labelsReady&&(t=o.method()):o.options.colorsReady&&e.colorsReady&&(t=o.method()):i(o)&&(t=o()),n||(n=t.doDraw),t.stop&&(e.stop=!0),!!t.break})||(e.updateCameraUniforms(),e.disableMouseInteraction>0&&e.disableMouseInteraction--,(n||e.forceDraw)&&(e.forceDraw=!1,e.emitViewport(),e.draw()))}},e.applyProps=function(t){m("Applying props");var n;e.propsMethodList.some(function(e){return n=e(t),!!n.break}),b("current cam",e.currentX,e.currentY,e.destinationX,e.destinationY),b("Zoom Target: [%o, %o]",e.zoomTargetX,e.zoomTargetY),b("Last Mouse: [%o, %o]",e.lastMousePosition.x,e.lastMousePosition.y)},e.draw=function(){e.renderer.render(e.scene,e.camera)},e.init=function(t,n,r){if(t&&!e.scene&&(e.renderEl=t,0!==n&&0!==r)){m("Initializing GPU objects el: %o width: %o height: %o",t,n,r),e.ctx={height:r,heightHalf:r/2,width:n,widthHalf:n/2},e.initCamera(),window.scene=e.scene=new c.Scene,e.initBuffers(),e.renderer=new c.WebGLRenderer({antialias:!0}),m("Window Pixel Ratio: %o",window.devicePixelRatio),e.renderer.setPixelRatio(window.devicePixelRatio),e.renderer.setSize(n,r),e.renderer.setClearColor(_),e.renderer.setFaceCulling(c.CullFaceNone);t.appendChild(e.renderer.domElement)}},e.initCamera=function(){m("Initializing Camera");var t=e.ctx.height,n=t,r=e.ctx.width,i=r/t,o={aspectRatio:i,bottom:-n/2,far:1e7,left:-i*n/2,near:-100,right:i*n/2,top:n/2,viewSize:n};e.camera=new c.OrthographicCamera(o.left,o.right,o.top,o.bottom,o.near,o.far),e.sizeCamera=new c.OrthographicCamera(o.left,o.right,o.top,o.bottom,o.near,o.far),e.camera.position.z=300,e.sizeCamera.position.set(0,0,300)},e.resizeContext=function(){var t=e.props.width,n=e.props.height;if(!e.renderer)return!1;var r=e.renderer.getSize();if(r.width===t&&r.height===n)return!1;m("RENDERER RESIZE"),e.ctx={height:n,heightHalf:n/2,width:t,widthHalf:t/2};var i=e.camera.zoom,o=e.camera.position.clone();return e.initCamera(),e.camera.zoom=i,e.camera.position.set(o.x,o.y,o.z),e.camera.updateProjectionMatrix(),e.renderer.setPixelRatio(window.devicePixelRatio),e.renderer.setSize(t,n),e.renderer.setClearColor((new c.Color).setRGB(38/255,50/255,78/255)),e.renderer.setFaceCulling(c.CullFaceNone),!0},e.emitViewport=function(){var t=e.screenToWorld(0,0),n=e.screenToWorld(e.ctx.width,e.ctx.height);e.camera.updateMatrixWorld(!0);var r=e.quadTree.query(new d.Bounds(t.x,n.x,t.y,n.y));e.onViewport(r,e.projection,e.ctx)},e.handleMouseDown=function(t){e.disableMouseInteraction>0||(e.isPanning=!0,e.distance=0,e.onMouseDown())},e.handleMouseOut=function(t){e.disableMouseInteraction>0||(e.isPanning=!1,e.distance=0,e.onMouseOut())},e.handleMouseUp=function(t){if(!(e.disableMouseInteraction>0)){e.isPanning=!1;var n=y.eventElementPosition(t),r=e.screenToWorld(n.x,n.y);if(e.distance<5){for(var i=[],o=e.quadTree.query(r),s=0,a=o;s<a.length;s++){var u=a[s];u.pointInside(r)&&i.push(u)}i.length?e.onMouseUp(t,i,n,r,e.projection):e.onMouseUp(t,null,n,r,e.projection)}}},e.handleMouseMove=function(t){if(!(e.disableMouseInteraction>0)){var n=e.props.onMouse,r=e.props.zoom,i=y.eventElementPosition(t),s=e.screenToWorld(i.x,i.y);if(e.distance++,e.isPanning){var a=(i.x-e.lastMousePosition.x)/e.targetZoom,u=-(i.y-e.lastMousePosition.y)/e.targetZoom,h=e.willPan(a,u);a=h.x,u=h.y,e.destinationX-=a,e.destinationY-=u,e.inertia=e.inertia||{x:0,y:0},o(a)!==o(e.inertia.x)&&(e.inertia.x=0),o(u)!==o(e.inertia.y)&&(e.inertia.y=0),e.inertia.x=a*e.inertiaBuild,e.inertia.y=u*e.inertiaBuild;var c=e.inertiaMax/r,l=Math.sqrt(e.inertia.x*e.inertia.x+e.inertia.y*e.inertia.y);l>c&&(e.inertia.x=e.inertia.x/l*c,e.inertia.y=e.inertia.y/l*c)}if(e.quadTree&&!e.isPanning){for(var f=[],d=e.quadTree.query(s),p=[],g=0,m=d;g<m.length;g++){var b=m[g];b.pointInside(s)&&(p.push(b),f.push(b))}e.onMouseHover(p,i,s,e.projection);for(var v=[],x=0,w=e.currentHoverItems;x<w.length;x++){var b=w[x];f.indexOf(b)<0&&v.push(b)}e.onMouseLeave(v,i,s,e.projection),e.currentHoverItems=f}n&&e.onMouse(i,s,e.isPanning),e.lastMousePosition=i}},e.applyRef=function(t){e.init(t,e.props.width,e.props.height),e.applyProps(e.props)},e}return s(e,t),e.prototype.animatedMethods=function(t,e){return e},e.prototype.animatedMethodsBase=function(){var t=this;return e={},e[w.CONTEXT]=function(){var e={break:!1,doDraw:!1};return t.resizeContext()&&(e.doDraw=!0),t.quadTree||(e.break=!0),e},e[w.INERTIA]=function(){return t.isPanning||t.inertia&&(t.inertia.x*=t.inertiaDecay,t.inertia.y*=t.inertiaDecay,t.inertia.x*t.inertia.x+t.inertia.y*t.inertia.y<1&&(t.inertia=null)),{doDraw:!1}},e[w.POSITION]=function(){var e={doDraw:t.currentX!==t.destinationX||t.currentY!==t.destinationY};return t.currentX=t.destinationX,t.currentY=t.destinationY,t.positionCamera(t.currentX,t.currentY),e},e[w.ZOOM]=function(){var e={doDraw:!1},n=1*t.destinationZoom,r=Math.abs(n-t.targetZoom);r>.001?(t.targetZoom=t.targetZoom+(n-t.targetZoom)/3,e.doDraw=!0):0!==r&&(t.targetZoom=n,e.doDraw=!0);var i=t.zoomTargetX,o=t.zoomTargetY,s=t.worldToScreen(i,o);t.zoomCamera(t.targetZoom);var a=t.worldToScreen(i,o),u=-(a.x-s.x)/t.targetZoom,h=(a.y-s.y)/t.targetZoom;return t.currentX-=u,t.currentY-=h,t.destinationX-=u,t.destinationY-=h,t.positionCamera(t.currentX,t.currentY),e},e;var e},e.prototype.applyColorBufferChanges=function(t){},e.prototype.applyLabelBufferChanges=function(t){},e.prototype.applyPropsMethods=function(t,e){return e},e.prototype.applyPropsMethodsBase=function(){var t=this;return e={},e[a.INITIALIZE]=function(e){var n=e.height,r=e.width;if(t.init(t.renderEl,r,n),!t.renderEl||0===r||0===n)return{break:!0};if(t.camera){var i=t.screenToWorld(t.lastMousePosition.x,t.lastMousePosition.y);t.zoomTargetX=i.x,t.zoomTargetY=i.y}return m("props",e),{}},e[a.LABELS]=function(e){var n={};if(e.labels&&e.labels!==t.labels){v("Labels are being comitted to an Atlas %o",e.labels),t.labelsReady=!1,t.labelsLoadId++,t.labels=e.labels,t.atlasManager.getAtlasTexture(t.atlasNames.labels)&&t.atlasManager.destroyAtlas(t.atlasNames.labels);var r=e.labels.map(function(t){return new f.AtlasTexture(null,t)});v("Creating the atlas for labels based on these textures %o",r),t.atlasManager.createAtlas(t.atlasNames.labels,r).then(function(){v("Labels rasterized within the atlas: %o",t.atlasManager.getAtlasTexture(t.atlasNames.labels)),t.forceDraw=!0,t.labelsCurrentLoadedId++,t.labelsCurrentLoadedId===t.labelsLoadId&&(t.labelsReady=!0),t.applyProps(t.props)})}return n},e[a.COLORS]=function(e){var n={};return e.colors&&e.colors!==t.colors&&(x("Colors are being comitted to an Atlas %o",e.colors),t.colorsReady=!1,t.colors=e.colors,t.atlasManager.getAtlasTexture(t.atlasNames.colors)&&t.atlasManager.destroyAtlas(t.atlasNames.colors),x("Creating the atlas for colors based on these colors %o",t.colors),t.atlasManager.createAtlas(t.atlasNames.colors,null,t.colors).then(function(){x("Colors rasterized within the atlas: %o",t.atlasManager.getAtlasTexture(t.atlasNames.colors)),t.forceDraw=!0,t.colorsReady=!0,t.applyProps(t.props)})),n},e[a.BUFFERCHANGES]=function(e){return t.applyBufferChanges(e),t.labelsReady&&t.colorsReady&&(v("labels changed %o",e),t.applyLabelBufferChanges(e)),t.colorsReady&&t.applyColorBufferChanges(e),{}},e[a.CAMERA]=function(e){if(t.destinationZoom=e.zoom,e.viewport&&e.viewport!==t.appliedViewport&&t.quadTree){b("Applying viewport to camera: %o World Space Bounds: %o Screen context: %o",e.viewport,t.quadTree.bounds,{width:e.width,height:e.height});var n=e.viewport.mid;t.currentX=t.destinationX=n.x,t.currentY=t.destinationY=n.y;var r=e.width/e.viewport.width,i=e.height/e.viewport.height,o=Math.min(r,i);t.destinationZoom=o/1,t.targetZoom=1*t.destinationZoom*1.001,t.zoomTargetX=n.x,t.zoomTargetY=n.y,t.lastMousePosition.x=e.width/2,t.lastMousePosition.y=e.height/2,t.positionCamera(t.currentX,t.currentY),t.zoomCamera(t.targetZoom),t.updateCameraUniforms(),e.onZoomRequest&&(e.onZoomRequest(t.destinationZoom),b("Requesting zoom level",t.destinationZoom));t.disableMouseInteraction=10,t.appliedViewport=e.viewport,b("init cam",t.currentX,t.currentY)}return t.quadTree||(t.quadTree=new g.QuadTree(0,1,1,0)),{}},e;var e},e.prototype.applyBufferChanges=function(t){},e.prototype.componentDidMount=function(){this.animate()},e.prototype.componentWillMount=function(){this.projection={screenSizeToWorld:this.screenSizeToWorld.bind(this),screenToWorld:this.screenToWorld.bind(this),worldSizeToScreen:this.worldSizeToScreen.bind(this),worldToScreen:this.worldToScreen.bind(this)};var t=this.applyPropsMethodsBase();this.propsMethodList=this.applyPropsMethods(t,[t[a.INITIALIZE],t[a.LABELS],t[a.COLORS],t[a.BUFFERCHANGES],t[a.CAMERA]]);var e=this.animatedMethodsBase();this.animatedMethodList=this.animatedMethods(e,[e[w.CONTEXT],e[w.INERTIA],e[w.POSITION],e[w.ZOOM]])},e.prototype.componentWillReceiveProps=function(t){this.applyProps(t)},e.prototype.componentWillUnmount=function(){this.stop=!0,this.quadTree&&this.quadTree.destroy(),this.quadTree=null,this.camera=null,this.sizeCamera=null,this.ctx=null,this.renderEl=null,this.renderer=null,this.scene=null,this.atlasManager.destroyAtlas(this.atlasNames.colors),this.atlasManager.destroyAtlas(this.atlasNames.labels),p.FrameInfo.framesPlayed.delete(this)},e.prototype.initBuffers=function(){},e.prototype.onMouse=function(t,e,n){},e.prototype.onMouseDown=function(){},e.prototype.onMouseOut=function(){},e.prototype.onMouseUp=function(t,e,n,r,i){},e.prototype.onMouseHover=function(t,e,n,r){},e.prototype.onMouseLeave=function(t,e,n,r){},e.prototype.onViewport=function(t,e,n){},e.prototype.positionCamera=function(t,e){this.camera&&this.camera.position.set(Math.floor(t),Math.floor(e),this.camera.position.z)},e.prototype.screenToWorld=function(t,e,n){return M.set(t/this.ctx.width*2-1,-e/this.ctx.height*2+1,0),M.unproject(this.camera),n=n||{x:0,y:0},n.x=M.x,n.y=M.y,n},e.prototype.screenSizeToWorld=function(t,e,n){return n=n||new d.Bounds(0,0,0,0),n.width=t/(this.sizeCamera?this.sizeCamera.zoom:1),n.height=e/(this.sizeCamera?this.sizeCamera.zoom:1),n},e.prototype.worldToScreen=function(t,e,n){return M.set(t,e,0),M.project(this.camera),n=u.merge(n||{},{x:M.x*this.ctx.widthHalf+this.ctx.widthHalf,y:-M.y*this.ctx.heightHalf+this.ctx.heightHalf})},e.prototype.worldSizeToScreen=function(t,e,n){return n=n||new d.Bounds(0,0,0,0),n.width=t*this.sizeCamera.zoom,n.height=e*this.sizeCamera.zoom,n},e.prototype.zoomCamera=function(t){this.camera.zoom=t,this.sizeCamera.zoom=t,this.camera.updateProjectionMatrix(),this.sizeCamera.updateProjectionMatrix()},e.prototype.updateCameraUniforms=function(){},e.prototype.shouldComponentUpdate=function(t){return this.props.width!==t.width||this.props.height!==t.height},e.prototype.willPan=function(t,e){return new c.Vector3(t,e,0)},e.prototype.render=function(){var t=this,e=this.props,n=e.width,r=e.height;return C?h.createElement("div",{onMouseDown:this.handleMouseDown,onMouseOut:this.handleMouseOut,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseOut,onMouseMove:this.handleMouseMove,onDoubleClick:function(e){t.props.onDoubleClick&&t.props.onDoubleClick(e)},style:{position:"relative",width:n,height:r}},h.createElement("div",{ref:this.applyRef})):h.createElement("div",null,this.props.children||"Web GL not supported")},e}(h.Component);e.WebGLSurface=P},function(t,e){t.exports=r},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function s(){y&&d&&(y=!1,d.length?p=d.concat(p):g=-1,p.length&&a())}function a(){if(!y){var t=i(s);y=!0;for(var e=p.length;e;){for(d=p,p=[];++g<e;)d&&d[g].run();g=-1,e=p.length}d=null,y=!1,o(t)}}function u(t,e){this.fun=t,this.array=e}function h(){}var c,l,f=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var d,p=[],y=!1,g=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new u(t,e)),1!==p.length||y||i(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=h,f.addListener=h,f.once=h,f.off=h,f.removeListener=h,f.removeAllListeners=h,f.emit=h,f.prependListener=h,f.prependOnceListener=h,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){function r(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}function i(t){function n(){if(n.enabled){var t=n,r=+new Date,i=r-(h||r);t.diff=i,t.prev=h,t.curr=r,h=r;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var a=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;a++;var i=e.formatters[r];if("function"==typeof i){var s=o[a];n=i.call(t,s),o.splice(a,1),a--}return n}),e.formatArgs.call(t,o);(n.log||e.log||console.log.bind(console)).apply(t,o)}}return n.namespace=t,n.enabled=e.enabled(t),n.useColors=e.useColors(),n.color=r(t),"function"==typeof e.init&&e.init(n),n}function o(t){e.save(t),e.names=[],e.skips=[];for(var n=("string"==typeof t?t:"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&(t=n[i].replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))}function s(){e.enable("")}function a(t){var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1}function u(t){return t instanceof Error?t.stack||t.message:t}e=t.exports=i.debug=i.default=i,e.coerce=u,e.disable=s,e.enable=o,e.enabled=a,e.humanize=n(31),e.names=[],e.skips=[],e.formatters={};var h},function(t,e){function n(t){if(t=String(t),!(t.length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*c;case"days":case"day":case"d":return n*h;case"hours":case"hour":case"hrs":case"hr":case"h":return n*u;case"minutes":case"minute":case"mins":case"min":case"m":return n*a;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function r(t){return t>=h?Math.round(t/h)+"d":t>=u?Math.round(t/u)+"h":t>=a?Math.round(t/a)+"m":t>=s?Math.round(t/s)+"s":t+"ms"}function i(t){return o(t,h,"day")||o(t,u,"hour")||o(t,a,"minute")||o(t,s,"second")||t+" ms"}function o(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}var s=1e3,a=60*s,u=60*a,h=24*u,c=365.25*h;t.exports=function(t,e){e=e||{};var o=typeof t;if("string"===o&&t.length>0)return n(t);if("number"===o&&!1===isNaN(t))return e.long?i(t):r(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e){t.exports=i},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(34)),r(n(35)),r(n(4)),r(n(36)),r(n(37)),r(n(38)),r(n(39))},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(3),s=n(4),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){this.bufferItems=o.BufferUtil.makeBufferItems(),this.bufferItems.attributes=[{defaults:[0,0,0],name:"position",size:o.AttributeSize.THREE},{defaults:[0],name:"startColorPick",size:o.AttributeSize.ONE},{defaults:[0],name:"endColorPick",size:o.AttributeSize.ONE},{defaults:[1],name:"normalDirection",size:o.AttributeSize.ONE},{defaults:[0,0,0,0],name:"endPoints",size:o.AttributeSize.FOUR},{defaults:[0],name:"halfLinewidth",size:o.AttributeSize.ONE},{defaults:[0,0,0,0],name:"marching",size:o.AttributeSize.FOUR},{defaults:[0],name:"controlPick",size:o.AttributeSize.ONE}];var n=e;this.bufferItems.geometry=o.BufferUtil.makeBuffer(6*n,this.bufferItems.attributes),this.bufferItems.system=new i.Mesh(this.bufferItems.geometry,t),this.bufferItems.system.frustumCulled=!1,this.bufferItems.system.drawMode=i.TriangleStripDrawMode},e.prototype.update=function(t,e,n){if(!t)return this.bufferItems.geometry.setDrawRange(0,0),!1;0===t.length&&(this.bufferItems.currentData=t);var r,i=[],s=new Map;if(t&&t.length>0&&e){var a=t[0].startColor,u=a.base,h=this.bufferItems.system.material,c=h.uniforms,l=e.getAtlasTexture(u.atlasReferenceID);c.colorAtlas.value=l,c.colorsPerRow.value=u.colorsPerRow,c.firstColor.value=[u.firstColor.x,u.firstColor.y],c.nextColor.value=[u.nextColor.x,u.nextColor.y],r=c.controlPoints,l.needsUpdate=!0}var f,d,p,y,g,m,b,v,x,w,_=1,M=15,C=!1;o.BufferUtil.beginUpdates();for(var P=this,I=0,S=t;I<S.length;I++){var O=S[I];if("break"===function(e){if(!e.marchingAnts)return console.error("Attempted to render a curved line shape with a marching ant buffer but provided no marching ant metrics. This curved line shape will be skipped",e),"continue";if(g=e.startColor.base.opacity,p=e.startColor.base,y=e.endColor.base,_=e.lineWidth/2,M=e.resolution,f=e.start,d=e.end,b=e.marchingAnts.gapLength,v=e.marchingAnts.speed,m=e.marchingAnts.strokeLength+e.marchingAnts.gapLength,x=e.controlPoints[n],void 0===(w=s.get(x))){var r=i.push(x.x,x.y);w=r-2,s.set(x,w)}return C=o.BufferUtil.updateBuffer(t,P.bufferItems,6,M,function(t,n,r,i,o,s,a,u,h,c,l,g,x,C,P,I,S){n[r]=(t+1)/M,n[++r]=M,n[++r]=e.depth,g[x]=_,o+=1,a+=1,P+=4,u[h]=1,c[l]=f.x,c[++l]=f.y,c[++l]=d.x,c[++l]=d.y,I[S]=w,n[++r]=(t+1)/M,n[++r]=M,n[++r]=e.depth,g[++x]=_,u[++h]=1,c[++l]=f.x,c[++l]=f.y,c[++l]=d.x,c[++l]=d.y,i[o]=p.colorIndex,s[a]=y.colorIndex,C[P]=0,C[++P]=v,C[++P]=b,C[++P]=m,I[++S]=w,n[++r]=(t+1)/M,n[++r]=M,n[++r]=e.depth,g[++x]=_,u[++h]=-1,c[++l]=f.x,c[++l]=f.y,c[++l]=d.x,c[++l]=d.y,i[++o]=p.colorIndex,s[++a]=y.colorIndex,C[++P]=0,C[++P]=v,C[++P]=b,C[++P]=m,I[++S]=w,n[++r]=t/M,n[++r]=M,n[++r]=e.depth,g[++x]=_,u[++h]=1,c[++l]=f.x,c[++l]=f.y,c[++l]=d.x,c[++l]=d.y,i[++o]=p.colorIndex,s[++a]=y.colorIndex,C[++P]=0,C[++P]=v,C[++P]=b,C[++P]=m,I[++S]=w,n[++r]=t/M,n[++r]=M,n[++r]=e.depth,g[++x]=_,u[++h]=-1,c[++l]=f.x,c[++l]=f.y,c[++l]=d.x,c[++l]=d.y,i[++o]=p.colorIndex,s[++a]=y.colorIndex,C[++P]=0,C[++P]=v,C[++P]=b,C[++P]=m,I[++S]=w,n[++r]=t/M,n[++r]=M,n[++r]=e.depth,g[++x]=_,o+=1,a+=1,P+=4,u[++h]=-1,c[++l]=f.x,c[++l]=f.y,c[++l]=d.x,c[++l]=d.y,I[++S]=w}),C?void 0:"break"}(O))break}var B=o.BufferUtil.endUpdates();return r&&(r.value=i),C?this.bufferItems.geometry.setDrawRange(0,6*B):0===t.length&&this.bufferItems.geometry.setDrawRange(0,0),C},e}(s.BaseBuffer);e.SharedControlCurvedLineBufferAnts=a},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(3),s=n(4),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){this.bufferItems=o.BufferUtil.makeBufferItems(),this.bufferItems.attributes=[{defaults:[0,0,0],name:"position",size:o.AttributeSize.THREE},{defaults:[0,0,0,0],name:"colorPicks",size:o.AttributeSize.FOUR},{defaults:[0],name:"controlPick",size:o.AttributeSize.ONE},{defaults:[0,0],name:"timing",size:o.AttributeSize.TWO},{defaults:[1],name:"normalDirection",size:o.AttributeSize.ONE},{defaults:[0,0,0,0],name:"endPoints",size:o.AttributeSize.FOUR},{defaults:[0],name:"halfLinewidth",size:o.AttributeSize.ONE}];var n=e;this.bufferItems.geometry=o.BufferUtil.makeBuffer(6*n,this.bufferItems.attributes),this.bufferItems.system=new i.Mesh(this.bufferItems.geometry,t),this.bufferItems.system.frustumCulled=!1,this.bufferItems.system.drawMode=i.TriangleStripDrawMode},e.prototype.update=function(t,e,n){if(!t)return this.bufferItems.geometry.setDrawRange(0,0),!1;0===t.length&&(this.bufferItems.currentData=t);var r,i,s=[],a=new Map;if(t&&t.length>0&&e){var u=t[0].startColor,h=u.base;r=this.bufferItems.system.material.uniforms;var c=e.getAtlasTexture(h.atlasReferenceID);r.colorAtlas.value=c,r.colorsPerRow.value=h.colorsPerRow,r.firstColor.value=[h.firstColor.x,h.firstColor.y],r.nextColor.value=[h.nextColor.x,h.nextColor.y],i=r.controlPoints,c.needsUpdate=!0}var l,f,d,p,y,g,m,b,v,x,w,_=1,M=15,C=!1;o.BufferUtil.beginUpdates();for(var P=this,I=0,S=t;I<S.length;I++){var O=S[I];if("break"===function(e){if(m=e.startColor.base.opacity,y=e.endColor.base.colorIndex,g=e.endColorStop.base.colorIndex,d=e.startColor.base.colorIndex,p=e.startColorStop.base.colorIndex,v=e.duration,_=e.lineWidth/2,M=e.resolution,l=e.currentStart,f=e.currentEnd,b=e.startTime,w=e.controlPoints[n],void 0===(x=a.get(w))){var r=s.push(w.x,w.y);x=r-2,a.set(w,x)}if(!(C=o.BufferUtil.updateBuffer(t,P.bufferItems,6,M,function(t,n,r,i,o,s,a,u,h,c,m,w,C,P,I){s[a]=x,o+=4,w[C]=l.x,w[++C]=l.y,w[++C]=f.x,w[++C]=f.y,P[I]=_,c[m]=1,n[r]=(t+1)/M,n[++r]=M,n[++r]=e.depth,h+=2,i[o]=d,i[++o]=p,i[++o]=y,i[++o]=g,s[++a]=x,w[++C]=l.x,w[++C]=l.y,w[++C]=f.x,w[++C]=f.y,P[++I]=_,c[++m]=1,n[++r]=(t+1)/M,n[++r]=M,n[++r]=e.depth,u[h]=b,u[++h]=v,i[++o]=d,i[++o]=p,i[++o]=y,i[++o]=g,s[++a]=x,w[++C]=l.x,w[++C]=l.y,w[++C]=f.x,w[++C]=f.y,P[++I]=_,c[++m]=-1,n[++r]=(t+1)/M,n[++r]=M,n[++r]=e.depth,u[++h]=b,u[++h]=v,i[++o]=d,i[++o]=p,i[++o]=y,i[++o]=g,s[++a]=x,w[++C]=l.x,w[++C]=l.y,w[++C]=f.x,w[++C]=f.y,P[++I]=_,c[++m]=1,n[++r]=t/M,n[++r]=M,n[++r]=e.depth,u[++h]=b,u[++h]=v,i[++o]=d,i[++o]=p,i[++o]=y,i[++o]=g,s[++a]=x,w[++C]=l.x,w[++C]=l.y,w[++C]=f.x,w[++C]=f.y,P[++I]=_,c[++m]=-1,n[++r]=t/M,n[++r]=M,n[++r]=e.depth,u[++h]=b,u[++h]=v,n[++r]=t/M,n[++r]=M,n[++r]=e.depth,P[++I]=_,o+=4,c[++m]=-1,w[++C]=l.x,w[++C]=l.y,w[++C]=f.x,w[++C]=f.y,s[++a]=x},!0)))return"break"}(O))break}var B=o.BufferUtil.endUpdates();return i&&(i.value=s),C?this.bufferItems.geometry.setDrawRange(0,6*B):0===t.length&&this.bufferItems.geometry.setDrawRange(0,0),C},e}(s.BaseBuffer);e.SharedControlCurvedLineColorsBuffer=a},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(3),s=n(4),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){this.bufferItems=o.BufferUtil.makeBufferItems(),this.bufferItems.attributes=[{defaults:[0,0,0],name:"position",size:o.AttributeSize.THREE},{defaults:[0],name:"startColorPick",size:o.AttributeSize.ONE},{defaults:[0],name:"endColorPick",size:o.AttributeSize.ONE},{defaults:[1],name:"normalDirection",size:o.AttributeSize.ONE},{defaults:[0,0,0,0],name:"endPoints",size:o.AttributeSize.FOUR},{defaults:[0],name:"halfLinewidth",size:o.AttributeSize.ONE},{defaults:[0],name:"controlPick",size:o.AttributeSize.ONE}];var n=e;this.bufferItems.geometry=o.BufferUtil.makeBuffer(6*n,this.bufferItems.attributes),this.bufferItems.system=new i.Mesh(this.bufferItems.geometry,t),this.bufferItems.system.frustumCulled=!1,this.bufferItems.system.drawMode=i.TriangleStripDrawMode},e.prototype.update=function(t,e,n){if(!t)return this.bufferItems.geometry.setDrawRange(0,0),!1;0===t.length&&(this.bufferItems.currentData=t);var r,i=[],s=new Map;if(t&&t.length>0&&e){var a=t[0].startColor,u=a.base,h=this.bufferItems.system.material,c=h.uniforms,l=e.getAtlasTexture(u.atlasReferenceID);c.colorAtlas.value=l,c.colorsPerRow.value=u.colorsPerRow,c.firstColor.value=[u.firstColor.x,u.firstColor.y],c.nextColor.value=[u.nextColor.x,u.nextColor.y],r=c.controlPoints,l.needsUpdate=!0}var f,d,p,y,g,m,b,v=1,x=15,w=!1;o.BufferUtil.beginUpdates();for(var _=this,M=0,C=t;M<C.length;M++){var P=C[M];if("break"===function(e){if(g=e.startColor.base.opacity,p=e.startColor.base,y=e.endColor.base,v=e.lineWidth/2,x=e.resolution,f=e.start,d=e.end,m=e.controlPoints[n],void 0===(b=s.get(m))){var r=i.push(m.x,m.y);b=r-2,s.set(m,b)}if(!(w=o.BufferUtil.updateBuffer(t,_.bufferItems,6,x,function(t,n,r,i,o,s,a,u,h,c,l,g,m,w,_){n[r]=(t+1)/x,n[++r]=x,n[++r]=e.depth,g[m]=v,o+=1,a+=1,u[h]=1,c[l]=f.x,c[++l]=f.y,c[++l]=d.x,c[++l]=d.y,w[_]=b,n[++r]=(t+1)/x,n[++r]=x,n[++r]=e.depth,g[++m]=v,u[++h]=1,c[++l]=f.x,c[++l]=f.y,c[++l]=d.x,c[++l]=d.y,i[o]=p.colorIndex,s[a]=y.colorIndex,w[++_]=b,n[++r]=(t+1)/x,n[++r]=x,n[++r]=e.depth,g[++m]=v,u[++h]=-1,c[++l]=f.x,c[++l]=f.y,c[++l]=d.x,c[++l]=d.y,i[++o]=p.colorIndex,s[++a]=y.colorIndex,w[++_]=b,n[++r]=t/x,n[++r]=x,n[++r]=e.depth,g[++m]=v,u[++h]=1,c[++l]=f.x,c[++l]=f.y,c[++l]=d.x,c[++l]=d.y,i[++o]=p.colorIndex,s[++a]=y.colorIndex,w[++_]=b,n[++r]=t/x,n[++r]=x,n[++r]=e.depth,g[++m]=v,u[++h]=-1,c[++l]=f.x,c[++l]=f.y,c[++l]=d.x,c[++l]=d.y,i[++o]=p.colorIndex,s[++a]=y.colorIndex,w[++_]=b,n[++r]=t/x,n[++r]=x,n[++r]=e.depth,g[++m]=v,o+=1,a+=1,u[++h]=-1,c[++l]=f.x,c[++l]=f.y,c[++l]=d.x,c[++l]=d.y,w[++_]=b})))return"break"}(P))break}var I=o.BufferUtil.endUpdates();return r&&(r.value=i),w?this.bufferItems.geometry.setDrawRange(0,6*I):0===t.length&&this.bufferItems.geometry.setDrawRange(0,0),w},e}(s.BaseBuffer);e.SharedControlCurvedLineBuffer=a},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(3),s=n(4),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){this.bufferItems=o.BufferUtil.makeBufferItems(),this.bufferItems.attributes=[{defaults:[0,0,0],name:"position",size:o.AttributeSize.THREE},{defaults:[0,0,0,1],name:"customColor",size:o.AttributeSize.FOUR},{defaults:[1],name:"normalDirection",size:o.AttributeSize.ONE},{defaults:[0,0,0,0],name:"endPoints",size:o.AttributeSize.FOUR},{defaults:[0,0],name:"controlPoint",size:o.AttributeSize.TWO},{defaults:[0],name:"halfLinewidth",size:o.AttributeSize.ONE}];var n=e;this.bufferItems.geometry=o.BufferUtil.makeBuffer(6*n,this.bufferItems.attributes),this.bufferItems.system=new i.Mesh(this.bufferItems.geometry,t),this.bufferItems.system.frustumCulled=!1,this.bufferItems.system.drawMode=i.TriangleStripDrawMode},e.prototype.update=function(t){if(!t)return this.bufferItems.geometry.setDrawRange(0,0),!1;var e,n,r,i,s=1,a=15,u=!1;o.BufferUtil.beginUpdates();for(var h=this,c=0,l=t;c<l.length;c++){var f=l[c];if("break"===function(c){if(i=c.startColor.base.opacity,r=c.startColor.base.color,s=c.lineWidth/2,a=c.resolution,e=c.start,n=c.end,!(u=o.BufferUtil.updateBuffer(t,h.bufferItems,6,a,function(t,o,u,h,l,f,d,p,y,g,m,b,v){o[u]=(t+1)/a,o[++u]=a,o[++u]=c.depth,b[v]=s,l+=4,f[d]=1,p[y]=e.x,p[++y]=e.y,p[++y]=n.x,p[++y]=n.y,g[m]=c.controlPoints[0].x,g[++m]=c.controlPoints[0].y,o[++u]=(t+1)/a,o[++u]=a,o[++u]=c.depth,b[++v]=s,f[++d]=1,p[++y]=e.x,p[++y]=e.y,p[++y]=n.x,p[++y]=n.y,g[++m]=c.controlPoints[0].x,g[++m]=c.controlPoints[0].y,h[l]=r.r,h[++l]=r.g,h[++l]=r.b,h[++l]=i,o[++u]=(t+1)/a,o[++u]=a,o[++u]=c.depth,b[++v]=s,f[++d]=-1,p[++y]=e.x,p[++y]=e.y,p[++y]=n.x,p[++y]=n.y,g[++m]=c.controlPoints[0].x,g[++m]=c.controlPoints[0].y,h[++l]=r.r,h[++l]=r.g,h[++l]=r.b,h[++l]=i,o[++u]=t/a,o[++u]=a,o[++u]=c.depth,b[++v]=s,f[++d]=1,p[++y]=e.x,p[++y]=e.y,p[++y]=n.x,p[++y]=n.y,g[++m]=c.controlPoints[0].x,g[++m]=c.controlPoints[0].y,h[++l]=r.r,h[++l]=r.g,h[++l]=r.b,h[++l]=i,o[++u]=t/a,o[++u]=a,o[++u]=c.depth,b[++v]=s,f[++d]=-1,p[++y]=e.x,p[++y]=e.y,p[++y]=n.x,p[++y]=n.y,g[++m]=c.controlPoints[0].x,g[++m]=c.controlPoints[0].y,h[++l]=r.r,h[++l]=r.g,h[++l]=r.b,h[++l]=i,o[++u]=t/a,o[++u]=a,o[++u]=c.depth,b[++v]=s,l+=4,f[++d]=-1,p[++y]=e.x,p[++y]=e.y,p[++y]=n.x,p[++y]=n.y,g[++m]=c.controlPoints[0].x,g[++m]=c.controlPoints[0].y})))return"break"}(f))break}var d=o.BufferUtil.endUpdates();return u?this.bufferItems.geometry.setDrawRange(0,6*d):0===t.length&&this.bufferItems.geometry.setDrawRange(0,0),u},e}(s.BaseBuffer);e.SimpleStaticBezierLineBuffer=a},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(3),s=n(4),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){this.bufferItems=o.BufferUtil.makeBufferItems(),this.bufferItems.attributes=[{defaults:[0,0,0],name:"position",size:o.AttributeSize.THREE},{defaults:[0,0,0],name:"customColor",size:o.AttributeSize.THREE},{defaults:[0,0,1],name:"texCoord",size:o.AttributeSize.THREE},{defaults:[0,0],name:"size",size:o.AttributeSize.TWO},{defaults:[0,0],name:"anchor",size:o.AttributeSize.TWO}];var n=e;this.bufferItems.geometry=o.BufferUtil.makeBuffer(6*n,this.bufferItems.attributes),this.bufferItems.system=new i.Mesh(this.bufferItems.geometry,t),this.bufferItems.system.frustumCulled=!1,this.bufferItems.system.drawMode=i.TriangleStripDrawMode},e.prototype.update=function(t,e,n,r,i){var s,a,u,h,c;if(t&&t.length>0&&e){var l=t[0].color,f=l.base,d=this.bufferItems.system.material,p=d.uniforms,y=e.getAtlasTexture(f.atlasReferenceID);p.colorAtlas.value=y,p.colorsPerRow.value=f.colorsPerRow,p.firstColor.value=[f.firstColor.x,f.firstColor.y],p.nextColor.value=[f.nextColor.x,f.nextColor.y],y.needsUpdate=!0,(n||r||i)&&(d=this.bufferItems.system.material,p=d.uniforms,n&&(p.startFade.value=n),r&&(p.endFade.value=r),i&&(p.maxLabelSize.value=i))}if(!t)return this.bufferItems.geometry.setDrawRange(0,0),!1;var g=o.BufferUtil.updateBuffer(t,this.bufferItems,6,t.length,function(e,n,r,i,o,l,f,d,p,y,g){s=t[e],a=s.rasterizedLabel,u=s.color.base,h=s.color.base.opacity,c={x:s.getLocation().x+s.getSize().width*Math.cos(s.getRotation()),y:s.getLocation().y+s.getSize().width*Math.sin(s.getRotation())},s.update(),n[r]=s.TR.x,n[++r]=s.TR.y,n[++r]=s.depth,y[g]=c.x,y[++g]=c.y,o+=1,f+=3,p+=2,n[++r]=s.TR.x,n[++r]=s.TR.y,n[++r]=s.depth,l[f]=a.atlasTR.x,l[++f]=a.atlasTR.y,l[++f]=h,i[o]=u.colorIndex,d[p]=s.getSize().width,d[++p]=s.getSize().height,y[++g]=c.x,y[++g]=c.y,n[++r]=s.BR.x,n[++r]=s.BR.y,n[++r]=s.depth,l[++f]=a.atlasBR.x,l[++f]=a.atlasBR.y,l[++f]=h,i[++o]=u.colorIndex,d[++p]=s.getSize().width,d[++p]=s.getSize().height,y[++g]=c.x,y[++g]=c.y,n[++r]=s.TL.x,n[++r]=s.TL.y,n[++r]=s.depth,l[++f]=a.atlasTL.x,l[++f]=a.atlasTL.y,l[++f]=h,i[++o]=u.colorIndex,d[++p]=s.getSize().width,d[++p]=s.getSize().height,y[++g]=c.x,y[++g]=c.y,n[++r]=s.BL.x,n[++r]=s.BL.y,n[++r]=s.depth,l[++f]=a.atlasBL.x,l[++f]=a.atlasBL.y,l[++f]=h,i[++o]=u.colorIndex,d[++p]=s.getSize().width,d[++p]=s.getSize().height,y[++g]=c.x,y[++g]=c.y,n[++r]=s.BL.x,n[++r]=s.BL.y,n[++r]=s.depth,y[++g]=c.x,y[++g]=c.y});return this.bufferItems.geometry.setDrawRange(0,6*t.length),g},e}(s.BaseBuffer);e.SimpleStaticLabelBuffer=a},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(3),s=n(4),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){this.bufferItems=o.BufferUtil.makeBufferItems(),this.bufferItems.attributes=[{defaults:[0,0,0],name:"position",size:o.AttributeSize.THREE},{defaults:[0,0,0,1],name:"customColor",size:o.AttributeSize.FOUR}];var n=e;this.bufferItems.geometry=o.BufferUtil.makeBuffer(6*n,this.bufferItems.attributes),this.bufferItems.system=new i.Mesh(this.bufferItems.geometry,t),this.bufferItems.system.frustumCulled=!1,this.bufferItems.system.drawMode=i.TriangleStripDrawMode},e.prototype.update=function(t){if(!t)return this.bufferItems.geometry.setDrawRange(0,0),!1;var e=!1,n=0;o.BufferUtil.beginUpdates();for(var r,i,s,a,u,h,c=this,l=0,f=t;l<f.length;l++){var d=f[l];if("break"===function(l){var f=l.getTriangleStrip();if(u=l.startColor.base.color,h=l.startColor.base.opacity,!(e=o.BufferUtil.updateBuffer(t,c.bufferItems,6,f.length/4,function(t,e,o,c,d){n=4*t,r=f[n],i=f[n+1],s=f[n+2],a=f[n+3],e[o]=r.x,e[++o]=r.y,e[++o]=l.depth,d+=4,e[++o]=r.x,e[++o]=r.y,e[++o]=l.depth,c[d]=u.r,c[++d]=u.g,c[++d]=u.b,c[++d]=h,e[++o]=i.x,e[++o]=i.y,e[++o]=l.depth,c[++d]=u.r,c[++d]=u.g,c[++d]=u.b,c[++d]=h,e[++o]=s.x,e[++o]=s.y,e[++o]=l.depth,c[++d]=u.r,c[++d]=u.g,c[++d]=u.b,c[++d]=h,e[++o]=a.x,e[++o]=a.y,e[++o]=l.depth,c[++d]=u.r,c[++d]=u.g,c[++d]=u.b,c[++d]=h,e[++o]=a.x,e[++o]=a.y,e[++o]=l.depth,d+=4})))return"break"}(d))break}var p=o.BufferUtil.endUpdates();return e?this.bufferItems.geometry.setDrawRange(0,6*p):0===t.length?this.bufferItems.geometry.setDrawRange(0,0):0===t.length&&this.bufferItems.geometry.setDrawRange(0,0),e},e}(s.BaseBuffer);e.SimpleStaticLineBuffer=a},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(41)),r(n(42)),r(n(43)),r(n(20)),r(n(44)),r(n(45)),r(n(15)),r(n(23)),r(n(46)),r(n(47)),r(n(13)),r(n(8)),r(n(17))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.base=t}return t}();e.ReferenceColor=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(10),s=n(9),a=n(11),u=n(20),h=function(t){function e(e){var n=t.call(this,e)||this;return n.easing=o.linear,n._startColorChange=new i.Color(0,0,0),n._endColorChange=new i.Color(0,0,0),n.startStop={x:0,y:0},n.endStop={x:0,y:0},n._currentStartColor=new i.Color(0,0,0),n._currentEndColor=new i.Color(0,0,0),e&&(n.startStop=e.startStop||{x:0,y:0},n.endStop=e.endStop||{x:0,y:0},e.startColorStop&&(n.startColorStop=e.startColorStop),e.endColorStop&&(n.endColorStop=e.endColorStop)),n}return r(e,t),Object.defineProperty(e.prototype,"startColorStop",{get:function(){return this._startColorStop},set:function(t){var e=this.startColor.base.color,n=t.base.color;this._startColorStop=t,this._startColorChange.r=n.r-e.r,this._startColorChange.g=n.g-e.g,this._startColorChange.b=n.b-e.b},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endColorStop",{get:function(){return this._endColorStop},set:function(t){var e=this.startColor.base.color,n=t.base.color;this._endColorStop=t,this._endColorChange.r=n.r-e.r,this._endColorChange.g=n.g-e.g,this._endColorChange.b=n.b-e.b},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentStartColor",{get:function(){var t=Math.min(s.FrameInfo.lastFrameTime-this.startTime,this.duration),e=this.startColor.base.color;return this._currentStartColor.r=this.easing(t,e.r,this._startColorChange.r,this.duration),this._currentStartColor.g=this.easing(t,e.g,this._startColorChange.g,this.duration),this._currentStartColor.b=this.easing(t,e.b,this._startColorChange.b,this.duration),this._currentStartColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentEndColor",{get:function(){var t=Math.min(s.FrameInfo.lastFrameTime-this.startTime,this.duration),e=this.endColor.base.color;return this._currentEndColor.r=this.easing(t,e.r,this._endColorChange.r,this.duration),this._currentEndColor.g=this.easing(t,e.g,this._endColorChange.g,this.duration),this._currentEndColor.b=this.easing(t,e.b,this._endColorChange.b,this.duration),this._currentEndColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentStart",{get:function(){var t=Math.min(s.FrameInfo.lastFrameTime-this.startTime,this.duration),e=this.easing(t,0,1,this.duration);return a.circular(e,this.start,this.startStop,this.controlPoints[1])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentEnd",{get:function(){var t=Math.min(s.FrameInfo.lastFrameTime-this.startTime,this.duration),e=this.easing(t,0,1,this.duration);return a.circular(e,this.end,this.endStop,this.controlPoints[1])},enumerable:!0,configurable:!0}),e}(u.CurvedLineShape);e.AnimatedCurvedLineShape=h},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),o=n(22),s=function(t){function e(e,n,r,i,o,s,a){var u=t.call(this,e,n,r,a)||this;if(u.r=0,u.g=0,u.b=0,u.a=0,u.r2=0,u.g2=0,u.b2=0,u.a2=0,u.alpha=0,u.innerRadius=0,u.ringWidth=0,u.ringPad=0,u.outline=!1,i){var h=i.r,c=i.g,l=i.b,f=i.opacity;u.setOuterColor({r:h,g:c,b:l,opacity:f})}return void 0===s&&(s=0),u.innerRadius=s,o&&u.setInnerColor(o),u}return r(e,t),e.prototype.setOuterColor=function(t){var e=t.r,n=t.g,r=t.b,i=t.opacity;this.r=e,this.g=n,this.b=r,this.a=i},e.prototype.setInnerColor=function(t){this.r2=t.r,this.g2=t.g,this.b2=t.b,this.a2=t.opacity},e.prototype.clone=function(t){return Object.assign(new e(this._centerX,this._centerY,this._radius,i.rgb(this.r,this.g,this.b,this.a),i.rgb(this.r2,this.g2,this.b2,this.a2),this.innerRadius,this.d),this,t)},e.prototype.cloneWithData=function(t){return Object.assign(new e(this._centerX,this._centerY,this._radius,i.rgb(this.r,this.g,this.b,this.a),i.rgb(this.r2,this.g2,this.b2,this.a2),this.innerRadius),this,t)},e}(o.Circle);e.CircleShape=s},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),o=n(5),s=n(23),a=function(t){function e(e,n,r,i,o,s,a){var u=t.call(this,e,n,r,i.r,i.g,i.b,i.opacity,o.r,o.g,o.b,o.opacity,s)||this;return u.tl={x:0,y:0},u.bl={x:0,y:0},u.tr={x:0,y:0},u.br={x:0,y:0},u.endWidth=1,u.endWidth=a,u.setPoints(e,n),u}return r(e,t),e.prototype.clone=function(t){return Object.assign(new e(this.p1,this.p2,this.d,i.rgb(this.r,this.g,this.b,this.a),i.rgb(this.r2,this.g2,this.b2,this.a2),this.thickness,this.endWidth),this,t)},e.prototype.pointInside=function(t){for(var e=t.x,n=t.y,r=[this.tl,this.tr,this.br,this.bl],i=r.length,o=!1,s=0,a=i-1;s<i;a=s++)r[s].y>n!=r[a].y>n&&e<(r[a].x-r[s].x)*(n-r[s].y)/(r[a].y-r[s].y)+r[s].x&&(o=!o);return o},e.prototype.setPoints=function(e,n){if(t.prototype.setPoints.call(this,e,n),this.tl){var r=this.thickness/2,i=this.endWidth/2,s=this.perpendicular.x*r,a=this.perpendicular.y*r,u=this.perpendicular.x*i,h=this.perpendicular.y*i;this.tl.x=this.p1.x+s,this.tl.y=this.p1.y+a,this.bl.x=this.p1.x-s,this.bl.y=this.p1.y-a,this.tr.x=this.p2.x+u,this.tr.y=this.p2.y+h,this.br.x=this.p2.x-u,this.br.y=this.p2.y-h,this.topEdge=new o.Line(this.tl,this.tr),this.bottomEdge=new o.Line(this.bl,this.br),this.encapsulatePoints([this.tl,this.tr,this.bl,this.br])}},e}(s.LineShape);e.EdgeShape=a},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=function(t){function e(e,n){var r=t.call(this,0,0,n,n)||this;return r.opacity=1,r.texture=e,r.size=n,r}return r(e,t),Object.defineProperty(e.prototype,"size",{get:function(){return Math.max(this.width,this.height)},set:function(t){this.texture.aspectRatio>1?(this.width=t,this.height=t/this.texture.aspectRatio):(this.width=t*this.texture.aspectRatio,this.height=t)},enumerable:!0,configurable:!0}),e.prototype.centerOn=function(t,e){this.x=t-this.width/2,this.y=e-this.height/2},e}(i.Bounds);e.ImageShape=o},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=function(t){function e(e,n){var r=t.call(this,e.x,e.right,e.y,e.bottom)||this;return r.r=1,r.g=0,r.b=0,r.a=1,r}return r(e,t),e}(i.Bounds);e.QuadShape=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(t,e,n,i){void 0===i&&(i=1),this.opacity=1,this.pixelWidth=2,this.pixelHeight=2,t instanceof r.Color?(this.color=t.clone(),this.opacity=void 0===e?1:e):(this.color=new r.Color(t,e,n),this.opacity=i)}return t}();e.AtlasColor=i},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(1)),r(n(22)),r(n(21)),r(n(5)),r(n(6)),r(n(16))},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(50)),r(n(51)),r(n(3)),r(n(52)),r(n(10)),r(n(9)),r(n(53)),r(n(11)),r(n(18)),r(n(24)),r(n(!function(){var t=new Error('Cannot find module "./object-gatherer"');throw t.code="MODULE_NOT_FOUND",t}())),r(n(14)),r(n(!function(){var t=new Error('Cannot find module "./path"');throw t.code="MODULE_NOT_FOUND",t}())),r(n(19)),r(n(25))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r;!function(t){t[t.PLAY=0]="PLAY",t[t.STOP=1]="STOP"}(r||(r={}));var i=function(){function t(){}return t.animate=function(){t.playState===r.PLAY&&requestAnimationFrame(t.animate),this.animating.forEach(function(t){t.forEach(function(t){})})},t.cancel=function(t,e){},t.value=function(t,e,n,r,i,o){},t.point=function(t){},t.start=function(){},t.stop=function(){},t.playState=r.PLAY,t.animating=new Map,t}();e.Animate=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i,o=n(24);!function(t){t[t.INIT=0]="INIT",t[t.PLAY=1]="PLAY",t[t.STOP=2]="STOP"}(i=e.PlayState||(e.PlayState={}));var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playState=i.INIT,e.buffer=[],e.bustCache=!0,e.doAnimate=function(){e.playState===i.PLAY&&requestAnimationFrame(e.doAnimate),e.animate()},e}return r(e,t),e.prototype.animate=function(){},e.prototype.generate=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.getStorage(t),this.bustCache&&(this.buildCache.apply(this,arguments),this.bustCache=!1,this.playState===i.INIT&&(this.start(),requestAnimationFrame(this.doAnimate))),this.flagBuffersDirty(),this.processDirtyBuffers()},e.prototype.buildCache=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n]},e.prototype.start=function(){this.playState=i.PLAY},e.prototype.stop=function(){this.playState=i.STOP},e}(o.MultiShapeBufferCache);e.AnimatedShapeBufferCache=s},function(t,e,n){"use strict";function r(t){return Array.from(t).filter(function(t){return t[1]}).map(function(t){return t[0]})}Object.defineProperty(e,"__esModule",{value:!0}),e.boolMapToArray=r;var i=function(){function t(){this.cachedSelection=new Map,this.selections=new Map,this._didSelectionChange=new Map}return t.prototype.clearAllSelections=function(){for(var t=0,e=Array.from(this.selections.keys());t<e.length;t++){var n=e[t];this.clearSelection(n)}},t.prototype.clearSelection=function(t){this.getSelection(t).length&&(this.selections.set(t,null),this.cachedSelection.set(t,null),this._didSelectionChange.set(t,!0))},t.prototype.deselect=function(t,e){var n=this.selections.get(t);n&&n.get(e)&&(this.cachedSelection.set(t,null),n.set(e,!1),this._didSelectionChange.set(t,!0))},t.prototype.didSelectionCategoryChange=function(t){return this._didSelectionChange.get(t)},t.prototype.didSelectionChange=function(){return r(this._didSelectionChange).length>0},t.prototype.finalizeUpdate=function(){for(var t=0,e=Array.from(this._didSelectionChange.keys());t<e.length;t++){var n=e[t];this._didSelectionChange.set(n,!1)}},t.prototype.getSelection=function(t){if(!this.cachedSelection.get(t)){var e=this.selections.get(t);e?this.cachedSelection.set(t,r(e)):this.cachedSelection.set(t,[])}return this.cachedSelection.get(t)},t.prototype.select=function(t,e){var n=this.selections.get(t);n||(n=new Map,this.selections.set(t,n)),n.get(e)||(this.cachedSelection.set(t,null),n.set(e,!0),this._didSelectionChange.set(t,!0))},t.prototype.toggleSelect=function(t,e){var n=this.selections.get(t);n||(n=new Map,this.selections.set(t,n)),this.cachedSelection.set(t,null),n.get(e)?this.deselect(t,e):this.select(t,e),this._didSelectionChange.set(t,!0)},t}();e.CustomSelection=i},function(t,e,n){"use strict";function r(t){var e=t.ctx,n=t.text,r=t.bboxHeight,i=t.ctx.canvas.height,o=t.baseline||"alphabetic",s=t.flip||!1,a=t.drawBaseline||!1,u="Arial, san-serif",h=14;t.fontFamily&&(u=t.fontFamily),t.fontSize&&(h=t.fontSize),e.save(),e.font=h+"px "+u;var c=e.measureText(n).width,l=2*h,f=2*h,d=e.canvas.width=Math.round(c+2*l),p=e.canvas.height=i||Math.round(2*f);"string"==typeof o&&(f=0,e.textBaseline=o),s&&e.scale(1,-1),e.font=h+"px "+u,e.fillText(n,l,"number"==typeof r?r:f),a&&e.fillRect(0,i/2,e.canvas.width,1);for(var y=e.getImageData(0,0,d,p),g=y.data,m=g.length,b=0,v=0,x=0,w=0;m>0;){g[m+3]&&(m-=m%(4*d),g[m+3]&&(m-=m%(4*d),b=m/4/d,b-=f-h,m=0),m-=4),x=0;for(var _=0,M=0;M<p&&_<d;){g[M*d*4+4*_+3]&&(x=_-l,M=p,_=d),M++,M%p==0&&(M=0,_++)}for(w=0,_=d,M=0;M<p&&_>0;)g[M*d*4+4*_+3]&&(w=_-l,M=p,_=d),++M%p==0&&(M=0,_--);for(v=0,m=g.length;m>0;)g[m+3]&&(m-=m%(4*d),v=m/4/d,m=0),m-=4;e.restore()}return{bottom:v,height:b-0,left:-x,top:h-0,width:w-x}}Object.defineProperty(e,"__esModule",{value:!0}),e.getFontMetrics=r}])});
//# sourceMappingURL=index.js.map